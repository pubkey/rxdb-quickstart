/*! For license information please see 2f9958da0050e5d2df17.bundle.js.LICENSE.txt */
(()=>{var e,t,n={7526:(e,t)=>{"use strict";t.byteLength=function(e){var t=s(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,o=s(e),a=o[0],u=o[1],c=new i(function(e,t,n){return 3*(t+n)/4-n}(0,a,u)),l=0,h=u>0?a-4:a;for(n=0;n<h;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],c[l++]=t>>16&255,c[l++]=t>>8&255,c[l++]=255&t;2===u&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,c[l++]=255&t);1===u&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,c[l++]=t>>8&255,c[l++]=255&t);return c},t.fromByteArray=function(e){for(var t,r=e.length,i=r%3,o=[],a=16383,s=0,c=r-i;s<c;s+=a)o.push(u(e,s,s+a>c?c:s+a));1===i?(t=e[r-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return o.join("")};for(var n=[],r=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0;a<64;++a)n[a]=o[a],r[o.charCodeAt(a)]=a;function s(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function u(e,t,r){for(var i,o,a=[],s=t;s<r;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return a.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},8287:(e,t,n)=>{"use strict";const r=n(7526),i=n(251),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=u,t.SlowBuffer=function(e){+e!=e&&(e=0);return u.alloc(+e)},t.INSPECT_MAX_BYTES=50;const a=2147483647;function s(e){if(e>a)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,u.prototype),t}function u(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return h(e)}return c(e,t,n)}function c(e,t,n){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!u.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=0|m(e,t);let r=s(n);const i=r.write(e,t);i!==n&&(r=r.slice(0,i));return r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(X(e,Uint8Array)){const t=new Uint8Array(e);return d(t.buffer,t.byteOffset,t.byteLength)}return f(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(X(e,ArrayBuffer)||e&&X(e.buffer,ArrayBuffer))return d(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(X(e,SharedArrayBuffer)||e&&X(e.buffer,SharedArrayBuffer)))return d(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return u.from(r,t,n);const i=function(e){if(u.isBuffer(e)){const t=0|p(e.length),n=s(t);return 0===n.length||e.copy(n,0,0,t),n}if(void 0!==e.length)return"number"!=typeof e.length||Y(e.length)?s(0):f(e);if("Buffer"===e.type&&Array.isArray(e.data))return f(e.data)}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return u.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function h(e){return l(e),s(e<0?0:0|p(e))}function f(e){const t=e.length<0?0:0|p(e.length),n=s(t);for(let r=0;r<t;r+=1)n[r]=255&e[r];return n}function d(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,u.prototype),r}function p(e){if(e>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return 0|e}function m(e,t){if(u.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||X(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return z(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Q(e).length;default:if(i)return r?-1:z(e).length;t=(""+t).toLowerCase(),i=!0}}function y(e,t,n){let r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return P(this,t,n);case"utf8":case"utf-8":return C(this,t,n);case"ascii":return R(this,t,n);case"latin1":case"binary":return I(this,t,n);case"base64":return x(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function v(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function g(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),Y(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=u.from(t,r)),u.isBuffer(t))return 0===t.length?-1:b(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):b(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function b(e,t,n,r,i){let o,a=1,s=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,u/=2,n/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){let r=-1;for(o=n;o<s;o++)if(c(e,o)===c(t,-1===r?0:o-r)){if(-1===r&&(r=o),o-r+1===u)return r*a}else-1!==r&&(o-=o-r),r=-1}else for(n+u>s&&(n=s-u),o=n;o>=0;o--){let n=!0;for(let r=0;r<u;r++)if(c(e,o+r)!==c(t,r)){n=!1;break}if(n)return o}return-1}function w(e,t,n,r){n=Number(n)||0;const i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;const o=t.length;let a;for(r>o/2&&(r=o/2),a=0;a<r;++a){const r=parseInt(t.substr(2*a,2),16);if(Y(r))return a;e[n+a]=r}return a}function _(e,t,n,r){return V(z(t,e.length-n),e,n,r)}function E(e,t,n,r){return V(function(e){const t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function k(e,t,n,r){return V(Q(t),e,n,r)}function S(e,t,n,r){return V(function(e,t){let n,r,i;const o=[];for(let a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function x(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function C(e,t,n){n=Math.min(e.length,n);const r=[];let i=t;for(;i<n;){const t=e[i];let o=null,a=t>239?4:t>223?3:t>191?2:1;if(i+a<=n){let n,r,s,u;switch(a){case 1:t<128&&(o=t);break;case 2:n=e[i+1],128==(192&n)&&(u=(31&t)<<6|63&n,u>127&&(o=u));break;case 3:n=e[i+1],r=e[i+2],128==(192&n)&&128==(192&r)&&(u=(15&t)<<12|(63&n)<<6|63&r,u>2047&&(u<55296||u>57343)&&(o=u));break;case 4:n=e[i+1],r=e[i+2],s=e[i+3],128==(192&n)&&128==(192&r)&&128==(192&s)&&(u=(15&t)<<18|(63&n)<<12|(63&r)<<6|63&s,u>65535&&u<1114112&&(o=u))}}null===o?(o=65533,a=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),i+=a}return function(e){const t=e.length;if(t<=O)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=O));return n}(r)}t.kMaxLength=a,u.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),u.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}}),u.poolSize=8192,u.from=function(e,t,n){return c(e,t,n)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array),u.alloc=function(e,t,n){return function(e,t,n){return l(e),e<=0?s(e):void 0!==t?"string"==typeof n?s(e).fill(t,n):s(e).fill(t):s(e)}(e,t,n)},u.allocUnsafe=function(e){return h(e)},u.allocUnsafeSlow=function(e){return h(e)},u.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==u.prototype},u.compare=function(e,t){if(X(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),X(t,Uint8Array)&&(t=u.from(t,t.offset,t.byteLength)),!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,r=t.length;for(let i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);let n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;const r=u.allocUnsafe(t);let i=0;for(n=0;n<e.length;++n){let t=e[n];if(X(t,Uint8Array))i+t.length>r.length?(u.isBuffer(t)||(t=u.from(t)),t.copy(r,i)):Uint8Array.prototype.set.call(r,t,i);else{if(!u.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(r,i)}i+=t.length}return r},u.byteLength=m,u.prototype._isBuffer=!0,u.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)v(this,t,t+1);return this},u.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},u.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},u.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?C(this,0,e):y.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){let e="";const n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},o&&(u.prototype[o]=u.prototype.inspect),u.prototype.compare=function(e,t,n,r,i){if(X(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),!u.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;let o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0);const s=Math.min(o,a),c=this.slice(r,i),l=e.slice(t,n);for(let e=0;e<s;++e)if(c[e]!==l[e]){o=c[e],a=l[e];break}return o<a?-1:a<o?1:0},u.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},u.prototype.indexOf=function(e,t,n){return g(this,e,t,n,!0)},u.prototype.lastIndexOf=function(e,t,n){return g(this,e,t,n,!1)},u.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let o=!1;for(;;)switch(r){case"hex":return w(this,e,t,n);case"utf8":case"utf-8":return _(this,e,t,n);case"ascii":case"latin1":case"binary":return E(this,e,t,n);case"base64":return k(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const O=4096;function R(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function I(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function P(e,t,n){const r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);let i="";for(let r=t;r<n;++r)i+=Z[e[r]];return i}function D(e,t,n){const r=e.slice(t,n);let i="";for(let e=0;e<r.length-1;e+=2)i+=String.fromCharCode(r[e]+256*r[e+1]);return i}function T(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function A(e,t,n,r,i,o){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function j(e,t,n,r,i){U(t,r,i,e,n,7);let o=Number(t&BigInt(4294967295));e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=a,a>>=8,e[n++]=a,a>>=8,e[n++]=a,a>>=8,e[n++]=a,n}function N(e,t,n,r,i){U(t,r,i,e,n,7);let o=Number(t&BigInt(4294967295));e[n+7]=o,o>>=8,e[n+6]=o,o>>=8,e[n+5]=o,o>>=8,e[n+4]=o;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=a,a>>=8,e[n+2]=a,a>>=8,e[n+1]=a,a>>=8,e[n]=a,n+8}function M(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function B(e,t,n,r,o){return t=+t,n>>>=0,o||M(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function L(e,t,n,r,o){return t=+t,n>>>=0,o||M(e,0,n,8),i.write(e,t,n,r,52,8),n+8}u.prototype.slice=function(e,t){const n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);const r=this.subarray(e,t);return Object.setPrototypeOf(r,u.prototype),r},u.prototype.readUintLE=u.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||T(e,t,this.length);let r=this[e],i=1,o=0;for(;++o<t&&(i*=256);)r+=this[e+o]*i;return r},u.prototype.readUintBE=u.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||T(e,t,this.length);let r=this[e+--t],i=1;for(;t>0&&(i*=256);)r+=this[e+--t]*i;return r},u.prototype.readUint8=u.prototype.readUInt8=function(e,t){return e>>>=0,t||T(e,1,this.length),this[e]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(e,t){return e>>>=0,t||T(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(e,t){return e>>>=0,t||T(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(e,t){return e>>>=0,t||T(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(e,t){return e>>>=0,t||T(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readBigUInt64LE=J((function(e){K(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||W(e,this.length-8);const r=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+n*2**24;return BigInt(r)+(BigInt(i)<<BigInt(32))})),u.prototype.readBigUInt64BE=J((function(e){K(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||W(e,this.length-8);const r=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+n;return(BigInt(r)<<BigInt(32))+BigInt(i)})),u.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||T(e,t,this.length);let r=this[e],i=1,o=0;for(;++o<t&&(i*=256);)r+=this[e+o]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*t)),r},u.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||T(e,t,this.length);let r=t,i=1,o=this[e+--r];for(;r>0&&(i*=256);)o+=this[e+--r]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},u.prototype.readInt8=function(e,t){return e>>>=0,t||T(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){e>>>=0,t||T(e,2,this.length);const n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(e,t){e>>>=0,t||T(e,2,this.length);const n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(e,t){return e>>>=0,t||T(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return e>>>=0,t||T(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readBigInt64LE=J((function(e){K(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||W(e,this.length-8);const r=this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),u.prototype.readBigInt64BE=J((function(e){K(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||W(e,this.length-8);const r=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+n)})),u.prototype.readFloatLE=function(e,t){return e>>>=0,t||T(e,4,this.length),i.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return e>>>=0,t||T(e,4,this.length),i.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return e>>>=0,t||T(e,8,this.length),i.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return e>>>=0,t||T(e,8,this.length),i.read(this,e,!1,52,8)},u.prototype.writeUintLE=u.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){A(this,e,t,n,Math.pow(2,8*n)-1,0)}let i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){A(this,e,t,n,Math.pow(2,8*n)-1,0)}let i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},u.prototype.writeUint8=u.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,1,255,0),this[t]=255&e,t+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},u.prototype.writeBigUInt64LE=J((function(e,t=0){return j(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),u.prototype.writeBigUInt64BE=J((function(e,t=0){return N(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),u.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);A(this,e,t,n,r-1,-r)}let i=0,o=1,a=0;for(this[t]=255&e;++i<n&&(o*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/o|0)-a&255;return t+n},u.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);A(this,e,t,n,r-1,-r)}let i=n-1,o=1,a=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/o|0)-a&255;return t+n},u.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},u.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},u.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},u.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||A(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},u.prototype.writeBigInt64LE=J((function(e,t=0){return j(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),u.prototype.writeBigInt64BE=J((function(e,t=0){return N(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),u.prototype.writeFloatLE=function(e,t,n){return B(this,e,t,!0,n)},u.prototype.writeFloatBE=function(e,t,n){return B(this,e,t,!1,n)},u.prototype.writeDoubleLE=function(e,t,n){return L(this,e,t,!0,n)},u.prototype.writeDoubleBE=function(e,t,n){return L(this,e,t,!1,n)},u.prototype.copy=function(e,t,n,r){if(!u.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);const i=r-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),i},u.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){const t=e.charCodeAt(0);("utf8"===r&&t<128||"latin1"===r)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;let i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{const o=u.isBuffer(e)?e:u.from(e,r),a=o.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<n-t;++i)this[i+t]=o[i%a]}return this};const F={};function q(e,t,n){F[e]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function $(e){let t="",n=e.length;const r="-"===e[0]?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function U(e,t,n,r,i,o){if(e>n||e<t){const r="bigint"==typeof t?"n":"";let i;throw i=o>3?0===t||t===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(o+1)}${r}`:`>= -(2${r} ** ${8*(o+1)-1}${r}) and < 2 ** ${8*(o+1)-1}${r}`:`>= ${t}${r} and <= ${n}${r}`,new F.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,n){K(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||W(t,e.length-(n+1))}(r,i,o)}function K(e,t){if("number"!=typeof e)throw new F.ERR_INVALID_ARG_TYPE(t,"number",e)}function W(e,t,n){if(Math.floor(e)!==e)throw K(e,n),new F.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new F.ERR_BUFFER_OUT_OF_BOUNDS;throw new F.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${t}`,e)}q("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),q("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),q("ERR_OUT_OF_RANGE",(function(e,t,n){let r=`The value of "${e}" is out of range.`,i=n;return Number.isInteger(n)&&Math.abs(n)>2**32?i=$(String(n)):"bigint"==typeof n&&(i=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(i=$(i)),i+="n"),r+=` It must be ${t}. Received ${i}`,r}),RangeError);const H=/[^+/0-9A-Za-z-_]/g;function z(e,t){let n;t=t||1/0;const r=e.length;let i=null;const o=[];for(let a=0;a<r;++a){if(n=e.charCodeAt(a),n>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function Q(e){return r.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(H,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function V(e,t,n,r){let i;for(i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function X(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Y(e){return e!=e}const Z=function(){const e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let i=0;i<16;++i)t[r+i]=e[n]+e[i]}return t}();function J(e){return"undefined"==typeof BigInt?G:e}function G(){throw new Error("BigInt not supported")}},7833:(e,t,n)=>{var r=n(5606);t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(i=r))})),t.splice(i,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(736)(t);const{formatters:i}=e.exports;i.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},736:(e,t,n)=>{e.exports=function(e){function t(e){let n,i,o,a=null;function s(...e){if(!s.enabled)return;const r=s,i=Number(new Date),o=i-(n||i);r.diff=o,r.prev=n,r.curr=i,n=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,i)=>{if("%%"===n)return"%";a++;const o=t.formatters[i];if("function"==typeof o){const t=e[a];n=o.call(r,t),e.splice(a,1),a--}return n})),t.formatArgs.call(r,e);(r.log||t.log).apply(r,e)}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=r,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==a?a:(i!==t.namespaces&&(i=t.namespaces,o=t.enabled(e)),o),set:e=>{a=e}}),"function"==typeof t.init&&t.init(s),s}function r(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(i),...t.skips.map(i).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(6585),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},3744:function(e,t,n){e.exports=function(){"use strict";var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)},t=function(){return(t=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function r(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||((r=r||Array.prototype.slice.call(t,0,i))[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:n.g,o=Object.keys,a=Array.isArray;function s(e,t){return"object"!=typeof t||o(t).forEach((function(n){e[n]=t[n]})),e}"undefined"==typeof Promise||i.Promise||(i.Promise=Promise);var u=Object.getPrototypeOf,c={}.hasOwnProperty;function l(e,t){return c.call(e,t)}function h(e,t){"function"==typeof t&&(t=t(u(e))),("undefined"==typeof Reflect?o:Reflect.ownKeys)(t).forEach((function(n){d(e,n,t[n])}))}var f=Object.defineProperty;function d(e,t,n,r){f(e,t,s(n&&l(n,"get")&&"function"==typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function p(e){return{from:function(t){return e.prototype=Object.create(t.prototype),d(e.prototype,"constructor",e),{extend:h.bind(null,e.prototype)}}}}var m=Object.getOwnPropertyDescriptor,y=[].slice;function v(e,t,n){return y.call(e,t,n)}function g(e,t){return t(e)}function b(e){if(!e)throw new Error("Assertion Failed")}function w(e){i.setImmediate?setImmediate(e):setTimeout(e,0)}function _(e,t){if("string"==typeof t&&l(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var n=[],r=0,i=t.length;r<i;++r){var o=_(e,t[r]);n.push(o)}return n}var a=t.indexOf(".");if(-1!==a){var s=e[t.substr(0,a)];return null==s?void 0:_(s,t.substr(a+1))}}function E(e,t,n){if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){b("string"!=typeof n&&"length"in n);for(var r=0,i=t.length;r<i;++r)E(e,t[r],n[r])}else{var o,s,u=t.indexOf(".");-1!==u?(o=t.substr(0,u),""===(s=t.substr(u+1))?void 0===n?a(e)&&!isNaN(parseInt(o))?e.splice(o,1):delete e[o]:e[o]=n:E(u=(u=e[o])&&l(e,o)?u:e[o]={},s,n)):void 0===n?a(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function k(e){var t,n={};for(t in e)l(e,t)&&(n[t]=e[t]);return n}var S=[].concat;function x(e){return S.apply([],e)}var C="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(x([8,16,32,64].map((function(e){return["Int","Uint","Float"].map((function(t){return t+e+"Array"}))})))).filter((function(e){return i[e]})),O=new Set(C.map((function(e){return i[e]}))),R=null;function I(e){return R=new WeakMap,e=function e(t){if(!t||"object"!=typeof t)return t;var n=R.get(t);if(n)return n;if(a(t)){n=[],R.set(t,n);for(var r=0,i=t.length;r<i;++r)n.push(e(t[r]))}else if(O.has(t.constructor))n=t;else{var o,s=u(t);for(o in n=s===Object.prototype?{}:Object.create(s),R.set(t,n),t)l(t,o)&&(n[o]=e(t[o]))}return n}(e),R=null,e}var P={}.toString;function D(e){return P.call(e).slice(8,-1)}var T="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator",A="symbol"==typeof T?function(e){var t;return null!=e&&(t=e[T])&&t.apply(e)}:function(){return null};function j(e,t){return 0<=(t=e.indexOf(t))&&e.splice(t,1),0<=t}var N={};function M(e){var t,n,r,i;if(1===arguments.length){if(a(e))return e.slice();if(this===N&&"string"==typeof e)return[e];if(i=A(e)){for(n=[];!(r=i.next()).done;)n.push(r.value);return n}if(null==e)return[e];if("number"!=typeof(t=e.length))return[e];for(n=new Array(t);t--;)n[t]=e[t];return n}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var B="undefined"!=typeof Symbol?function(e){return"AsyncFunction"===e[Symbol.toStringTag]}:function(){return!1},L=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(ue=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"]),F={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function q(e,t){this.name=e,this.message=t}function $(e,t){return e+". Errors: "+Object.keys(t).map((function(e){return t[e].toString()})).filter((function(e,t,n){return n.indexOf(e)===t})).join("\n")}function U(e,t,n,r){this.failures=t,this.failedKeys=r,this.successCount=n,this.message=$(e,t)}function K(e,t){this.name="BulkError",this.failures=Object.keys(t).map((function(e){return t[e]})),this.failuresByPos=t,this.message=$(e,this.failures)}p(q).from(Error).extend({toString:function(){return this.name+": "+this.message}}),p(U).from(q),p(K).from(q);var W=L.reduce((function(e,t){return e[t]=t+"Error",e}),{}),H=q,z=L.reduce((function(e,t){var n=t+"Error";function r(e,r){this.name=n,e?"string"==typeof e?(this.message="".concat(e).concat(r?"\n "+r:""),this.inner=r||null):"object"==typeof e&&(this.message="".concat(e.name," ").concat(e.message),this.inner=e):(this.message=F[t]||n,this.inner=null)}return p(r).from(H),e[t]=r,e}),{});z.Syntax=SyntaxError,z.Type=TypeError,z.Range=RangeError;var Q=ue.reduce((function(e,t){return e[t+"Error"]=z[t],e}),{}),V=L.reduce((function(e,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=z[t]),e}),{});function X(){}function Y(e){return e}function Z(e,t){return null==e||e===Y?t:function(n){return t(e(n))}}function J(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function G(e,t){return e===X?t:function(){var n=e.apply(this,arguments);void 0!==n&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?J(r,this.onsuccess):r),i&&(this.onerror=this.onerror?J(i,this.onerror):i),void 0!==o?o:n}}function ee(e,t){return e===X?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?J(n,this.onsuccess):n),r&&(this.onerror=this.onerror?J(r,this.onerror):r)}}function te(e,t){return e===X?t:function(n){var r=e.apply(this,arguments);s(n,r);var i=this.onsuccess,o=this.onerror;return this.onsuccess=null,this.onerror=null,n=t.apply(this,arguments),i&&(this.onsuccess=this.onsuccess?J(i,this.onsuccess):i),o&&(this.onerror=this.onerror?J(o,this.onerror):o),void 0===r?void 0===n?void 0:n:s(r,n)}}function ne(e,t){return e===X?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function re(e,t){return e===X?t:function(){var n=e.apply(this,arguments);if(n&&"function"==typeof n.then){for(var r=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return n.then((function(){return t.apply(r,o)}))}return t.apply(this,arguments)}}V.ModifyError=U,V.DexieError=q,V.BulkError=K;var ie="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function oe(e){ie=e}var ae={},se=100,ue=(C="undefined"==typeof Promise?[]:function(){var e=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[e,u(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,u(t),e]}(),C[0]),ce=(L=C[1],C=C[2],L=L&&L.then,ue&&ue.constructor),le=!!C,he=function(e,t){be.push([e,t]),de&&(queueMicrotask(Ie),de=!1)},fe=!0,de=!0,pe=[],me=[],ye=Y,ve={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:X,pgp:!1,env:{},finalize:X},ge=ve,be=[],we=0,_e=[];function Ee(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=ge;if("function"!=typeof e){if(e!==ae)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&xe(this,this._value))}this._state=null,this._value=null,++t.ref,function e(t,n){try{n((function(n){if(null===t._state){if(n===t)throw new TypeError("A promise cannot be resolved with itself.");var r=t._lib&&Pe();n&&"function"==typeof n.then?e(t,(function(e,t){n instanceof Ee?n._then(e,t):n.then(e,t)})):(t._state=!0,t._value=n,Ce(t)),r&&De()}}),xe.bind(null,t))}catch(n){xe(t,n)}}(this,e)}var ke={get:function(){var e=ge,t=Fe;function n(n,r){var i=this,o=!e.global&&(e!==ge||t!==Fe),a=o&&!Ke(),s=new Ee((function(t,s){Oe(i,new Se(Xe(n,e,o,a),Xe(r,e,o,a),t,s,e))}));return this._consoleTask&&(s._consoleTask=this._consoleTask),s}return n.prototype=ae,n},set:function(e){d(this,"then",e&&e.prototype===ae?ke:{get:function(){return e},set:ke.set})}};function Se(e,t,n,r,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r,this.psd=i}function xe(e,t){var n,r;me.push(t),null===e._state&&(n=e._lib&&Pe(),t=ye(t),e._state=!1,e._value=t,r=e,pe.some((function(e){return e._value===r._value}))||pe.push(r),Ce(e),n&&De())}function Ce(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)Oe(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),0===we&&(++we,he((function(){0==--we&&Te()}),[]))}function Oe(e,t){if(null!==e._state){var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++we,he(Re,[n,e,t])}else e._listeners.push(t)}function Re(e,t,n){try{var r,i=t._value;!t._state&&me.length&&(me=[]),r=ie&&t._consoleTask?t._consoleTask.run((function(){return e(i)})):e(i),t._state||-1!==me.indexOf(i)||function(e){for(var t=pe.length;t;)if(pe[--t]._value===e._value)return pe.splice(t,1)}(t),n.resolve(r)}catch(e){n.reject(e)}finally{0==--we&&Te(),--n.psd.ref||n.psd.finalize()}}function Ie(){Ve(ve,(function(){Pe()&&De()}))}function Pe(){var e=fe;return de=fe=!1,e}function De(){var e,t,n;do{for(;0<be.length;)for(e=be,be=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}}while(0<be.length);de=fe=!0}function Te(){var e=pe;pe=[],e.forEach((function(e){e._PSD.onunhandled.call(null,e._value,e)}));for(var t=_e.slice(0),n=t.length;n;)t[--n]()}function Ae(e){return new Ee(ae,!1,e)}function je(e,t){var n=ge;return function(){var r=Pe(),i=ge;try{return ze(n,!0),e.apply(this,arguments)}catch(r){t&&t(r)}finally{ze(i,!1),r&&De()}}}h(Ee.prototype,{then:ke,_then:function(e,t){Oe(this,new Se(null,null,e,t,ge))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=e,n=arguments[1];return"function"==typeof t?this.then(null,(function(e){return(e instanceof t?n:Ae)(e)})):this.then(null,(function(e){return(e&&e.name===t?n:Ae)(e)}))},finally:function(e){return this.then((function(t){return Ee.resolve(e()).then((function(){return t}))}),(function(t){return Ee.resolve(e()).then((function(){return Ae(t)}))}))},timeout:function(e,t){var n=this;return e<1/0?new Ee((function(r,i){var o=setTimeout((function(){return i(new z.Timeout(t))}),e);n.then(r,i).finally(clearTimeout.bind(null,o))})):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&d(Ee.prototype,Symbol.toStringTag,"Dexie.Promise"),ve.env=Qe(),h(Ee,{all:function(){var e=M.apply(null,arguments).map(We);return new Ee((function(t,n){0===e.length&&t([]);var r=e.length;e.forEach((function(i,o){return Ee.resolve(i).then((function(n){e[o]=n,--r||t(e)}),n)}))}))},resolve:function(e){return e instanceof Ee?e:e&&"function"==typeof e.then?new Ee((function(t,n){e.then(t,n)})):new Ee(ae,!0,e)},reject:Ae,race:function(){var e=M.apply(null,arguments).map(We);return new Ee((function(t,n){e.map((function(e){return Ee.resolve(e).then(t,n)}))}))},PSD:{get:function(){return ge},set:function(e){return ge=e}},totalEchoes:{get:function(){return Fe}},newPSD:$e,usePSD:Ve,scheduler:{get:function(){return he},set:function(e){he=e}},rejectionMapper:{get:function(){return ye},set:function(e){ye=e}},follow:function(e,t){return new Ee((function(n,r){return $e((function(t,n){var r=ge;r.unhandleds=[],r.onunhandled=n,r.finalize=J((function(){var e,r=this;e=function(){0===r.unhandleds.length?t():n(r.unhandleds[0])},_e.push((function t(){e(),_e.splice(_e.indexOf(t),1)})),++we,he((function(){0==--we&&Te()}),[])}),r.finalize),e()}),t,n,r)}))}}),ce&&(ce.allSettled&&d(Ee,"allSettled",(function(){var e=M.apply(null,arguments).map(We);return new Ee((function(t){0===e.length&&t([]);var n=e.length,r=new Array(n);e.forEach((function(e,i){return Ee.resolve(e).then((function(e){return r[i]={status:"fulfilled",value:e}}),(function(e){return r[i]={status:"rejected",reason:e}})).then((function(){return--n||t(r)}))}))}))})),ce.any&&"undefined"!=typeof AggregateError&&d(Ee,"any",(function(){var e=M.apply(null,arguments).map(We);return new Ee((function(t,n){0===e.length&&n(new AggregateError([]));var r=e.length,i=new Array(r);e.forEach((function(e,o){return Ee.resolve(e).then((function(e){return t(e)}),(function(e){i[o]=e,--r||n(new AggregateError(i))}))}))}))})));var Ne={awaits:0,echoes:0,id:0},Me=0,Be=[],Le=0,Fe=0,qe=0;function $e(e,t,n,r){var i=ge,o=Object.create(i);return o.parent=i,o.ref=0,o.global=!1,o.id=++qe,ve.env,o.env=le?{Promise:Ee,PromiseProp:{value:Ee,configurable:!0,writable:!0},all:Ee.all,race:Ee.race,allSettled:Ee.allSettled,any:Ee.any,resolve:Ee.resolve,reject:Ee.reject}:{},t&&s(o,t),++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()},r=Ve(o,e,n,r),0===o.ref&&o.finalize(),r}function Ue(){return Ne.id||(Ne.id=++Me),++Ne.awaits,Ne.echoes+=se,Ne.id}function Ke(){return!!Ne.awaits&&(0==--Ne.awaits&&(Ne.id=0),Ne.echoes=Ne.awaits*se,!0)}function We(e){return Ne.echoes&&e&&e.constructor===ce?(Ue(),e.then((function(e){return Ke(),e}),(function(e){return Ke(),Ze(e)}))):e}function He(){var e=Be[Be.length-1];Be.pop(),ze(e,!1)}function ze(e,t){var n,r=ge;(t?!Ne.echoes||Le++&&e===ge:!Le||--Le&&e===ge)||queueMicrotask(t?function(e){++Fe,Ne.echoes&&0!=--Ne.echoes||(Ne.echoes=Ne.awaits=Ne.id=0),Be.push(ge),ze(e,!0)}.bind(null,e):He),e!==ge&&(ge=e,r===ve&&(ve.env=Qe()),le&&(n=ve.env.Promise,t=e.env,(r.global||e.global)&&(Object.defineProperty(i,"Promise",t.PromiseProp),n.all=t.all,n.race=t.race,n.resolve=t.resolve,n.reject=t.reject,t.allSettled&&(n.allSettled=t.allSettled),t.any&&(n.any=t.any))))}function Qe(){var e=i.Promise;return le?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(i,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function Ve(e,t,n,r,i){var o=ge;try{return ze(e,!0),t(n,r,i)}finally{ze(o,!1)}}function Xe(e,t,n,r){return"function"!=typeof e?e:function(){var i=ge;n&&Ue(),ze(t,!0);try{return e.apply(this,arguments)}finally{ze(i,!1),r&&queueMicrotask(Ke)}}}function Ye(e){Promise===ce&&0===Ne.echoes?0===Le?e():enqueueNativeMicroTask(e):setTimeout(e,0)}-1===(""+L).indexOf("[native code]")&&(Ue=Ke=X);var Ze=Ee.reject,Je=(ue="4.0.1-beta.14",String.fromCharCode(65535)),Ge="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",et="String expected.",tt=[],nt="__dbnames",rt="readonly",it="readwrite";function ot(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var at={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function st(e){return"string"!=typeof e||/\./.test(e)?function(e){return e}:function(t){return void 0===t[e]&&e in t&&delete(t=I(t))[e],t}}function ut(){throw z.Type()}function ct(e,t){try{var n=lt(e),r=lt(t);if(n!==r)return"Array"===n?1:"Array"===r?-1:"binary"===n?1:"binary"===r?-1:"string"===n?1:"string"===r?-1:"Date"===n?1:"Date"!==r?NaN:-1;switch(n){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":return function(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,o=0;o<i;++o)if(e[o]!==t[o])return e[o]<t[o]?-1:1;return n===r?0:n<r?-1:1}(ht(e),ht(t));case"Array":return function(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,o=0;o<i;++o){var a=ct(e[o],t[o]);if(0!==a)return a}return n===r?0:n<r?-1:1}(e,t)}}catch(e){}return NaN}function lt(e){var t=typeof e;return"object"!=t?t:ArrayBuffer.isView(e)||"ArrayBuffer"===(e=D(e))?"binary":e}function ht(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var ft=(dt.prototype._trans=function(e,t,n){var r=this._tx||ge.trans,i=this.name,o=ie&&"undefined"!=typeof console&&console.createTask&&console.createTask("Dexie: ".concat("readonly"===e?"read":"write"," ").concat(this.name));function a(e,n,r){if(!r.schema[i])throw new z.NotFound("Table "+i+" not part of transaction");return t(r.idbtrans,r)}var s=Pe();try{var u=r&&r.db._novip===this.db._novip?r===ge.trans?r._promise(e,a,n):$e((function(){return r._promise(e,a,n)}),{trans:r,transless:ge.transless||ge}):function e(t,n,r,i){if(t.idbdb&&(t._state.openComplete||ge.letThrough||t._vip)){var o=t._createTransaction(n,r,t._dbSchema);try{o.create(),t._state.PR1398_maxLoop=3}catch(o){return o.name===W.InvalidState&&t.isOpen()&&0<--t._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),t.close({disableAutoOpen:!1}),t.open().then((function(){return e(t,n,r,i)}))):Ze(o)}return o._promise(n,(function(e,t){return $e((function(){return ge.trans=o,i(e,t,o)}))})).then((function(e){if("readwrite"===n)try{o.idbtrans.commit()}catch(e){}return"readonly"===n?e:o._completion.then((function(){return e}))}))}if(t._state.openComplete)return Ze(new z.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return Ze(new z.DatabaseClosed);t.open().catch(X)}return t._state.dbReadyPromise.then((function(){return e(t,n,r,i)}))}(this.db,e,[this.name],a);return o&&(u._consoleTask=o,u=u.catch((function(e){return console.trace(e),Ze(e)}))),u}finally{s&&De()}},dt.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):null==e?Ze(new z.Type("Invalid argument to Table.get()")):this._trans("readonly",(function(t){return n.core.get({trans:t,key:e}).then((function(e){return n.hook.reading.fire(e)}))})).then(t)},dt.prototype.where=function(e){if("string"==typeof e)return new this.db.WhereClause(this,e);if(a(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=o(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter((function(e){if(e.compound&&t.every((function(t){return 0<=e.keyPath.indexOf(t)}))){for(var n=0;n<t.length;++n)if(-1===t.indexOf(e.keyPath[n]))return!1;return!0}return!1})).sort((function(e,t){return e.keyPath.length-t.keyPath.length}))[0];if(n&&this.db._maxKey!==Je){var r=n.keyPath.slice(0,t.length);return this.where(r).equals(r.map((function(t){return e[t]})))}!n&&ie&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var i=this.schema.idxByName,s=this.db._deps.indexedDB;function u(e,t){return 0===s.cmp(e,t)}var c=t.reduce((function(t,n){var r=t[0],o=t[1],s=(t=i[n],e[n]);return[r||t,r||!t?ot(o,t&&t.multi?function(e){return e=_(e,n),a(e)&&e.some((function(e){return u(s,e)}))}:function(e){return u(s,_(e,n))}):o]}),[null,null]);return r=c[0],c=c[1],r?this.where(r.name).equals(e[r.keyPath]).filter(c):n?this.filter(c):this.where(t).equals("")},dt.prototype.filter=function(e){return this.toCollection().and(e)},dt.prototype.count=function(e){return this.toCollection().count(e)},dt.prototype.offset=function(e){return this.toCollection().offset(e)},dt.prototype.limit=function(e){return this.toCollection().limit(e)},dt.prototype.each=function(e){return this.toCollection().each(e)},dt.prototype.toArray=function(e){return this.toCollection().toArray(e)},dt.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},dt.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,a(e)?"[".concat(e.join("+"),"]"):e))},dt.prototype.reverse=function(){return this.toCollection().reverse()},dt.prototype.mapToClass=function(t){var n,r=this.db,i=this.name;function o(){return null!==n&&n.apply(this,arguments)||this}(this.schema.mappedClass=t).prototype instanceof ut&&(function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}(o,n=t),Object.defineProperty(o.prototype,"db",{get:function(){return r},enumerable:!1,configurable:!0}),o.prototype.table=function(){return i},t=o);for(var a=new Set,s=t.prototype;s;s=u(s))Object.getOwnPropertyNames(s).forEach((function(e){return a.add(e)}));function c(e){if(!e)return e;var n,r=Object.create(t.prototype);for(n in e)if(!a.has(n))try{r[n]=e[n]}catch(e){}return r}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=c,this.hook("reading",c),t},dt.prototype.defineClass=function(){return this.mapToClass((function(e){s(this,e)}))},dt.prototype.add=function(e,t){var n=this,r=this.schema.primKey,i=r.auto,o=r.keyPath,a=e;return o&&i&&(a=st(o)(e)),this._trans("readwrite",(function(e){return n.core.mutate({trans:e,type:"add",keys:null!=t?[t]:null,values:[a]})})).then((function(e){return e.numFailures?Ee.reject(e.failures[0]):e.lastResult})).then((function(t){if(o)try{E(e,o,t)}catch(t){}return t}))},dt.prototype.update=function(e,t){return"object"!=typeof e||a(e)?this.where(":id").equals(e).modify(t):void 0===(e=_(e,this.schema.primKey.keyPath))?Ze(new z.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t)},dt.prototype.put=function(e,t){var n=this,r=this.schema.primKey,i=r.auto,o=r.keyPath,a=e;return o&&i&&(a=st(o)(e)),this._trans("readwrite",(function(e){return n.core.mutate({trans:e,type:"put",values:[a],keys:null!=t?[t]:null})})).then((function(e){return e.numFailures?Ee.reject(e.failures[0]):e.lastResult})).then((function(t){if(o)try{E(e,o,t)}catch(t){}return t}))},dt.prototype.delete=function(e){var t=this;return this._trans("readwrite",(function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]})})).then((function(e){return e.numFailures?Ee.reject(e.failures[0]):void 0}))},dt.prototype.clear=function(){var e=this;return this._trans("readwrite",(function(t){return e.core.mutate({trans:t,type:"deleteRange",range:at})})).then((function(e){return e.numFailures?Ee.reject(e.failures[0]):void 0}))},dt.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",(function(n){return t.core.getMany({keys:e,trans:n}).then((function(e){return e.map((function(e){return t.hook.reading.fire(e)}))}))}))},dt.prototype.bulkAdd=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0,o=(n=n||(i?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(function(t){var n=(s=r.schema.primKey).auto;if((s=s.keyPath)&&i)throw new z.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new z.InvalidArgument("Arguments objects and keys must have the same length");var a=e.length,s=s&&n?e.map(st(s)):e;return r.core.mutate({trans:t,type:"add",keys:i,values:s,wantResults:o}).then((function(e){var t=e.numFailures,n=e.results,i=e.lastResult;if(e=e.failures,0===t)return o?n:i;throw new K("".concat(r.name,".bulkAdd(): ").concat(t," of ").concat(a," operations failed"),e)}))}))},dt.prototype.bulkPut=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0,o=(n=n||(i?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(function(t){var n=(s=r.schema.primKey).auto;if((s=s.keyPath)&&i)throw new z.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new z.InvalidArgument("Arguments objects and keys must have the same length");var a=e.length,s=s&&n?e.map(st(s)):e;return r.core.mutate({trans:t,type:"put",keys:i,values:s,wantResults:o}).then((function(e){var t=e.numFailures,n=e.results,i=e.lastResult;if(e=e.failures,0===t)return o?n:i;throw new K("".concat(r.name,".bulkPut(): ").concat(t," of ").concat(a," operations failed"),e)}))}))},dt.prototype.bulkUpdate=function(e){var t=this,n=this.core,r=e.map((function(e){return e.key})),i=e.map((function(e){return e.changes})),o=[];return this._trans("readwrite",(function(a){return n.getMany({trans:a,keys:r,cache:"clone"}).then((function(s){var u=[],c=[];e.forEach((function(e,n){var r=e.key,i=e.changes,a=s[n];if(a){for(var l=0,h=Object.keys(i);l<h.length;l++){var f=h[l],d=i[f];if(f===t.schema.primKey.keyPath){if(0!==ct(d,r))throw new z.Constraint("Cannot update primary key in bulkUpdate()")}else E(a,f,d)}o.push(n),u.push(r),c.push(a)}}));var l=u.length;return n.mutate({trans:a,type:"put",keys:u,values:c,updates:{keys:r,changeSpecs:i}}).then((function(e){var n=e.numFailures,r=e.failures;if(0===n)return l;for(var i=0,a=Object.keys(r);i<a.length;i++){var s,u=a[i],c=o[Number(u)];null!=c&&(s=r[u],delete r[u],r[c]=s)}throw new K("".concat(t.name,".bulkUpdate(): ").concat(n," of ").concat(l," operations failed"),r)}))}))}))},dt.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",(function(n){return t.core.mutate({trans:n,type:"delete",keys:e})})).then((function(e){var r=e.numFailures,i=e.lastResult;if(e=e.failures,0===r)return i;throw new K("".concat(t.name,".bulkDelete(): ").concat(r," of ").concat(n," operations failed"),e)}))},dt);function dt(){}function pt(e){function t(t,r){if(r){for(var i=arguments.length,o=new Array(i-1);--i;)o[i-1]=arguments[i];return n[t].subscribe.apply(null,o),e}if("string"==typeof t)return n[t]}var n={};t.addEventType=s;for(var r=1,i=arguments.length;r<i;++r)s(arguments[r]);return t;function s(e,r,i){if("object"!=typeof e){var u;r=r||ne;var c={subscribers:[],fire:i=i||X,subscribe:function(e){-1===c.subscribers.indexOf(e)&&(c.subscribers.push(e),c.fire=r(c.fire,e))},unsubscribe:function(e){c.subscribers=c.subscribers.filter((function(t){return t!==e})),c.fire=c.subscribers.reduce(r,i)}};return n[e]=t[e]=c}o(u=e).forEach((function(e){var t=u[e];if(a(t))s(e,u[e][0],u[e][1]);else{if("asap"!==t)throw new z.InvalidArgument("Invalid event config");var n=s(e,Y,(function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];n.subscribers.forEach((function(e){w((function(){e.apply(null,t)}))}))}))}}))}}function mt(e,t){return p(t).from({prototype:e}),t}function yt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function vt(e,t){e.filter=ot(e.filter,t)}function gt(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return ot(r(),t())}:t,e.justLimit=n&&!r}function bt(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new z.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function wt(e,t,n){var r=bt(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:r,range:e.range}})}function _t(e,t,n,r){var i=e.replayFilter?ot(e.filter,e.replayFilter()):e.filter;if(e.or){var o={},a=function(e,n,r){var a,s;i&&!i(n,r,(function(e){return n.stop(e)}),(function(e){return n.fail(e)}))||("[object ArrayBuffer]"==(s=""+(a=n.primaryKey))&&(s=""+new Uint8Array(a)),l(o,s)||(o[s]=!0,t(e,n,r)))};return Promise.all([e.or._iterate(a,n),Et(wt(e,r,n),e.algorithm,a,!e.keysOnly&&e.valueMapper)])}return Et(wt(e,r,n),ot(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function Et(e,t,n,r){var i=je(r?function(e,t,i){return n(r(e),t,i)}:n);return e.then((function(e){if(e)return e.start((function(){var n=function(){return e.continue()};t&&!t(e,(function(e){return n=e}),(function(t){e.stop(t),n=X}),(function(t){e.fail(t),n=X}))||i(e.value,e,(function(e){return n=e})),n()}))}))}C=Symbol();var kt=(St.prototype.execute=function(e){var t=null===(t=this.replacePrefix)||void 0===t?void 0:t[0];return t&&"string"==typeof e&&e.startsWith(t)?this.replacePrefix[1]+e.substring(t.length):e},St);function St(e){Object.assign(this,e)}var xt=(Ct.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,Ze.bind(null,n.error)):n.table._trans("readonly",e).then(t)},Ct.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,Ze.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},Ct.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=ot(t.algorithm,e)},Ct.prototype._iterate=function(e,t){return _t(this._ctx,e,t,this._ctx.table.core)},Ct.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&s(n,e),t._ctx=n,t},Ct.prototype.raw=function(){return this._ctx.valueMapper=null,this},Ct.prototype.each=function(e){var t=this._ctx;return this._read((function(n){return _t(t,e,n,t.table.core)}))},Ct.prototype.count=function(e){var t=this;return this._read((function(e){var n=t._ctx,r=n.table.core;if(yt(n,!0))return r.count({trans:e,query:{index:bt(n,r.schema),range:n.range}}).then((function(e){return Math.min(e,n.limit)}));var i=0;return _t(n,(function(){return++i,!1}),e,r).then((function(){return i}))})).then(e)},Ct.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),r=n[0],i=n.length-1;function o(e,t){return t?o(e[n[t]],t-1):e[r]}var a="next"===this._ctx.dir?1:-1;function s(e,t){return(e=o(e,i))<(t=o(t,i))?-a:t<e?a:0}return this.toArray((function(e){return e.sort(s)})).then(t)},Ct.prototype.toArray=function(e){var t=this;return this._read((function(e){var n=t._ctx;if("next"===n.dir&&yt(n,!0)&&0<n.limit){var r=n.valueMapper,i=bt(n,n.table.core.schema);return n.table.core.query({trans:e,limit:n.limit,values:!0,query:{index:i,range:n.range}}).then((function(e){return e=e.result,r?e.map(r):e}))}var o=[];return _t(n,(function(e){return o.push(e)}),e,n.table.core).then((function(){return o}))}),e)},Ct.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,yt(t)?gt(t,(function(){var t=e;return function(e,n){return 0===t||(1===t?--t:n((function(){e.advance(t),t=0})),!1)}})):gt(t,(function(){var t=e;return function(){return--t<0}}))),this},Ct.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),gt(this._ctx,(function(){var t=e;return function(e,n,r){return--t<=0&&n(r),0<=t}}),!0),this},Ct.prototype.until=function(e,t){return vt(this._ctx,(function(n,r,i){return!e(n.value)||(r(i),t)})),this},Ct.prototype.first=function(e){return this.limit(1).toArray((function(e){return e[0]})).then(e)},Ct.prototype.last=function(e){return this.reverse().first(e)},Ct.prototype.filter=function(e){var t;return vt(this._ctx,(function(t){return e(t.value)})),(t=this._ctx).isMatch=ot(t.isMatch,e),this},Ct.prototype.and=function(e){return this.filter(e)},Ct.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},Ct.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Ct.prototype.desc=function(){return this.reverse()},Ct.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.key,n)}))},Ct.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},Ct.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.primaryKey,n)}))},Ct.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.key)})).then((function(){return n})).then(e)},Ct.prototype.primaryKeys=function(e){var t=this._ctx;if("next"===t.dir&&yt(t,!0)&&0<t.limit)return this._read((function(e){var n=bt(t,t.table.core.schema);return t.table.core.query({trans:e,values:!1,limit:t.limit,query:{index:n,range:t.range}})})).then((function(e){return e.result})).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.primaryKey)})).then((function(){return n})).then(e)},Ct.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},Ct.prototype.firstKey=function(e){return this.limit(1).keys((function(e){return e[0]})).then(e)},Ct.prototype.lastKey=function(e){return this.reverse().firstKey(e)},Ct.prototype.distinct=function(){var e;if(!(e=(e=this._ctx).index&&e.table.schema.idxByName[e.index])||!e.multi)return this;var t={};return vt(this._ctx,(function(e){var n=e.primaryKey.toString();return e=l(t,n),t[n]=!0,!e})),this},Ct.prototype.modify=function(e){var t=this,n=this._ctx;return this._write((function(r){var i,a,s;function u(e,t){var n=t.failures;t=t.numFailures,m+=e-t;for(var r=0,i=o(n);r<i.length;r++){var a=i[r];p.push(n[a])}}s="function"==typeof e?e:(i=o(e),a=i.length,function(t){for(var n=!1,r=0;r<a;++r){var o=i[r],s=e[o],u=_(t,o);s instanceof kt?(E(t,o,s.execute(u)),n=!0):u!==s&&(E(t,o,s),n=!0)}return n});var c=n.table.core,l=c.schema.primaryKey,h=l.outbound,f=l.extractKey,d=t.db._options.modifyChunkSize||200,p=[],m=0,y=[];return t.clone().primaryKeys().then((function(t){function i(o){var a=Math.min(d,t.length-o);return c.getMany({trans:r,keys:t.slice(o,o+a),cache:"immutable"}).then((function(l){for(var p=[],m=[],y=h?[]:null,v=[],g=0;g<a;++g){var b=l[g],w={value:I(b),primKey:t[o+g]};!1!==s.call(w,w.value,w)&&(null==w.value?v.push(t[o+g]):h||0===ct(f(b),f(w.value))?(m.push(w.value),h&&y.push(t[o+g])):(v.push(t[o+g]),p.push(w.value)))}var _=yt(n)&&n.limit===1/0&&("function"!=typeof e||e===Ot)&&{index:n.index,range:n.range};return Promise.resolve(0<p.length&&c.mutate({trans:r,type:"add",values:p}).then((function(e){for(var t in e.failures)v.splice(parseInt(t),1);u(p.length,e)}))).then((function(){return(0<m.length||_&&"object"==typeof e)&&c.mutate({trans:r,type:"put",keys:y,values:m,criteria:_,changeSpec:"function"!=typeof e&&e}).then((function(e){return u(m.length,e)}))})).then((function(){return(0<v.length||_&&e===Ot)&&c.mutate({trans:r,type:"delete",keys:v,criteria:_}).then((function(e){return u(v.length,e)}))})).then((function(){return t.length>o+a&&i(o+d)}))}))}return i(0).then((function(){if(0<p.length)throw new U("Error modifying one or more objects",p,m,y);return t.length}))}))}))},Ct.prototype.delete=function(){var e=this._ctx,t=e.range;return yt(e)&&(e.isPrimKey||3===t.type)?this._write((function(n){var r=e.table.core.schema.primaryKey,i=t;return e.table.core.count({trans:n,query:{index:r,range:i}}).then((function(t){return e.table.core.mutate({trans:n,type:"deleteRange",range:i}).then((function(e){var n=e.failures;if(e.lastResult,e.results,e=e.numFailures)throw new U("Could not delete some values",Object.keys(n).map((function(e){return n[e]})),t-e);return t-e}))}))})):this.modify(Ot)},Ct);function Ct(){}var Ot=function(e,t){return t.value=null};function Rt(e,t){return e<t?-1:e===t?0:1}function It(e,t){return t<e?-1:e===t?0:1}function Pt(e,t,n){return(e=e instanceof Nt?new e.Collection(e):e)._ctx.error=new(n||TypeError)(t),e}function Dt(e){return new e.Collection(e,(function(){return jt("")})).limit(0)}function Tt(e,t,n,r){var i,o,a,s,u,c,l,h=n.length;if(!n.every((function(e){return"string"==typeof e})))return Pt(e,et);function f(e){i="next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()},o="next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()},a="next"===e?Rt:It;var t=n.map((function(e){return{lower:o(e),upper:i(e)}})).sort((function(e,t){return a(e.lower,t.lower)}));s=t.map((function(e){return e.upper})),u=t.map((function(e){return e.lower})),l="next"===(c=e)?"":r}f("next"),(e=new e.Collection(e,(function(){return At(s[0],u[h-1]+r)})))._ondirectionchange=function(e){f(e)};var d=0;return e._addAlgorithm((function(e,n,r){var i=e.key;if("string"!=typeof i)return!1;var f=o(i);if(t(f,u,d))return!0;for(var p=null,m=d;m<h;++m){var y=function(e,t,n,r,i,o){for(var a=Math.min(e.length,r.length),s=-1,u=0;u<a;++u){var c=t[u];if(c!==r[u])return i(e[u],n[u])<0?e.substr(0,u)+n[u]+n.substr(u+1):i(e[u],r[u])<0?e.substr(0,u)+r[u]+n.substr(u+1):0<=s?e.substr(0,s)+t[s]+n.substr(s+1):null;i(e[u],c)<0&&(s=u)}return a<r.length&&"next"===o?e+n.substr(e.length):a<e.length&&"prev"===o?e.substr(0,n.length):s<0?null:e.substr(0,s)+r[s]+n.substr(s+1)}(i,f,s[m],u[m],a,c);null===y&&null===p?d=m+1:(null===p||0<a(p,y))&&(p=y)}return n(null!==p?function(){e.continue(p+l)}:r),!1})),e}function At(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function jt(e){return{type:1,lower:e,upper:e}}var Nt=(Object.defineProperty(Mt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Mt.prototype.between=function(e,t,n,r){n=!1!==n,r=!0===r;try{return 0<this._cmp(e,t)||0===this._cmp(e,t)&&(n||r)&&(!n||!r)?Dt(this):new this.Collection(this,(function(){return At(e,t,!n,!r)}))}catch(e){return Pt(this,Ge)}},Mt.prototype.equals=function(e){return null==e?Pt(this,Ge):new this.Collection(this,(function(){return jt(e)}))},Mt.prototype.above=function(e){return null==e?Pt(this,Ge):new this.Collection(this,(function(){return At(e,void 0,!0)}))},Mt.prototype.aboveOrEqual=function(e){return null==e?Pt(this,Ge):new this.Collection(this,(function(){return At(e,void 0,!1)}))},Mt.prototype.below=function(e){return null==e?Pt(this,Ge):new this.Collection(this,(function(){return At(void 0,e,!1,!0)}))},Mt.prototype.belowOrEqual=function(e){return null==e?Pt(this,Ge):new this.Collection(this,(function(){return At(void 0,e)}))},Mt.prototype.startsWith=function(e){return"string"!=typeof e?Pt(this,et):this.between(e,e+Je,!0,!0)},Mt.prototype.startsWithIgnoreCase=function(e){return""===e?this.startsWith(e):Tt(this,(function(e,t){return 0===e.indexOf(t[0])}),[e],Je)},Mt.prototype.equalsIgnoreCase=function(e){return Tt(this,(function(e,t){return e===t[0]}),[e],"")},Mt.prototype.anyOfIgnoreCase=function(){var e=M.apply(N,arguments);return 0===e.length?Dt(this):Tt(this,(function(e,t){return-1!==t.indexOf(e)}),e,"")},Mt.prototype.startsWithAnyOfIgnoreCase=function(){var e=M.apply(N,arguments);return 0===e.length?Dt(this):Tt(this,(function(e,t){return t.some((function(t){return 0===e.indexOf(t)}))}),e,Je)},Mt.prototype.anyOf=function(){var e=this,t=M.apply(N,arguments),n=this._cmp;try{t.sort(n)}catch(r){return Pt(this,Ge)}if(0===t.length)return Dt(this);var r=new this.Collection(this,(function(){return At(t[0],t[t.length-1])}));r._ondirectionchange=function(r){n="next"===r?e._ascending:e._descending,t.sort(n)};var i=0;return r._addAlgorithm((function(e,r,o){for(var a=e.key;0<n(a,t[i]);)if(++i===t.length)return r(o),!1;return 0===n(a,t[i])||(r((function(){e.continue(t[i])})),!1)})),r},Mt.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Mt.prototype.noneOf=function(){var e=M.apply(N,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(e){return Pt(this,Ge)}var t=e.reduce((function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[-1/0,t]]}),null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},Mt.prototype.inAnyRange=function(e,t){var n=this,r=this._cmp,i=this._ascending,o=this._descending,a=this._min,s=this._max;if(0===e.length)return Dt(this);if(!e.every((function(e){return void 0!==e[0]&&void 0!==e[1]&&i(e[0],e[1])<=0})))return Pt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",z.InvalidArgument);var u,c=!t||!1!==t.includeLowers,l=t&&!0===t.includeUppers,h=i;function f(e,t){return h(e[0],t[0])}try{(u=e.reduce((function(e,t){for(var n=0,i=e.length;n<i;++n){var o=e[n];if(r(t[0],o[1])<0&&0<r(t[1],o[0])){o[0]=a(o[0],t[0]),o[1]=s(o[1],t[1]);break}}return n===i&&e.push(t),e}),[])).sort(f)}catch(e){return Pt(this,Ge)}var d=0,p=l?function(e){return 0<i(e,u[d][1])}:function(e){return 0<=i(e,u[d][1])},m=c?function(e){return 0<o(e,u[d][0])}:function(e){return 0<=o(e,u[d][0])},y=p;return(e=new this.Collection(this,(function(){return At(u[0][0],u[u.length-1][1],!c,!l)})))._ondirectionchange=function(e){h="next"===e?(y=p,i):(y=m,o),u.sort(f)},e._addAlgorithm((function(e,t,r){for(var o,a=e.key;y(a);)if(++d===u.length)return t(r),!1;return!p(o=a)&&!m(o)||(0===n._cmp(a,u[d][1])||0===n._cmp(a,u[d][0])||t((function(){h===i?e.continue(u[d][0]):e.continue(u[d][1])})),!1)})),e},Mt.prototype.startsWithAnyOf=function(){var e=M.apply(N,arguments);return e.every((function(e){return"string"==typeof e}))?0===e.length?Dt(this):this.inAnyRange(e.map((function(e){return[e,e+Je]}))):Pt(this,"startsWithAnyOf() only works with strings")},Mt);function Mt(){}function Bt(e){return je((function(t){return Lt(t),e(t.target.error),!1}))}function Lt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Ft="storagemutated",qt="x-storagemutated-1",$t=pt(null,Ft),Ut=(Kt.prototype._lock=function(){return b(!ge.global),++this._reculock,1!==this._reculock||ge.global||(ge.lockOwnerFor=this),this},Kt.prototype._unlock=function(){if(b(!ge.global),0==--this._reculock)for(ge.global||(ge.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{Ve(e[1],e[0])}catch(e){}}return this},Kt.prototype._locked=function(){return this._reculock&&ge.lockOwnerFor!==this},Kt.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,r=this.db._state.dbOpenError;if(b(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new z.DatabaseClosed(r);case"MissingAPIError":throw new z.MissingAPI(r.message,r);default:throw new z.OpenFailed(r)}if(!this.active)throw new z.TransactionInactive;return b(null===this._completion._state),(e=this.idbtrans=e||(this.db.core||n).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=je((function(n){Lt(n),t._reject(e.error)})),e.onabort=je((function(n){Lt(n),t.active&&t._reject(new z.Abort(e.error)),t.active=!1,t.on("abort").fire(n)})),e.oncomplete=je((function(){t.active=!1,t._resolve(),"mutatedParts"in e&&$t.storagemutated.fire(e.mutatedParts)})),this},Kt.prototype._promise=function(e,t,n){var r=this;if("readwrite"===e&&"readwrite"!==this.mode)return Ze(new z.ReadOnly("Transaction is readonly"));if(!this.active)return Ze(new z.TransactionInactive);if(this._locked())return new Ee((function(i,o){r._blockedFuncs.push([function(){r._promise(e,t,n).then(i,o)},ge])}));if(n)return $e((function(){var e=new Ee((function(e,n){r._lock();var i=t(e,n,r);i&&i.then&&i.then(e,n)}));return e.finally((function(){return r._unlock()})),e._lib=!0,e}));var i=new Ee((function(e,n){var i=t(e,n,r);i&&i.then&&i.then(e,n)}));return i._lib=!0,i},Kt.prototype._root=function(){return this.parent?this.parent._root():this},Kt.prototype.waitFor=function(e){var t,n=this._root(),r=Ee.resolve(e);n._waitingFor?n._waitingFor=n._waitingFor.then((function(){return r})):(n._waitingFor=r,n._waitingQueue=[],t=n.idbtrans.objectStore(n.storeNames[0]),function e(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(t.get(-1/0).onsuccess=e)}());var i=n._waitingFor;return new Ee((function(e,t){r.then((function(t){return n._waitingQueue.push(je(e.bind(null,t)))}),(function(e){return n._waitingQueue.push(je(t.bind(null,e)))})).finally((function(){n._waitingFor===i&&(n._waitingFor=null)}))}))},Kt.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new z.Abort))},Kt.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(l(t,e))return t[e];var n=this.schema[e];if(!n)throw new z.NotFound("Table "+e+" not part of transaction");return(n=new this.db.Table(e,n,this)).core=this.db.core.table(e),t[e]=n},Kt);function Kt(){}function Wt(e,t,n,r,i,o,a){return{name:e,keyPath:t,unique:n,multi:r,auto:i,compound:o,src:(n&&!a?"&":"")+(r?"*":"")+(i?"++":"")+Ht(t)}}function Ht(e){return"string"==typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function zt(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:(r=function(e){return[e.name,e]},n.reduce((function(e,t,n){return(n=r(t,n))&&(e[n[0]]=n[1]),e}),{}))};var r}var Qt=function(e){try{return e.only([[]]),Qt=function(){return[[]]},[[]]}catch(e){return Qt=function(){return Je},Je}};function Vt(e){return null==e?function(){}:"string"==typeof e?1===(t=e).split(".").length?function(e){return e[t]}:function(e){return _(e,t)}:function(t){return _(t,e)};var t}function Xt(e){return[].slice.call(e)}var Yt=0;function Zt(e){return null==e?":id":"string"==typeof e?e:"[".concat(e.join("+"),"]")}function Jt(e,t,n){function r(e){if(3===e.type)return null;if(4===e.type)throw new Error("Cannot convert never type to IDBKeyRange");var n=e.lower,r=e.upper,i=e.lowerOpen;return e=e.upperOpen,void 0===n?void 0===r?null:t.upperBound(r,!!e):void 0===r?t.lowerBound(n,!!i):t.bound(n,r,!!i,!!e)}function i(e){var t,n=e.name;return{name:n,schema:e,mutate:function(e){var t=e.trans,i=e.type,o=e.keys,a=e.values,s=e.range;return new Promise((function(e,u){e=je(e);var c=t.objectStore(n),l=null==c.keyPath,h="put"===i||"add"===i;if(!h&&"delete"!==i&&"deleteRange"!==i)throw new Error("Invalid operation type: "+i);var f,d=(o||a||{length:1}).length;if(o&&a&&o.length!==a.length)throw new Error("Given keys array must have same length as given values array.");if(0===d)return e({numFailures:0,failures:{},results:[],lastResult:void 0});function p(e){++v,Lt(e)}var m=[],y=[],v=0;if("deleteRange"===i){if(4===s.type)return e({numFailures:v,failures:y,results:[],lastResult:void 0});3===s.type?m.push(f=c.clear()):m.push(f=c.delete(r(s)))}else{var g=(l=h?l?[a,o]:[a,null]:[o,null])[0],b=l[1];if(h)for(var w=0;w<d;++w)m.push(f=b&&void 0!==b[w]?c[i](g[w],b[w]):c[i](g[w])),f.onerror=p;else for(w=0;w<d;++w)m.push(f=c[i](g[w])),f.onerror=p}function _(t){t=t.target.result,m.forEach((function(e,t){return null!=e.error&&(y[t]=e.error)})),e({numFailures:v,failures:y,results:"delete"===i?o:m.map((function(e){return e.result})),lastResult:t})}f.onerror=function(e){p(e),_(e)},f.onsuccess=_}))},getMany:function(e){var t=e.trans,r=e.keys;return new Promise((function(e,i){e=je(e);for(var o,a=t.objectStore(n),s=r.length,u=new Array(s),c=0,l=0,h=function(t){t=t.target,u[t._pos]=t.result,++l===c&&e(u)},f=Bt(i),d=0;d<s;++d)null!=r[d]&&((o=a.get(r[d]))._pos=d,o.onsuccess=h,o.onerror=f,++c);0===c&&e(u)}))},get:function(e){var t=e.trans,r=e.key;return new Promise((function(e,i){e=je(e);var o=t.objectStore(n).get(r);o.onsuccess=function(t){return e(t.target.result)},o.onerror=Bt(i)}))},query:(t=l,function(e){return new Promise((function(i,o){i=je(i);var a,s,u,c=e.trans,l=e.values,h=e.limit,f=e.query,d=h===1/0?void 0:h,p=f.index;if(f=f.range,c=c.objectStore(n),p=p.isPrimaryKey?c:c.index(p.name),f=r(f),0===h)return i({result:[]});t?((d=l?p.getAll(f,d):p.getAllKeys(f,d)).onsuccess=function(e){return i({result:e.target.result})},d.onerror=Bt(o)):(a=0,s=!l&&"openKeyCursor"in p?p.openKeyCursor(f):p.openCursor(f),u=[],s.onsuccess=function(e){var t=s.result;return t?(u.push(l?t.value:t.primaryKey),++a===h?i({result:u}):void t.continue()):i({result:u})},s.onerror=Bt(o))}))}),openCursor:function(e){var t=e.trans,i=e.values,o=e.query,a=e.reverse,s=e.unique;return new Promise((function(e,u){e=je(e);var c=o.index,l=o.range,h=t.objectStore(n),f=(h=c.isPrimaryKey?h:h.index(c.name),c=a?s?"prevunique":"prev":s?"nextunique":"next",!i&&"openKeyCursor"in h?h.openKeyCursor(r(l),c):h.openCursor(r(l),c));f.onerror=Bt(u),f.onsuccess=je((function(n){var r,i,o,a,s=f.result;s?(s.___id=++Yt,s.done=!1,r=s.continue.bind(s),i=(i=s.continuePrimaryKey)&&i.bind(s),o=s.advance.bind(s),a=function(){throw new Error("Cursor not stopped")},s.trans=t,s.stop=s.continue=s.continuePrimaryKey=s.advance=function(){throw new Error("Cursor not started")},s.fail=je(u),s.next=function(){var e=this,t=1;return this.start((function(){return t--?e.continue():e.stop()})).then((function(){return e}))},s.start=function(e){function t(){if(f.result)try{e()}catch(e){s.fail(e)}else s.done=!0,s.start=function(){throw new Error("Cursor behind last entry")},s.stop()}var n=new Promise((function(e,t){e=je(e),f.onerror=Bt(t),s.fail=t,s.stop=function(t){s.stop=s.continue=s.continuePrimaryKey=s.advance=a,e(t)}}));return f.onsuccess=je((function(e){f.onsuccess=t,t()})),s.continue=r,s.continuePrimaryKey=i,s.advance=o,t(),n},e(s)):e(null)}),u)}))},count:function(e){var t=e.query,i=e.trans,o=t.index,a=t.range;return new Promise((function(e,t){var s=i.objectStore(n),u=o.isPrimaryKey?s:s.index(o.name);(u=(s=r(a))?u.count(s):u.count()).onsuccess=je((function(t){return e(t.target.result)})),u.onerror=Bt(t)}))}}}var o,s,u,c=(s=n,u=Xt((o=e).objectStoreNames),{schema:{name:o.name,tables:u.map((function(e){return s.objectStore(e)})).map((function(e){var t=e.keyPath,n=e.autoIncrement,r=a(t),i={};return n={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:null==t,compound:r,keyPath:t,autoIncrement:n,unique:!0,extractKey:Vt(t)},indexes:Xt(e.indexNames).map((function(t){return e.index(t)})).map((function(e){var t=e.name,n=e.unique,r=e.multiEntry;return e=e.keyPath,r={name:t,compound:a(e),keyPath:e,unique:n,multiEntry:r,extractKey:Vt(e)},i[Zt(e)]=r})),getIndexByKeyPath:function(e){return i[Zt(e)]}},i[":id"]=n.primaryKey,null!=t&&(i[Zt(t)]=n.primaryKey),n}))},hasGetAll:0<u.length&&"getAll"in s.objectStore(u[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),l=(n=c.schema,c.hasGetAll),h=(c=n.tables.map(i),{});return c.forEach((function(e){return h[e.name]=e})),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(e){if(!h[e])throw new Error("Table '".concat(e,"' not found"));return h[e]},MIN_KEY:-1/0,MAX_KEY:Qt(t),schema:n}}function Gt(e,n,r,i){var o=r.IDBKeyRange;return r.indexedDB,{dbcore:(i=Jt(n,o,i),e.dbcore.reduce((function(e,n){return n=n.create,t(t({},e),n(e))}),i))}}function en(e,t){var n=t.db;t=Gt(e._middlewares,n,e._deps,t),e.core=t.dbcore,e.tables.forEach((function(t){var n=t.name;e.core.schema.tables.some((function(e){return e.name===n}))&&(t.core=e.core.table(n),e[n]instanceof e.Table&&(e[n].core=t.core))}))}function tn(e,t,n,r){n.forEach((function(n){var i=r[n];t.forEach((function(t){var r=function e(t,n){return m(t,n)||(t=u(t))&&e(t,n)}(t,n);(!r||"value"in r&&void 0===r.value)&&(t===e.Transaction.prototype||t instanceof e.Transaction?d(t,n,{get:function(){return this.table(n)},set:function(e){f(this,n,{value:e,writable:!0,configurable:!0,enumerable:!0})}}):t[n]=new e.Table(n,i))}))}))}function nn(e,t){t.forEach((function(t){for(var n in t)t[n]instanceof e.Table&&delete t[n]}))}function rn(e,t){return e._cfg.version-t._cfg.version}function on(e,t,n,r){var i=e._dbSchema;n.objectStoreNames.contains("$meta")&&!i.$meta&&(i.$meta=zt("$meta",dn("")[0],[]),e._storeNames.push("$meta"));var a=e._createTransaction("readwrite",e._storeNames,i);a.create(n),a._completion.catch(r);var s=a._reject.bind(a),u=ge.transless||ge;$e((function(){return ge.trans=a,ge.transless=u,0!==t?(en(e,n),c=t,((r=a).storeNames.includes("$meta")?r.table("$meta").get("version").then((function(e){return null!=e?e:c})):Ee.resolve(c)).then((function(t){return i=t,s=a,u=n,c=[],t=(r=e)._versions,l=r._dbSchema=hn(0,r.idbdb,u),0!==(t=t.filter((function(e){return e._cfg.version>=i}))).length?(t.forEach((function(e){c.push((function(){var t=l,n=e._cfg.dbschema;fn(r,t,u),fn(r,n,u),l=r._dbSchema=n;var a=sn(t,n);a.add.forEach((function(e){un(u,e[0],e[1].primKey,e[1].indexes)})),a.change.forEach((function(e){if(e.recreate)throw new z.Upgrade("Not yet support for changing primary key");var t=u.objectStore(e.name);e.add.forEach((function(e){return ln(t,e)})),e.change.forEach((function(e){t.deleteIndex(e.name),ln(t,e)})),e.del.forEach((function(e){return t.deleteIndex(e)}))}));var c=e._cfg.contentUpgrade;if(c&&e._cfg.version>i){en(r,u),s._memoizedTables={};var h=k(n);a.del.forEach((function(e){h[e]=t[e]})),nn(r,[r.Transaction.prototype]),tn(r,[r.Transaction.prototype],o(h),h),s.schema=h;var f,d=B(c);return d&&Ue(),a=Ee.follow((function(){var e;(f=c(s))&&d&&(e=Ke.bind(null,null),f.then(e,e))})),f&&"function"==typeof f.then?Ee.resolve(f):a.then((function(){return f}))}})),c.push((function(t){var n,i,o=e._cfg.dbschema;n=o,i=t,[].slice.call(i.db.objectStoreNames).forEach((function(e){return null==n[e]&&i.db.deleteObjectStore(e)})),nn(r,[r.Transaction.prototype]),tn(r,[r.Transaction.prototype],r._storeNames,r._dbSchema),s.schema=r._dbSchema})),c.push((function(t){r.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(r.idbdb.version/10)===e._cfg.version?(r.idbdb.deleteObjectStore("$meta"),delete r._dbSchema.$meta,r._storeNames=r._storeNames.filter((function(e){return"$meta"!==e}))):t.objectStore("$meta").put(e._cfg.version,"version"))}))})),function e(){return c.length?Ee.resolve(c.shift()(s.idbtrans)).then(e):Ee.resolve()}().then((function(){cn(l,u)}))):Ee.resolve();var r,i,s,u,c,l})).catch(s)):(o(i).forEach((function(e){un(n,e,i[e].primKey,i[e].indexes)})),en(e,n),void Ee.follow((function(){return e.on.populate.fire(a)})).catch(s));var r,c}))}function an(e,t){cn(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var n=hn(0,e.idbdb,t);fn(e,e._dbSchema,t);for(var r=0,i=sn(n,e._dbSchema).change;r<i.length;r++){var o=function(e){if(e.change.length||e.recreate)return console.warn("Unable to patch indexes of table ".concat(e.name," because it has changes on the type of index or primary key.")),{value:void 0};var n=t.objectStore(e.name);e.add.forEach((function(t){ie&&console.debug("Dexie upgrade patch: Creating missing index ".concat(e.name,".").concat(t.src)),ln(n,t)}))}(i[r]);if("object"==typeof o)return o.value}}function sn(e,t){var n,r={del:[],add:[],change:[]};for(n in e)t[n]||r.del.push(n);for(n in t){var i=e[n],o=t[n];if(i){var a={name:n,def:o,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(o.primKey.keyPath||"")||i.primKey.auto!==o.primKey.auto)a.recreate=!0,r.change.push(a);else{var s=i.idxByName,u=o.idxByName,c=void 0;for(c in s)u[c]||a.del.push(c);for(c in u){var l=s[c],h=u[c];l?l.src!==h.src&&a.change.push(h):a.add.push(h)}(0<a.del.length||0<a.add.length||0<a.change.length)&&r.change.push(a)}}else r.add.push([n,o])}return r}function un(e,t,n,r){var i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach((function(e){return ln(i,e)})),i}function cn(e,t){o(e).forEach((function(n){t.db.objectStoreNames.contains(n)||(ie&&console.debug("Dexie: Creating missing table",n),un(t,n,e[n].primKey,e[n].indexes))}))}function ln(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function hn(e,t,n){var r={};return v(t.objectStoreNames,0).forEach((function(e){for(var t=n.objectStore(e),i=Wt(Ht(s=t.keyPath),s||"",!0,!1,!!t.autoIncrement,s&&"string"!=typeof s,!0),o=[],a=0;a<t.indexNames.length;++a){var s=(u=t.index(t.indexNames[a])).keyPath,u=Wt(u.name,s,!!u.unique,!!u.multiEntry,!1,s&&"string"!=typeof s,!1);o.push(u)}r[e]=zt(e,i,o)})),r}function fn(e,t,n){for(var r=n.db.objectStoreNames,o=0;o<r.length;++o){var a=r[o],s=n.objectStore(a);e._hasGetAll="getAll"in s;for(var u=0;u<s.indexNames.length;++u){var c=s.indexNames[u],l=s.index(c).keyPath,h="string"==typeof l?l:"["+v(l).join("+")+"]";!t[a]||(l=t[a].idxByName[h])&&(l.name=c,delete t[a].idxByName[h],t[a].idxByName[c]=l)}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&i.WorkerGlobalScope&&i instanceof i.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function dn(e){return e.split(",").map((function(e,t){var n=(e=e.trim()).replace(/([&*]|\+\+)/g,""),r=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;return Wt(n,r||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),a(r),0===t)}))}var pn=(mn.prototype._parseStoresSpec=function(e,t){o(e).forEach((function(n){if(null!==e[n]){var r=dn(e[n]),i=r.shift();if(i.unique=!0,i.multi)throw new z.Schema("Primary key cannot be multi-valued");r.forEach((function(e){if(e.auto)throw new z.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new z.Schema("Index must have a name and cannot be an empty string")})),t[n]=zt(n,i,r)}}))},mn.prototype.stores=function(e){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?s(this._cfg.storesSource,e):e,e=t._versions;var n={},r={};return e.forEach((function(e){s(n,e._cfg.storesSource),r=e._cfg.dbschema={},e._parseStoresSpec(n,r)})),t._dbSchema=r,nn(t,[t._allTables,t,t.Transaction.prototype]),tn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],o(r),r),t._storeNames=o(r),this},mn.prototype.upgrade=function(e){return this._cfg.contentUpgrade=re(this._cfg.contentUpgrade||X,e),this},mn);function mn(){}function yn(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new tr(nt,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),n.table("dbnames")}function vn(e){return e&&"function"==typeof e.databases}function gn(e){return $e((function(){return ge.letThrough=!0,e()}))}function bn(e){return!("from"in e)}var wn=function(e,t){if(!this){var n=new wn;return e&&"d"in e&&s(n,e),n}s(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function _n(e,t,n){var r=ct(t,n);if(!isNaN(r)){if(0<r)throw RangeError();if(bn(e))return s(e,{from:t,to:n,d:1});var i=e.l;if(r=e.r,ct(n,e.from)<0)return i?_n(i,t,n):e.l={from:t,to:n,d:1,l:null,r:null},xn(e);if(0<ct(t,e.to))return r?_n(r,t,n):e.r={from:t,to:n,d:1,l:null,r:null},xn(e);ct(t,e.from)<0&&(e.from=t,e.l=null,e.d=r?r.d+1:1),0<ct(n,e.to)&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1),n=!e.r,i&&!e.l&&En(e,i),r&&n&&En(e,r)}}function En(e,t){bn(t)||function e(t,n){var r=n.from,i=n.to,o=n.l;n=n.r,_n(t,r,i),o&&e(t,o),n&&e(t,n)}(e,t)}function kn(e,t){var n=Sn(t),r=n.next();if(r.done)return!1;for(var i=r.value,o=Sn(e),a=o.next(i.from),s=a.value;!r.done&&!a.done;){if(ct(s.from,i.to)<=0&&0<=ct(s.to,i.from))return!0;ct(i.from,s.from)<0?i=(r=n.next(s.from)).value:s=(a=o.next(i.from)).value}return!1}function Sn(e){var t=bn(e)?null:{s:0,n:e};return{next:function(e){for(var n=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&ct(e,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||ct(e,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function xn(e){var n,r,i=((null===(n=e.r)||void 0===n?void 0:n.d)||0)-((null===(r=e.l)||void 0===r?void 0:r.d)||0),o=1<i?"r":i<-1?"l":"";o&&(n="r"==o?"l":"r",r=t({},e),i=e[o],e.from=i.from,e.to=i.to,e[o]=i[o],r[o]=i[n],(e[n]=r).d=Cn(r)),e.d=Cn(e)}function Cn(e){var t=e.r;return e=e.l,(t?e?Math.max(t.d,e.d):t.d:e?e.d:0)+1}function On(e,t){return o(t).forEach((function(n){e[n]?En(e[n],t[n]):e[n]=function e(t){var n,r,i={};for(n in t)l(t,n)&&(r=t[n],i[n]=!r||"object"!=typeof r||O.has(r.constructor)?r:e(r));return i}(t[n])})),e}function Rn(e,t){return e.all||t.all||Object.keys(e).some((function(n){return t[n]&&kn(t[n],e[n])}))}h(wn.prototype,((L={add:function(e){return En(this,e),this},addKey:function(e){return _n(this,e,e),this},addKeys:function(e){var t=this;return e.forEach((function(e){return _n(t,e,e)})),this}})[T]=function(){return Sn(this)},L));var In={},Pn={},Dn=!1;function Tn(e){On(Pn,e),Dn||(Dn=!0,setTimeout((function(){Dn=!1,An(Pn,!(Pn={}))}),0))}function An(e,t){void 0===t&&(t=!1);var n=new Set;if(e.all)for(var r=0,i=Object.values(In);r<i.length;r++)jn(a=i[r],e,n,t);else for(var o in e){var a,s=/^idb\:\/\/(.*)\/(.*)\//.exec(o);s&&(o=s[1],s=s[2],(a=In["idb://".concat(o,"/").concat(s)])&&jn(a,e,n,t))}n.forEach((function(e){return e()}))}function jn(e,t,n,r){for(var i=[],o=0,a=Object.entries(e.queries.query);o<a.length;o++){for(var s=a[o],u=s[0],c=[],l=0,h=s[1];l<h.length;l++){var f=h[l];Rn(t,f.obsSet)?f.subscribers.forEach((function(e){return n.add(e)})):r&&c.push(f)}r&&i.push([u,c])}if(r)for(var d=0,p=i;d<p.length;d++){var m=p[d];u=m[0],c=m[1],e.queries.query[u]=c}}function Nn(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then((function(){return t.dbOpenError?Ze(t.dbOpenError):e}));t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.openCanceller,i=Math.round(10*e.verno),a=!1;function s(){if(t.openCanceller!==r)throw new z.DatabaseClosed("db.open() was cancelled")}function u(){return new Ee((function(r,c){if(s(),!n)throw new z.MissingAPI;var l=e.name,d=t.autoSchema||!i?n.open(l):n.open(l,i);if(!d)throw new z.MissingAPI;d.onerror=Bt(c),d.onblocked=je(e._fireOnBlocked),d.onupgradeneeded=je((function(r){var i;h=d.transaction,t.autoSchema&&!e._options.allowEmptyDB?(d.onerror=Lt,h.abort(),d.result.close(),(i=n.deleteDatabase(l)).onsuccess=i.onerror=je((function(){c(new z.NoSuchDatabase("Database ".concat(l," doesnt exist")))}))):(h.onerror=Bt(c),r=r.oldVersion>Math.pow(2,62)?0:r.oldVersion,f=r<1,e.idbdb=d.result,a&&an(e,h),on(e,r/10,h,c))}),c),d.onsuccess=je((function(){h=null;var n,s,c,p,m,y=e.idbdb=d.result,g=v(y.objectStoreNames);if(0<g.length)try{var b=y.transaction(1===(p=g).length?p[0]:p,"readonly");if(t.autoSchema)s=y,c=b,(n=e).verno=s.version/10,c=n._dbSchema=hn(0,s,c),n._storeNames=v(s.objectStoreNames,0),tn(n,[n._allTables],o(c),c);else if(fn(e,e._dbSchema,b),((m=sn(hn(0,(m=e).idbdb,b),m._dbSchema)).add.length||m.change.some((function(e){return e.add.length||e.change.length})))&&!a)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),y.close(),i=y.version+1,a=!0,r(u());en(e,b)}catch(n){}tt.push(e),y.onversionchange=je((function(n){t.vcFired=!0,e.on("versionchange").fire(n)})),y.onclose=je((function(t){e.on("close").fire(t)})),f&&(m=e._deps,b=l,y=m.indexedDB,m=m.IDBKeyRange,vn(y)||b===nt||yn(y,m).put({name:b}).catch(X)),r()}),c)})).catch((function(e){switch(null==e?void 0:e.name){case"UnknownError":if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),u();break;case"VersionError":if(0<i)return i=0,u()}return Ee.reject(e)}))}var c,l=t.dbReadyResolve,h=null,f=!1;return Ee.race([r,("undefined"==typeof navigator?Ee.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise((function(e){function t(){return indexedDB.databases().finally(e)}c=setInterval(t,100),t()})).finally((function(){return clearInterval(c)})):Promise.resolve()).then(u)]).then((function(){return s(),t.onReadyBeingFired=[],Ee.resolve(gn((function(){return e.on.ready.fire(e.vip)}))).then((function n(){if(0<t.onReadyBeingFired.length){var r=t.onReadyBeingFired.reduce(re,X);return t.onReadyBeingFired=[],Ee.resolve(gn((function(){return r(e.vip)}))).then(n)}}))})).finally((function(){t.openCanceller===r&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)})).catch((function(n){t.dbOpenError=n;try{h&&h.abort()}catch(n){}return r===t.openCanceller&&e._close(),Ze(n)})).finally((function(){t.openComplete=!0,l()})).then((function(){var t;return f&&(t={},e.tables.forEach((function(n){n.schema.indexes.forEach((function(r){r.name&&(t["idb://".concat(e.name,"/").concat(n.name,"/").concat(r.name)]=new wn(-1/0,[[[]]]))})),t["idb://".concat(e.name,"/").concat(n.name,"/")]=t["idb://".concat(e.name,"/").concat(n.name,"/:dels")]=new wn(-1/0,[[[]]])})),$t(Ft).fire(t),An(t,!0)),e}))}function Mn(e){function t(t){return e.next(t)}var n=i(t),r=i((function(t){return e.throw(t)}));function i(e){return function(t){var i=e(t);return t=i.value,i.done?t:t&&"function"==typeof t.then?t.then(n,r):a(t)?Promise.all(t).then(n,r):n(t)}}return i(t)()}function Bn(e,t,n){for(var r=a(e)?e.slice():[e],i=0;i<n;++i)r.push(t);return r}var Ln={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return t(t({},e),{table:function(n){var r=e.table(n),i=r.schema,o={},a=[];function s(e,n,r){var i=Zt(e),u=o[i]=o[i]||[],c=null==e?0:"string"==typeof e?1:e.length,l=0<n;return l=t(t({},r),{name:l?"".concat(i,"(virtual-from:").concat(r.name,")"):r.name,lowLevelIndex:r,isVirtual:l,keyTail:n,keyLength:c,extractKey:Vt(e),unique:!l&&r.unique}),u.push(l),l.isPrimaryKey||a.push(l),1<c&&s(2===c?e[0]:e.slice(0,c-1),n+1,r),u.sort((function(e,t){return e.keyTail-t.keyTail})),l}n=s(i.primaryKey.keyPath,0,i.primaryKey),o[":id"]=[n];for(var u=0,c=i.indexes;u<c.length;u++){var l=c[u];s(l.keyPath,0,l)}function h(n){var r,i=n.query.index;return i.isVirtual?t(t({},n),{query:{index:i.lowLevelIndex,range:(r=n.query.range,i=i.keyTail,{type:1===r.type?2:r.type,lower:Bn(r.lower,r.lowerOpen?e.MAX_KEY:e.MIN_KEY,i),lowerOpen:!0,upper:Bn(r.upper,r.upperOpen?e.MIN_KEY:e.MAX_KEY,i),upperOpen:!0})}}):n}return t(t({},r),{schema:t(t({},i),{primaryKey:n,indexes:a,getIndexByKeyPath:function(e){return(e=o[Zt(e)])&&e[0]}}),count:function(e){return r.count(h(e))},query:function(e){return r.query(h(e))},openCursor:function(t){var n=t.query.index,i=n.keyTail,o=n.isVirtual,a=n.keyLength;return o?r.openCursor(h(t)).then((function(e){return e&&s(e)})):r.openCursor(t);function s(n){return Object.create(n,{continue:{value:function(r){null!=r?n.continue(Bn(r,t.reverse?e.MAX_KEY:e.MIN_KEY,i)):t.unique?n.continue(n.key.slice(0,a).concat(t.reverse?e.MIN_KEY:e.MAX_KEY,i)):n.continue()}},continuePrimaryKey:{value:function(t,r){n.continuePrimaryKey(Bn(t,e.MAX_KEY,i),r)}},primaryKey:{get:function(){return n.primaryKey}},key:{get:function(){var e=n.key;return 1===a?e[0]:e.slice(0,a)}},value:{get:function(){return n.value}}})}}})}})}};function Fn(e,t,n,r){return n=n||{},r=r||"",o(e).forEach((function(i){var o,a,s;l(t,i)?(o=e[i],a=t[i],"object"==typeof o&&"object"==typeof a&&o&&a?(s=D(o))!==D(a)?n[r+i]=t[i]:"Object"===s?Fn(o,a,n,r+i+"."):o!==a&&(n[r+i]=t[i]):o!==a&&(n[r+i]=t[i])):n[r+i]=void 0})),o(t).forEach((function(i){l(e,i)||(n[r+i]=t[i])})),n}function qn(e,t){return"delete"===t.type?t.keys:t.keys||t.values.map(e.extractKey)}var $n={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return t(t({},e),{table:function(n){var i=e.table(n),o=i.schema.primaryKey;return t(t({},i),{mutate:function(e){var a=ge.trans,s=a.table(n).hook,u=s.deleting,c=s.creating,h=s.updating;switch(e.type){case"add":if(c.fire===X)break;return a._promise("readwrite",(function(){return f(e)}),!0);case"put":if(c.fire===X&&h.fire===X)break;return a._promise("readwrite",(function(){return f(e)}),!0);case"delete":if(u.fire===X)break;return a._promise("readwrite",(function(){return f(e)}),!0);case"deleteRange":if(u.fire===X)break;return a._promise("readwrite",(function(){return function e(n,r,a){return i.query({trans:n,values:!1,query:{index:o,range:r},limit:a}).then((function(i){var o=i.result;return f({type:"delete",keys:o,trans:n}).then((function(i){return 0<i.numFailures?Promise.reject(i.failures[0]):o.length<a?{failures:[],numFailures:0,lastResult:void 0}:e(n,t(t({},r),{lower:o[o.length-1],lowerOpen:!0}),a)}))}))}(e.trans,e.range,1e4)}),!0)}return i.mutate(e);function f(e){var n,a,s,f=ge.trans,d=e.keys||qn(o,e);if(!d)throw new Error("Keys missing");return"delete"!==(e="add"===e.type||"put"===e.type?t(t({},e),{keys:d}):t({},e)).type&&(e.values=r([],e.values,!0)),e.keys&&(e.keys=r([],e.keys,!0)),n=i,s=d,("add"===(a=e).type?Promise.resolve([]):n.getMany({trans:a.trans,keys:s,cache:"immutable"})).then((function(t){var n=d.map((function(n,r){var i,a,s,d=t[r],p={onerror:null,onsuccess:null};return"delete"===e.type?u.fire.call(p,n,d,f):"add"===e.type||void 0===d?(i=c.fire.call(p,n,e.values[r],f),null==n&&null!=i&&(e.keys[r]=n=i,o.outbound||E(e.values[r],o.keyPath,n))):(i=Fn(d,e.values[r]),(a=h.fire.call(p,i,n,d,f))&&(s=e.values[r],Object.keys(a).forEach((function(e){l(s,e)?s[e]=a[e]:E(s,e,a[e])})))),p}));return i.mutate(e).then((function(r){for(var i=r.failures,o=r.results,a=r.numFailures,s=(r=r.lastResult,0);s<d.length;++s){var u=(o||d)[s],c=n[s];null==u?c.onerror&&c.onerror(i[s]):c.onsuccess&&c.onsuccess("put"===e.type&&t[s]?e.values[s]:u)}return{failures:i,results:o,numFailures:a,lastResult:r}})).catch((function(e){return n.forEach((function(t){return t.onerror&&t.onerror(e)})),Promise.reject(e)}))}))}}})}})}};function Un(e,t,n){try{if(!t)return null;if(t.keys.length<e.length)return null;for(var r=[],i=0,o=0;i<t.keys.length&&o<e.length;++i)0===ct(t.keys[i],e[o])&&(r.push(n?I(t.values[i]):t.values[i]),++o);return r.length===e.length?r:null}catch(e){return null}}var Kn={stack:"dbcore",level:-1,create:function(e){return{table:function(n){var r=e.table(n);return t(t({},r),{getMany:function(e){if(!e.cache)return r.getMany(e);var t=Un(e.keys,e.trans._cache,"clone"===e.cache);return t?Ee.resolve(t):r.getMany(e).then((function(t){return e.trans._cache={keys:e.keys,values:"clone"===e.cache?I(t):t},t}))},mutate:function(e){return"add"!==e.type&&(e.trans._cache=null),r.mutate(e)}})}}}};function Wn(e,t){return"readonly"===e.trans.mode&&!!e.subscr&&!e.trans.explicit&&"disabled"!==e.trans.db._options.cache&&!t.schema.primaryKey.outbound}function Hn(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var zn={stack:"dbcore",level:0,name:"Observability",create:function(e){var n=e.schema.name,r=new wn(e.MIN_KEY,e.MAX_KEY);return t(t({},e),{transaction:function(t,n,r){if(ge.subscr&&"readonly"!==n)throw new z.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(ge.querier));return e.transaction(t,n,r)},table:function(i){function s(t){t=(n=t.query).index;var n=n.range;return[t,new wn(null!==(t=n.lower)&&void 0!==t?t:e.MIN_KEY,null!==(n=n.upper)&&void 0!==n?n:e.MAX_KEY)]}var u=e.table(i),c=u.schema,l=c.primaryKey,h=l.extractKey,f=l.outbound,d=t(t({},u),{mutate:function(e){function t(e){return e="idb://".concat(n,"/").concat(i,"/").concat(e),d[e]||(d[e]=new wn)}var o,s,h,f=e.trans,d=e.mutatedParts||(e.mutatedParts={}),p=t(""),m=t(":dels"),y=e.type,v="deleteRange"===e.type?[e.range]:"delete"===e.type?[e.keys]:e.values.length<50?[qn(l,e).filter((function(e){return e})),e.values]:[],g=v[0],b=v[1];return v=e.trans._cache,a(g)?(p.addKeys(g),(v="delete"===y||g.length===b.length?Un(g,v):null)||m.addKeys(g),(v||b)&&(o=t,s=v,h=b,c.indexes.forEach((function(e){var t=o(e.name||"");function n(t){return null!=t?e.extractKey(t):null}function r(n){return e.multiEntry&&a(n)?n.forEach((function(e){return t.addKey(e)})):t.addKey(n)}(s||h).forEach((function(e,t){var i=s&&n(s[t]);0!==ct(i,t=h&&n(h[t]))&&(null!=i&&r(i),null!=t&&r(t))}))})))):g?(b={from:g.lower,to:g.upper},m.add(b),p.add(b)):(p.add(r),m.add(r),c.indexes.forEach((function(e){return t(e.name).add(r)}))),u.mutate(e).then((function(t){return!g||"add"!==e.type&&"put"!==e.type||p.addKeys(t.results),f.mutatedParts=On(f.mutatedParts||{},d),t}))}}),p={get:function(e){return[l,new wn(e.key)]},getMany:function(e){return[l,(new wn).addKeys(e.keys)]},count:s,query:s,openCursor:s};return o(p).forEach((function(e){d[e]=function(o){var a=!!(m=ge.subscr),s=Wn(ge,u)&&Hn(e,o)?o.obsSet={}:m;if(a){var c=function(e){return e="idb://".concat(n,"/").concat(i,"/").concat(e),s[e]||(s[e]=new wn)},l=c(""),d=c(":dels"),m=(a=(m=p[e](o))[0],m[1]);if(("query"===e&&a.isPrimaryKey&&!o.values?d:c(a.name||"")).add(m),!a.isPrimaryKey){if("count"!==e){var y="query"===e&&f&&o.values&&u.query(t(t({},o),{values:!1}));return u[e].apply(this,arguments).then((function(t){if("query"===e){if(f&&o.values)return y.then((function(e){return e=e.result,l.addKeys(e),t}));var n=o.values?t.result.map(h):t.result;(o.values?l:d).addKeys(n)}else if("openCursor"===e){var r=t,i=o.values;return r&&Object.create(r,{key:{get:function(){return d.addKey(r.primaryKey),r.key}},primaryKey:{get:function(){var e=r.primaryKey;return d.addKey(e),e}},value:{get:function(){return i&&l.addKey(r.primaryKey),r.value}}})}return t}))}d.add(r)}}return u[e].apply(this,arguments)}})),d}})}};function Qn(e,n,r){if(0===r.numFailures)return n;if("deleteRange"===n.type)return null;var i=n.keys?n.keys.length:"values"in n&&n.values?n.values.length:1;return r.numFailures===i?null:(n=t({},n),a(n.keys)&&(n.keys=n.keys.filter((function(e,t){return!(t in r.failures)}))),"values"in n&&a(n.values)&&(n.values=n.values.filter((function(e,t){return!(t in r.failures)}))),n)}function Vn(e,t){return n=e,(void 0===(r=t).lower||(r.lowerOpen?0<ct(n,r.lower):0<=ct(n,r.lower)))&&(void 0===t.upper||(t.upperOpen?ct(e,t.upper)<0:ct(e,t.upper)<=0));var n,r}function Xn(e,t,n,r,i,o){if(!n||0===n.length)return e;var s=t.query.index,u=s.multiEntry,c=t.query.range,l=r.schema.primaryKey.extractKey,h=s.extractKey,f=(s.lowLevelIndex||s).extractKey;return n=n.reduce((function(e,n){var r=e,i="add"===n.type||"put"===n.type?n.values.filter((function(e){return e=h(e),u&&a(e)?e.some((function(e){return Vn(e,c)})):Vn(e,c)})).map((function(e){return e=I(e),o&&Object.freeze(e),e})):[];switch(n.type){case"add":r=e.concat(t.values?i:i.map((function(e){return l(e)})));break;case"put":var s=(new wn).addKeys(n.values.map((function(e){return l(e)})));r=e.filter((function(e){return e=t.values?l(e):e,!kn(new wn(e),s)})).concat(t.values?i:i.map((function(e){return l(e)})));break;case"delete":var f=(new wn).addKeys(n.keys);r=e.filter((function(e){return e=t.values?l(e):e,!kn(new wn(e),f)}));break;case"deleteRange":var d=n.range;r=e.filter((function(e){return!Vn(l(e),d)}))}return r}),e),n===e?e:(n.sort((function(e,t){return ct(f(e),f(t))||ct(l(e),l(t))})),t.limit&&t.limit<1/0&&(n.length>t.limit?n.length=t.limit:e.length===t.limit&&n.length<t.limit&&(i.dirty=!0)),o?Object.freeze(n):n)}function Yn(e,t){return 0===ct(e.lower,t.lower)&&0===ct(e.upper,t.upper)&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function Zn(e,t){return function(e,t,n,r){if(void 0===e)return void 0!==t?-1:0;if(void 0===t)return 1;if(0===(t=ct(e,t))){if(n&&r)return 0;if(n)return 1;if(r)return-1}return t}(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=function(e,t,n,r){if(void 0===e)return void 0!==t?1:0;if(void 0===t)return-1;if(0===(t=ct(e,t))){if(n&&r)return 0;if(n)return-1;if(r)return 1}return t}(e.upper,t.upper,e.upperOpen,t.upperOpen)}function Jn(e,t,n,r){e.subscribers.add(n),r.addEventListener("abort",(function(){var r,i;e.subscribers.delete(n),0===e.subscribers.size&&(r=e,i=t,setTimeout((function(){0===r.subscribers.size&&j(i,r)}),3e3))}))}var Gn={stack:"dbcore",level:0,name:"Cache",create:function(e){var n=e.schema.name;return t(t({},e),{transaction:function(t,r,i){var o,a,s=e.transaction(t,r,i);return"readwrite"===r&&(a=(o=new AbortController).signal,i=function(i){return function(){if(o.abort(),"readwrite"===r){for(var a=new Set,u=0,c=t;u<c.length;u++){var l=c[u],h=In["idb://".concat(n,"/").concat(l)];if(h){var f=e.table(l),d=h.optimisticOps.filter((function(e){return e.trans===s}));if(s._explicit&&i&&s.mutatedParts)for(var p=0,m=Object.values(h.queries.query);p<m.length;p++)for(var y=0,v=(w=m[p]).slice();y<v.length;y++)Rn((_=v[y]).obsSet,s.mutatedParts)&&(j(w,_),_.subscribers.forEach((function(e){return a.add(e)})));else if(0<d.length){h.optimisticOps=h.optimisticOps.filter((function(e){return e.trans!==s}));for(var g=0,b=Object.values(h.queries.query);g<b.length;g++)for(var w,_,E,k=0,S=(w=b[g]).slice();k<S.length;k++)null!=(_=S[k]).res&&s.mutatedParts&&(i&&!_.dirty?(E=Object.isFrozen(_.res),E=Xn(_.res,_.req,d,f,_,E),_.dirty?(j(w,_),_.subscribers.forEach((function(e){return a.add(e)}))):E!==_.res&&(_.res=E,_.promise=Ee.resolve({result:E}))):(_.dirty&&j(w,_),_.subscribers.forEach((function(e){return a.add(e)}))))}}}a.forEach((function(e){return e()}))}}},s.addEventListener("abort",i(!1),{signal:a}),s.addEventListener("error",i(!1),{signal:a}),s.addEventListener("complete",i(!0),{signal:a})),s},table:function(r){var i=e.table(r),o=i.schema.primaryKey;return t(t({},i),{mutate:function(e){var a=ge.trans;if(o.outbound||"disabled"===a.db._options.cache||a.explicit)return i.mutate(e);var s=In["idb://".concat(n,"/").concat(r)];return s?(a=i.mutate(e),"add"!==e.type&&"put"!==e.type||!(50<=e.values.length||qn(o,e).some((function(e){return null==e})))?(s.optimisticOps.push(e),e.mutatedParts&&Tn(e.mutatedParts),a.then((function(t){0<t.numFailures&&(j(s.optimisticOps,e),(t=Qn(0,e,t))&&s.optimisticOps.push(t),e.mutatedParts&&Tn(e.mutatedParts))})),a.catch((function(){j(s.optimisticOps,e),e.mutatedParts&&Tn(e.mutatedParts)}))):a.then((function(n){var r=Qn(0,t(t({},e),{values:e.values.map((function(e,r){var i;return E(e=null!==(i=o.keyPath)&&void 0!==i&&i.includes(".")?I(e):t({},e),o.keyPath,n.results[r]),e}))}),n);s.optimisticOps.push(r),queueMicrotask((function(){return e.mutatedParts&&Tn(e.mutatedParts)}))})),a):i.mutate(e)},query:function(e){if(!Wn(ge,i)||!Hn("query",e))return i.query(e);var t="immutable"===(null===(s=ge.trans)||void 0===s?void 0:s.db._options.cache),o=(c=ge).requery,a=c.signal,s=function(e,t,n,r){var i=In["idb://".concat(e,"/").concat(t)];if(!i)return[];if(!(t=i.queries[n]))return[null,!1,i,null];var o=t[(r.query?r.query.index.name:null)||""];if(!o)return[null,!1,i,null];switch(n){case"query":var a=o.find((function(e){return e.req.limit===r.limit&&e.req.values===r.values&&Yn(e.req.query.range,r.query.range)}));return a?[a,!0,i,o]:[o.find((function(e){return("limit"in e.req?e.req.limit:1/0)>=r.limit&&(!r.values||e.req.values)&&Zn(e.req.query.range,r.query.range)})),!1,i,o];case"count":return a=o.find((function(e){return Yn(e.req.query.range,r.query.range)})),[a,!!a,i,o]}}(n,r,"query",e),u=s[0],c=s[1],l=s[2],h=s[3];return u&&c?u.obsSet=e.obsSet:(c=i.query(e).then((function(e){var n=e.result;if(u&&(u.res=n),t){for(var r=0,i=n.length;r<i;++r)Object.freeze(n[r]);Object.freeze(n)}else e.result=I(n);return e})).catch((function(e){return h&&u&&j(h,u),Promise.reject(e)})),u={obsSet:e.obsSet,promise:c,subscribers:new Set,type:"query",req:e,dirty:!1},h?h.push(u):(h=[u],(l=l||(In["idb://".concat(n,"/").concat(r)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[e.query.index.name||""]=h)),Jn(u,h,o,a),u.promise.then((function(n){return{result:Xn(n.result,e,null==l?void 0:l.optimisticOps,i,u,t)}}))}})}})}};function er(e,t){return new Proxy(e,{get:function(e,n,r){return"db"===n?t:Reflect.get(e,n,r)}})}var tr=(nr.prototype.version=function(e){if(isNaN(e)||e<.1)throw new z.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new z.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter((function(t){return t._cfg.version===e}))[0];return n||(n=new this.Version(e),t.push(n),t.sort(rn),n.stores({}),this._state.autoSchema=!1,n)},nr.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||ge.letThrough||this._vip)?e():new Ee((function(e,n){if(t._state.openComplete)return n(new z.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void n(new z.DatabaseClosed);t.open().catch(X)}t._state.dbReadyPromise.then(e,n)})).then(e)},nr.prototype.use=function(e){var t=e.stack,n=e.create,r=e.level,i=e.name;return i&&this.unuse({stack:t,name:i}),(e=this._middlewares[t]||(this._middlewares[t]=[])).push({stack:t,create:n,level:null==r?10:r,name:i}),e.sort((function(e,t){return e.level-t.level})),this},nr.prototype.unuse=function(e){var t=e.stack,n=e.name,r=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter((function(e){return r?e.create!==r:!!n&&e.name!==n}))),this},nr.prototype.open=function(){var e=this;return Ve(ve,(function(){return Nn(e)}))},nr.prototype._close=function(){var e=this._state,t=tt.indexOf(this);if(0<=t&&tt.splice(t,1),this.idbdb){try{this.idbdb.close()}catch(t){}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new Ee((function(t){e.dbReadyResolve=t})),e.openCanceller=new Ee((function(t,n){e.cancelOpen=n})))},nr.prototype.close=function(e){var t=(void 0===e?{disableAutoOpen:!0}:e).disableAutoOpen;e=this._state,t?(e.isBeingOpened&&e.cancelOpen(new z.DatabaseClosed),this._close(),e.autoOpen=!1,e.dbOpenError=new z.DatabaseClosed):(this._close(),e.autoOpen=this._options.autoOpen||e.isBeingOpened,e.openComplete=!1,e.dbOpenError=null)},nr.prototype.delete=function(e){var t=this;void 0===e&&(e={disableAutoOpen:!0});var n=0<arguments.length&&"object"!=typeof arguments[0],r=this._state;return new Ee((function(i,o){function a(){t.close(e);var n=t._deps.indexedDB.deleteDatabase(t.name);n.onsuccess=je((function(){var e,n,r;e=t._deps,n=t.name,r=e.indexedDB,e=e.IDBKeyRange,vn(r)||n===nt||yn(r,e).delete(n).catch(X),i()})),n.onerror=Bt(o),n.onblocked=t._fireOnBlocked}if(n)throw new z.InvalidArgument("Invalid closeOptions argument to db.delete()");r.isBeingOpened?r.dbReadyPromise.then(a):a()}))},nr.prototype.backendDB=function(){return this.idbdb},nr.prototype.isOpen=function(){return null!==this.idbdb},nr.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name},nr.prototype.hasFailed=function(){return null!==this._state.dbOpenError},nr.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(nr.prototype,"tables",{get:function(){var e=this;return o(this._allTables).map((function(t){return e._allTables[t]}))},enumerable:!1,configurable:!0}),nr.prototype.transaction=function(){var e=function(e,t,n){var r=arguments.length;if(r<2)throw new z.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];return n=i.pop(),[e,x(i),n]}.apply(this,arguments);return this._transaction.apply(this,e)},nr.prototype._transaction=function(e,t,n){var r=this,i=ge.trans;i&&i.db===this&&-1===e.indexOf("!")||(i=null);var o,a,s=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{if(a=t.map((function(e){if("string"!=typeof(e=e instanceof r.Table?e.name:e))throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return e})),"r"==e||e===rt)o=rt;else{if("rw"!=e&&e!=it)throw new z.InvalidArgument("Invalid transaction mode: "+e);o=it}if(i){if(i.mode===rt&&o===it){if(!s)throw new z.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i=null}i&&a.forEach((function(e){if(i&&-1===i.storeNames.indexOf(e)){if(!s)throw new z.SubTransaction("Table "+e+" not included in parent transaction.");i=null}})),s&&i&&!i.active&&(i=null)}}catch(n){return i?i._promise(null,(function(e,t){t(n)})):Ze(n)}var u=function e(t,n,r,i,o){return Ee.resolve().then((function(){var a=ge.transless||ge,s=t._createTransaction(n,r,t._dbSchema,i);if(s.explicit=!0,a={trans:s,transless:a},i)s.idbtrans=i.idbtrans;else try{s.create(),s.idbtrans._explicit=!0,t._state.PR1398_maxLoop=3}catch(a){return a.name===W.InvalidState&&t.isOpen()&&0<--t._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),t.close({disableAutoOpen:!1}),t.open().then((function(){return e(t,n,r,null,o)}))):Ze(a)}var u,c=B(o);return c&&Ue(),a=Ee.follow((function(){var e;(u=o.call(s,s))&&(c?(e=Ke.bind(null,null),u.then(e,e)):"function"==typeof u.next&&"function"==typeof u.throw&&(u=Mn(u)))}),a),(u&&"function"==typeof u.then?Ee.resolve(u).then((function(e){return s.active?e:Ze(new z.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))})):a.then((function(){return u}))).then((function(e){return i&&s._resolve(),s._completion.then((function(){return e}))})).catch((function(e){return s._reject(e),Ze(e)}))}))}.bind(null,this,o,a,i,n);return i?i._promise(o,u,"lock"):ge.trans?Ve(ge.transless,(function(){return r._whenReady(u)})):this._whenReady(u)},nr.prototype.table=function(e){if(!l(this._allTables,e))throw new z.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},nr);function nr(e,n){var r=this;this._middlewares={},this.verno=0;var i=nr.dependencies;this._options=n=t({addons:nr.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange,cache:"cloned"},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange},i=n.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var o,a,s,u,c,l={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:X,dbReadyPromise:null,cancelOpen:X,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:n.autoOpen};l.dbReadyPromise=new Ee((function(e){l.dbReadyResolve=e})),l.openCanceller=new Ee((function(e,t){l.cancelOpen=t})),this._state=l,this.name=e,this.on=pt(this,"populate","blocked","versionchange","close",{ready:[re,X]}),this.on.ready.subscribe=g(this.on.ready.subscribe,(function(e){return function(t,n){nr.vip((function(){var i,o=r._state;o.openComplete?(o.dbOpenError||Ee.resolve().then(t),n&&e(t)):o.onReadyBeingFired?(o.onReadyBeingFired.push(t),n&&e(t)):(e(t),i=r,n||e((function e(){i.on.ready.unsubscribe(t),i.on.ready.unsubscribe(e)})))}))}})),this.Collection=(o=this,mt(xt.prototype,(function(e,t){this.db=o;var n=at,r=null;if(t)try{n=t()}catch(e){r=e}var i=e._ctx;e=(t=i.table).hook.reading.fire,this._ctx={table:t,index:i.index,isPrimKey:!i.index||t.schema.primKey.keyPath&&i.index===t.schema.primKey.name,range:n,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:r,or:i.or,valueMapper:e!==Y?e:null}}))),this.Table=(a=this,mt(ft.prototype,(function(e,t,n){this.db=a,this._tx=n,this.name=e,this.schema=t,this.hook=a._allTables[e]?a._allTables[e].hook:pt(null,{creating:[G,X],reading:[Z,Y],updating:[te,X],deleting:[ee,X]})}))),this.Transaction=(s=this,mt(Ut.prototype,(function(e,t,n,r,i){var o=this;this.db=s,this.mode=e,this.storeNames=t,this.schema=n,this.chromeTransactionDurability=r,this.idbtrans=null,this.on=pt(this,"complete","error","abort"),this.parent=i||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Ee((function(e,t){o._resolve=e,o._reject=t})),this._completion.then((function(){o.active=!1,o.on.complete.fire()}),(function(e){var t=o.active;return o.active=!1,o.on.error.fire(e),o.parent?o.parent._reject(e):t&&o.idbtrans&&o.idbtrans.abort(),Ze(e)}))}))),this.Version=(u=this,mt(pn.prototype,(function(e){this.db=u,this._cfg={version:e,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))),this.WhereClause=(c=this,mt(Nt.prototype,(function(e,t,n){if(this.db=c,this._ctx={table:e,index:":id"===t?null:t,or:n},this._cmp=this._ascending=ct,this._descending=function(e,t){return ct(t,e)},this._max=function(e,t){return 0<ct(e,t)?e:t},this._min=function(e,t){return ct(e,t)<0?e:t},this._IDBKeyRange=c._deps.IDBKeyRange,!this._IDBKeyRange)throw new z.MissingAPI}))),this.on("versionchange",(function(e){0<e.newVersion?console.warn("Another connection wants to upgrade database '".concat(r.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(r.name,"'. Closing db now to resume the delete request.")),r.close({disableAutoOpen:!1})})),this.on("blocked",(function(e){!e.newVersion||e.newVersion<e.oldVersion?console.warn("Dexie.delete('".concat(r.name,"') was blocked")):console.warn("Upgrade '".concat(r.name,"' blocked by other connection holding version ").concat(e.oldVersion/10))})),this._maxKey=Qt(n.IDBKeyRange),this._createTransaction=function(e,t,n,i){return new r.Transaction(e,t,n,r._options.chromeTransactionDurability,i)},this._fireOnBlocked=function(e){r.on("blocked").fire(e),tt.filter((function(e){return e.name===r.name&&e!==r&&!e._state.vcFired})).map((function(t){return t.on("versionchange").fire(e)}))},this.use(Kn),this.use(Gn),this.use(zn),this.use(Ln),this.use($n);var h=new Proxy(this,{get:function(e,t,n){if("_vip"===t)return!0;if("table"===t)return function(e){return er(r.table(e),h)};var i=Reflect.get(e,t,n);return i instanceof ft?er(i,h):"tables"===t?i.map((function(e){return er(e,h)})):"_createTransaction"===t?function(){return er(i.apply(this,arguments),h)}:i}});this.vip=h,i.forEach((function(e){return e(r)}))}L="undefined"!=typeof Symbol&&"observable"in Symbol?Symbol.observable:"@@observable";var rr,ir=(or.prototype.subscribe=function(e,t,n){return this._subscribe(e&&"function"!=typeof e?e:{next:e,error:t,complete:n})},or.prototype[L]=function(){return this},or);function or(e){this._subscribe=e}try{rr={indexedDB:i.indexedDB||i.mozIndexedDB||i.webkitIndexedDB||i.msIndexedDB,IDBKeyRange:i.IDBKeyRange||i.webkitIDBKeyRange}}catch(C){rr={indexedDB:null,IDBKeyRange:null}}function ar(e){var t,n=!1,r=new ir((function(r){var i,o=B(e),a=!1,s={},u={},c={get closed(){return a},unsubscribe:function(){a||(a=!0,i&&i.abort(),h&&$t.storagemutated.unsubscribe(d))}};r.start&&r.start(c);var h=!1,f=function(){return Ye(p)},d=function(e){On(s,e),Rn(u,s)&&f()},p=function(){var c,p,m;!a&&rr.indexedDB&&(s={},c={},i&&i.abort(),i=new AbortController,m=function(t){var n=Pe();try{o&&Ue();var r=$e(e,t);return r=o?r.finally(Ke):r}finally{n&&De()}}(p={subscr:c,signal:i.signal,requery:f,querier:e,trans:null}),Promise.resolve(m).then((function(e){n=!0,t=e,a||p.signal.aborted||(s={},function(e){for(var t in e)if(l(e,t))return;return 1}(u=c)||h||($t(Ft,d),h=!0),Ye((function(){return!a&&r.next&&r.next(e)})))}),(function(e){n=!1,["DatabaseClosedError","AbortError"].includes(null==e?void 0:e.name)||a||Ye((function(){a||r.error&&r.error(e)}))})))};return setTimeout(f,0),c}));return r.hasValue=function(){return n},r.getValue=function(){return t},r}var sr=tr;function ur(e){var t=lr;try{lr=!0,$t.storagemutated.fire(e),An(e,!0)}finally{lr=t}}h(sr,t(t({},V),{delete:function(e){return new sr(e,{addons:[]}).delete()},exists:function(e){return new sr(e,{addons:[]}).open().then((function(e){return e.close(),!0})).catch("NoSuchDatabaseError",(function(){return!1}))},getDatabaseNames:function(e){try{return n=(t=sr.dependencies).indexedDB,t=t.IDBKeyRange,(vn(n)?Promise.resolve(n.databases()).then((function(e){return e.map((function(e){return e.name})).filter((function(e){return e!==nt}))})):yn(n,t).toCollection().primaryKeys()).then(e)}catch(e){return Ze(new z.MissingAPI)}var t,n},defineClass:function(){return function(e){s(this,e)}},ignoreTransaction:function(e){return ge.trans?Ve(ge.transless,e):e()},vip:gn,async:function(e){return function(){try{var t=Mn(e.apply(this,arguments));return t&&"function"==typeof t.then?t:Ee.resolve(t)}catch(t){return Ze(t)}}},spawn:function(e,t,n){try{var r=Mn(e.apply(n,t||[]));return r&&"function"==typeof r.then?r:Ee.resolve(r)}catch(e){return Ze(e)}},currentTransaction:{get:function(){return ge.trans||null}},waitFor:function(e,t){return t=Ee.resolve("function"==typeof e?sr.ignoreTransaction(e):e).timeout(t||6e4),ge.trans?ge.trans.waitFor(t):t},Promise:Ee,debug:{get:function(){return ie},set:function(e){oe(e)}},derive:p,extend:s,props:h,override:g,Events:pt,on:$t,liveQuery:ar,extendObservabilitySet:On,getByKeyPath:_,setByKeyPath:E,delByKeyPath:function(e,t){"string"==typeof t?E(e,t,void 0):"length"in t&&[].map.call(t,(function(t){E(e,t,void 0)}))},shallowClone:k,deepClone:I,getObjectDiff:Fn,cmp:ct,asap:w,minKey:-1/0,addons:[],connections:tt,errnames:W,dependencies:rr,cache:In,semVer:ue,version:ue.split(".").map((function(e){return parseInt(e)})).reduce((function(e,t,n){return e+t/Math.pow(10,2*n)}))})),sr.maxKey=Qt(sr.dependencies.IDBKeyRange),"undefined"!=typeof dispatchEvent&&"undefined"!=typeof addEventListener&&($t(Ft,(function(e){lr||(e=new CustomEvent(qt,{detail:e}),lr=!0,dispatchEvent(e),lr=!1)})),addEventListener(qt,(function(e){e=e.detail,lr||ur(e)})));var cr,lr=!1,hr=function(){};return"undefined"!=typeof BroadcastChannel&&((hr=function(){(cr=new BroadcastChannel(qt)).onmessage=function(e){return e.data&&ur(e.data)}})(),"function"==typeof cr.unref&&cr.unref(),$t(Ft,(function(e){lr||cr.postMessage(e)}))),"undefined"!=typeof addEventListener&&(addEventListener("pagehide",(function(e){if(!tr.disableBfCache&&e.persisted){ie&&console.debug("Dexie: handling persisted pagehide"),null!=cr&&cr.close();for(var t=0,n=tt;t<n.length;t++)n[t].close({disableAutoOpen:!1})}})),addEventListener("pageshow",(function(e){!tr.disableBfCache&&e.persisted&&(ie&&console.debug("Dexie: handling persisted pageshow"),hr(),ur({all:new wn(-1/0,[[]])}))}))),Ee.rejectionMapper=function(e,t){return!e||e instanceof q||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Q[e.name]?e:(t=new Q[e.name](t||e.message,e),"stack"in e&&d(t,"stack",{get:function(){return this.inner.stack}}),t)},oe(ie),t(tr,Object.freeze({__proto__:null,Dexie:tr,liveQuery:ar,Entity:ut,cmp:ct,PropModSymbol:C,PropModification:kt,replacePrefix:function(e,t){return new kt({replacePrefix:[e,t]})},default:tr,RangeSet:wn,mergeRanges:En,rangesOverlap:kn}),{default:tr}),tr}()},6310:e=>{"use strict";function t(e,t){for(const n in t)Object.defineProperty(e,n,{value:t[n],enumerable:!0,configurable:!0});return e}e.exports=function(e,n,r){if(!e||"string"==typeof e)throw new TypeError("Please pass an Error to err-code");r||(r={}),"object"==typeof n&&(r=n,n=""),n&&(r.code=n);try{return t(e,r)}catch(n){r.message=e.message,r.stack=e.stack;const i=function(){};i.prototype=Object.create(Object.getPrototypeOf(e));return t(new i,r)}}},7007:e=>{"use strict";var t,n="object"==typeof Reflect?Reflect:null,r=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(n,r){function i(n){e.removeListener(t,o),r(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}m(e,t,o,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&m(e,"error",t,n)}(e,i,{once:!0})}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var a=10;function s(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function u(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function c(e,t,n,r){var i,o,a,c;if(s(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),a=o[t]),void 0===a)a=o[t]=n,++e._eventsCount;else if("function"==typeof a?a=o[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(i=u(e))>0&&a.length>i&&!a.warned){a.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=a.length,c=l,console&&console.warn&&console.warn(c)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=l.bind(r);return i.listener=n,r.wrapFn=i,i}function f(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):p(i,i.length)}function d(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function p(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function m(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){r.once&&e.removeEventListener(t,i),n(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");a=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return u(this)},o.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var u=o[e];if(void 0===u)return!1;if("function"==typeof u)r(u,this,t);else{var c=u.length,l=p(u,c);for(n=0;n<c;++n)r(l[n],this,t)}return!0},o.prototype.addListener=function(e,t){return c(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return c(this,e,t,!0)},o.prototype.once=function(e,t){return s(t),this.on(e,h(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return s(t),this.prependListener(e,h(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,r,i,o,a;if(s(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},o.prototype.listeners=function(e){return f(this,e,!0)},o.prototype.rawListeners=function(e){return f(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):d.call(e,t)},o.prototype.listenerCount=d,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},5064:e=>{e.exports=function(){if("undefined"==typeof globalThis)return null;var e={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return e.RTCPeerConnection?e:null}},251:(e,t)=>{t.read=function(e,t,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,h=n?i-1:0,f=n?-1:1,d=e[t+h];for(h+=f,o=d&(1<<-l)-1,d>>=-l,l+=s;l>0;o=256*o+e[t+h],h+=f,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+e[t+h],h+=f,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,r),o-=c}return(d?-1:1)*a*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,h=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,p=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+h>=1?f/u:f*Math.pow(2,1-h))*u>=2&&(a++,u/=2),a+h>=l?(s=0,a=l):a+h>=1?(s=(t*u-1)*Math.pow(2,i),a+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;e[n+d]=255&s,d+=p,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[n+d]=255&a,d+=p,a/=256,c-=8);e[n+d-p]|=128*m}},6698:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},6585:e=>{var t=1e3,n=60*t,r=60*n,i=24*r,o=7*i,a=365.25*i;function s(e,t,n,r){var i=t>=1.5*n;return Math.round(e/n)+" "+r+(i?"s":"")}e.exports=function(e,u){u=u||{};var c=typeof e;if("string"===c&&e.length>0)return function(e){if((e=String(e)).length>100)return;var s=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!s)return;var u=parseFloat(s[1]);switch((s[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return u*a;case"weeks":case"week":case"w":return u*o;case"days":case"day":case"d":return u*i;case"hours":case"hour":case"hrs":case"hr":case"h":return u*r;case"minutes":case"minute":case"mins":case"min":case"m":return u*n;case"seconds":case"second":case"secs":case"sec":case"s":return u*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return u;default:return}}(e);if("number"===c&&isFinite(e))return u.long?function(e){var o=Math.abs(e);if(o>=i)return s(e,o,i,"day");if(o>=r)return s(e,o,r,"hour");if(o>=n)return s(e,o,n,"minute");if(o>=t)return s(e,o,t,"second");return e+" ms"}(e):function(e){var o=Math.abs(e);if(o>=i)return Math.round(e/i)+"d";if(o>=r)return Math.round(e/r)+"h";if(o>=n)return Math.round(e/n)+"m";if(o>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},5606:e=>{var t,n,r=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var s,u=[],c=!1,l=-1;function h(){c&&s&&(c=!1,s.length?u=s.concat(u):l=-1,u.length&&f())}function f(){if(!c){var e=a(h);c=!0;for(var t=u.length;t;){for(s=u,u=[];++l<t;)s&&s[l].run();l=-1,t=u.length}s=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{return n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function p(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new d(e,t)),1!==u.length||c||a(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},9596:(e,t,n)=>{let r;e.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:n.g):e=>(r||(r=Promise.resolve())).then(e).catch((e=>setTimeout((()=>{throw e}),0)))},3209:(e,t,n)=>{"use strict";var r=n(5606),i=65536,o=4294967295;var a=n(2861).Buffer,s=n.g.crypto||n.g.msCrypto;s&&s.getRandomValues?e.exports=function(e,t){if(e>o)throw new RangeError("requested too many random bytes");var n=a.allocUnsafe(e);if(e>0)if(e>i)for(var u=0;u<e;u+=i)s.getRandomValues(n.slice(u,u+i));else s.getRandomValues(n);if("function"==typeof t)return r.nextTick((function(){t(null,n)}));return n}:e.exports=function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}},6048:e=>{"use strict";var t={};function n(e,n,r){r||(r=Error);var i=function(e){var t,r;function i(t,r,i){return e.call(this,function(e,t,r){return"string"==typeof n?n:n(e,t,r)}(t,r,i))||this}return r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,i}(r);i.prototype.name=r.name,i.prototype.code=e,t[e]=i}function r(e,t){if(Array.isArray(e)){var n=e.length;return e=e.map((function(e){return String(e)})),n>2?"one of ".concat(t," ").concat(e.slice(0,n-1).join(", "),", or ")+e[n-1]:2===n?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}n("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),n("ERR_INVALID_ARG_TYPE",(function(e,t,n){var i,o,a,s;if("string"==typeof t&&(o="not ",t.substr(!a||a<0?0:+a,o.length)===o)?(i="must not be",t=t.replace(/^not /,"")):i="must be",function(e,t,n){return(void 0===n||n>e.length)&&(n=e.length),e.substring(n-t.length,n)===t}(e," argument"))s="The ".concat(e," ").concat(i," ").concat(r(t,"type"));else{var u=function(e,t,n){return"number"!=typeof n&&(n=0),!(n+t.length>e.length)&&-1!==e.indexOf(t,n)}(e,".")?"property":"argument";s='The "'.concat(e,'" ').concat(u," ").concat(i," ").concat(r(t,"type"))}return s+=". Received type ".concat(typeof n)}),TypeError),n("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),n("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),n("ERR_STREAM_PREMATURE_CLOSE","Premature close"),n("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),n("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),n("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),n("ERR_STREAM_WRITE_AFTER_END","write after end"),n("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),n("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),n("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.F=t},5382:(e,t,n)=>{"use strict";var r=n(5606),i=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};e.exports=l;var o=n(5412),a=n(6708);n(6698)(l,o);for(var s=i(a.prototype),u=0;u<s.length;u++){var c=s[u];l.prototype[c]||(l.prototype[c]=a.prototype[c])}function l(e){if(!(this instanceof l))return new l(e);o.call(this,e),a.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",h)))}function h(){this._writableState.ended||r.nextTick(f,this)}function f(e){e.end()}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(l.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})},3600:(e,t,n)=>{"use strict";e.exports=i;var r=n(4610);function i(e){if(!(this instanceof i))return new i(e);r.call(this,e)}n(6698)(i,r),i.prototype._transform=function(e,t,n){n(null,e)}},5412:(e,t,n)=>{"use strict";var r,i=n(5606);e.exports=x,x.ReadableState=S;n(7007).EventEmitter;var o=function(e,t){return e.listeners(t).length},a=n(345),s=n(8287).Buffer,u=(void 0!==n.g?n.g:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){};var c,l=n(9838);c=l&&l.debuglog?l.debuglog("stream"):function(){};var h,f,d,p=n(2726),m=n(5896),y=n(5291).getHighWaterMark,v=n(6048).F,g=v.ERR_INVALID_ARG_TYPE,b=v.ERR_STREAM_PUSH_AFTER_EOF,w=v.ERR_METHOD_NOT_IMPLEMENTED,_=v.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;n(6698)(x,a);var E=m.errorOrDestroy,k=["error","close","destroy","pause","resume"];function S(e,t,i){r=r||n(5382),e=e||{},"boolean"!=typeof i&&(i=t instanceof r),this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=y(this,e,"readableHighWaterMark",i),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(h||(h=n(3141).I),this.decoder=new h(e.encoding),this.encoding=e.encoding)}function x(e){if(r=r||n(5382),!(this instanceof x))return new x(e);var t=this instanceof r;this._readableState=new S(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),a.call(this)}function C(e,t,n,r,i){c("readableAddChunk",t);var o,a=e._readableState;if(null===t)a.reading=!1,function(e,t){if(c("onEofChunk"),t.ended)return;if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,t.sync?P(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,D(e)))}(e,a);else if(i||(o=function(e,t){var n;r=t,s.isBuffer(r)||r instanceof u||"string"==typeof t||void 0===t||e.objectMode||(n=new g("chunk",["string","Buffer","Uint8Array"],t));var r;return n}(a,t)),o)E(e,o);else if(a.objectMode||t&&t.length>0)if("string"==typeof t||a.objectMode||Object.getPrototypeOf(t)===s.prototype||(t=function(e){return s.from(e)}(t)),r)a.endEmitted?E(e,new _):O(e,a,t,!0);else if(a.ended)E(e,new b);else{if(a.destroyed)return!1;a.reading=!1,a.decoder&&!n?(t=a.decoder.write(t),a.objectMode||0!==t.length?O(e,a,t,!1):T(e,a)):O(e,a,t,!1)}else r||(a.reading=!1,T(e,a));return!a.ended&&(a.length<a.highWaterMark||0===a.length)}function O(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",n)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&P(e)),T(e,t)}Object.defineProperty(x.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),x.prototype.destroy=m.destroy,x.prototype._undestroy=m.undestroy,x.prototype._destroy=function(e,t){t(e)},x.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=s.from(e,t),t=""),n=!0),C(this,e,t,!1,n)},x.prototype.unshift=function(e){return C(this,e,null,!0,!1)},x.prototype.isPaused=function(){return!1===this._readableState.flowing},x.prototype.setEncoding=function(e){h||(h=n(3141).I);var t=new h(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,i="";null!==r;)i+=t.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var R=1073741824;function I(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=R?e=R:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function P(e){var t=e._readableState;c("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(c("emitReadable",t.flowing),t.emittedReadable=!0,i.nextTick(D,e))}function D(e){var t=e._readableState;c("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,B(e)}function T(e,t){t.readingMore||(t.readingMore=!0,i.nextTick(A,e,t))}function A(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var n=t.length;if(c("maybeReadMore read 0"),e.read(0),n===t.length)break}t.readingMore=!1}function j(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function N(e){c("readable nexttick read 0"),e.read(0)}function M(e,t){c("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),B(e),t.flowing&&!t.reading&&e.read(0)}function B(e){var t=e._readableState;for(c("flow",t.flowing);t.flowing&&null!==e.read(););}function L(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):n=t.buffer.consume(e,t.decoder),n);var n}function F(e){var t=e._readableState;c("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,i.nextTick(q,t,e))}function q(e,t){if(c("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var n=t._writableState;(!n||n.autoDestroy&&n.finished)&&t.destroy()}}function $(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}x.prototype.read=function(e){c("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return c("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?F(this):P(this),null;if(0===(e=I(e,t))&&t.ended)return 0===t.length&&F(this),null;var r,i=t.needReadable;return c("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&c("length less than watermark",i=!0),t.ended||t.reading?c("reading or ended",i=!1):i&&(c("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=I(n,t))),null===(r=e>0?L(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&F(this)),null!==r&&this.emit("data",r),r},x.prototype._read=function(e){E(this,new w("_read()"))},x.prototype.pipe=function(e,t){var n=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=e;break;case 1:r.pipes=[r.pipes,e];break;default:r.pipes.push(e)}r.pipesCount+=1,c("pipe count=%d opts=%j",r.pipesCount,t);var a=(!t||!1!==t.end)&&e!==i.stdout&&e!==i.stderr?u:y;function s(t,i){c("onunpipe"),t===n&&i&&!1===i.hasUnpiped&&(i.hasUnpiped=!0,c("cleanup"),e.removeListener("close",p),e.removeListener("finish",m),e.removeListener("drain",l),e.removeListener("error",d),e.removeListener("unpipe",s),n.removeListener("end",u),n.removeListener("end",y),n.removeListener("data",f),h=!0,!r.awaitDrain||e._writableState&&!e._writableState.needDrain||l())}function u(){c("onend"),e.end()}r.endEmitted?i.nextTick(a):n.once("end",a),e.on("unpipe",s);var l=function(e){return function(){var t=e._readableState;c("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&o(e,"data")&&(t.flowing=!0,B(e))}}(n);e.on("drain",l);var h=!1;function f(t){c("ondata");var i=e.write(t);c("dest.write",i),!1===i&&((1===r.pipesCount&&r.pipes===e||r.pipesCount>1&&-1!==$(r.pipes,e))&&!h&&(c("false write response, pause",r.awaitDrain),r.awaitDrain++),n.pause())}function d(t){c("onerror",t),y(),e.removeListener("error",d),0===o(e,"error")&&E(e,t)}function p(){e.removeListener("finish",m),y()}function m(){c("onfinish"),e.removeListener("close",p),y()}function y(){c("unpipe"),n.unpipe(e)}return n.on("data",f),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",d),e.once("close",p),e.once("finish",m),e.emit("pipe",n),r.flowing||(c("pipe resume"),n.resume()),e},x.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,{hasUnpiped:!1});return this}var a=$(t.pipes,e);return-1===a||(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},x.prototype.on=function(e,t){var n=a.prototype.on.call(this,e,t),r=this._readableState;return"data"===e?(r.readableListening=this.listenerCount("readable")>0,!1!==r.flowing&&this.resume()):"readable"===e&&(r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.flowing=!1,r.emittedReadable=!1,c("on readable",r.length,r.reading),r.length?P(this):r.reading||i.nextTick(N,this))),n},x.prototype.addListener=x.prototype.on,x.prototype.removeListener=function(e,t){var n=a.prototype.removeListener.call(this,e,t);return"readable"===e&&i.nextTick(j,this),n},x.prototype.removeAllListeners=function(e){var t=a.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||i.nextTick(j,this),t},x.prototype.resume=function(){var e=this._readableState;return e.flowing||(c("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i.nextTick(M,e,t))}(this,e)),e.paused=!1,this},x.prototype.pause=function(){return c("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(c("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},x.prototype.wrap=function(e){var t=this,n=this._readableState,r=!1;for(var i in e.on("end",(function(){if(c("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(c("wrapped data"),n.decoder&&(i=n.decoder.write(i)),n.objectMode&&null==i)||(n.objectMode||i&&i.length)&&(t.push(i)||(r=!0,e.pause()))})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var o=0;o<k.length;o++)e.on(k[o],this.emit.bind(this,k[o]));return this._read=function(t){c("wrapped _read",t),r&&(r=!1,e.resume())},this},"function"==typeof Symbol&&(x.prototype[Symbol.asyncIterator]=function(){return void 0===f&&(f=n(2955)),f(this)}),Object.defineProperty(x.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(x.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(x.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),x._fromList=L,Object.defineProperty(x.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(x.from=function(e,t){return void 0===d&&(d=n(5157)),d(x,e,t)})},4610:(e,t,n)=>{"use strict";e.exports=l;var r=n(6048).F,i=r.ERR_METHOD_NOT_IMPLEMENTED,o=r.ERR_MULTIPLE_CALLBACK,a=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,s=r.ERR_TRANSFORM_WITH_LENGTH_0,u=n(5382);function c(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(null===r)return this.emit("error",new o);n.writechunk=null,n.writecb=null,null!=t&&this.push(t),r(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function l(e){if(!(this instanceof l))return new l(e);u.call(this,e),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",h)}function h(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?f(this,null,null):this._flush((function(t,n){f(e,t,n)}))}function f(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new s;if(e._transformState.transforming)throw new a;return e.push(null)}n(6698)(l,u),l.prototype.push=function(e,t){return this._transformState.needTransform=!1,u.prototype.push.call(this,e,t)},l.prototype._transform=function(e,t,n){n(new i("_transform()"))},l.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},l.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},l.prototype._destroy=function(e,t){u.prototype._destroy.call(this,e,(function(e){t(e)}))}},6708:(e,t,n)=>{"use strict";var r,i=n(5606);function o(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var r=e.entry;e.entry=null;for(;r;){var i=r.callback;t.pendingcb--,i(n),r=r.next}t.corkedRequestsFree.next=e}(t,e)}}e.exports=x,x.WritableState=S;var a={deprecate:n(4643)},s=n(345),u=n(8287).Buffer,c=(void 0!==n.g?n.g:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){};var l,h=n(5896),f=n(5291).getHighWaterMark,d=n(6048).F,p=d.ERR_INVALID_ARG_TYPE,m=d.ERR_METHOD_NOT_IMPLEMENTED,y=d.ERR_MULTIPLE_CALLBACK,v=d.ERR_STREAM_CANNOT_PIPE,g=d.ERR_STREAM_DESTROYED,b=d.ERR_STREAM_NULL_VALUES,w=d.ERR_STREAM_WRITE_AFTER_END,_=d.ERR_UNKNOWN_ENCODING,E=h.errorOrDestroy;function k(){}function S(e,t,a){r=r||n(5382),e=e||{},"boolean"!=typeof a&&(a=t instanceof r),this.objectMode=!!e.objectMode,a&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=f(this,e,"writableHighWaterMark",a),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var s=!1===e.decodeStrings;this.decodeStrings=!s,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,r=n.sync,o=n.writecb;if("function"!=typeof o)throw new y;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,r,o){--t.pendingcb,n?(i.nextTick(o,r),i.nextTick(D,e,t),e._writableState.errorEmitted=!0,E(e,r)):(o(r),e._writableState.errorEmitted=!0,E(e,r),D(e,t))}(e,n,r,t,o);else{var a=I(n)||e.destroyed;a||n.corked||n.bufferProcessing||!n.bufferedRequest||R(e,n),r?i.nextTick(O,e,n,a,o):O(e,n,a,o)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new o(this)}function x(e){var t=this instanceof(r=r||n(5382));if(!t&&!l.call(x,this))return new x(e);this._writableState=new S(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),s.call(this)}function C(e,t,n,r,i,o,a){t.writelen=r,t.writecb=a,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new g("write")):n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function O(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),D(e,t)}function R(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,i=new Array(r),a=t.corkedRequestsFree;a.entry=n;for(var s=0,u=!0;n;)i[s]=n,n.isBuf||(u=!1),n=n.next,s+=1;i.allBuffers=u,C(e,t,!0,t.length,i,"",a.finish),t.pendingcb++,t.lastBufferedRequest=null,a.next?(t.corkedRequestsFree=a.next,a.next=null):t.corkedRequestsFree=new o(t),t.bufferedRequestCount=0}else{for(;n;){var c=n.chunk,l=n.encoding,h=n.callback;if(C(e,t,!1,t.objectMode?1:c.length,c,l,h),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function I(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function P(e,t){e._final((function(n){t.pendingcb--,n&&E(e,n),t.prefinished=!0,e.emit("prefinish"),D(e,t)}))}function D(e,t){var n=I(t);if(n&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,i.nextTick(P,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var r=e._readableState;(!r||r.autoDestroy&&r.endEmitted)&&e.destroy()}return n}n(6698)(x,s),S.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(S.prototype,"buffer",{get:a.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(l=Function.prototype[Symbol.hasInstance],Object.defineProperty(x,Symbol.hasInstance,{value:function(e){return!!l.call(this,e)||this===x&&(e&&e._writableState instanceof S)}})):l=function(e){return e instanceof this},x.prototype.pipe=function(){E(this,new v)},x.prototype.write=function(e,t,n){var r,o=this._writableState,a=!1,s=!o.objectMode&&(r=e,u.isBuffer(r)||r instanceof c);return s&&!u.isBuffer(e)&&(e=function(e){return u.from(e)}(e)),"function"==typeof t&&(n=t,t=null),s?t="buffer":t||(t=o.defaultEncoding),"function"!=typeof n&&(n=k),o.ending?function(e,t){var n=new w;E(e,n),i.nextTick(t,n)}(this,n):(s||function(e,t,n,r){var o;return null===n?o=new b:"string"==typeof n||t.objectMode||(o=new p("chunk",["string","Buffer"],n)),!o||(E(e,o),i.nextTick(r,o),!1)}(this,o,e,n))&&(o.pendingcb++,a=function(e,t,n,r,i,o){if(!n){var a=function(e,t,n){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=u.from(t,n));return t}(t,r,i);r!==a&&(n=!0,i="buffer",r=a)}var s=t.objectMode?1:r.length;t.length+=s;var c=t.length<t.highWaterMark;c||(t.needDrain=!0);if(t.writing||t.corked){var l=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},l?l.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else C(e,t,!1,s,r,i,o);return c}(this,o,s,e,t,n)),a},x.prototype.cork=function(){this._writableState.corked++},x.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||R(this,e))},x.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new _(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(x.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(x.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),x.prototype._write=function(e,t,n){n(new m("_write()"))},x.prototype._writev=null,x.prototype.end=function(e,t,n){var r=this._writableState;return"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||function(e,t,n){t.ending=!0,D(e,t),n&&(t.finished?i.nextTick(n):e.once("finish",n));t.ended=!0,e.writable=!1}(this,r,n),this},Object.defineProperty(x.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(x.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),x.prototype.destroy=h.destroy,x.prototype._undestroy=h.undestroy,x.prototype._destroy=function(e,t){t(e)}},2955:(e,t,n)=>{"use strict";var r,i=n(5606);function o(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=n(6238),s=Symbol("lastResolve"),u=Symbol("lastReject"),c=Symbol("error"),l=Symbol("ended"),h=Symbol("lastPromise"),f=Symbol("handlePromise"),d=Symbol("stream");function p(e,t){return{value:e,done:t}}function m(e){var t=e[s];if(null!==t){var n=e[d].read();null!==n&&(e[h]=null,e[s]=null,e[u]=null,t(p(n,!1)))}}function y(e){i.nextTick(m,e)}var v=Object.getPrototypeOf((function(){})),g=Object.setPrototypeOf((o(r={get stream(){return this[d]},next:function(){var e=this,t=this[c];if(null!==t)return Promise.reject(t);if(this[l])return Promise.resolve(p(void 0,!0));if(this[d].destroyed)return new Promise((function(t,n){i.nextTick((function(){e[c]?n(e[c]):t(p(void 0,!0))}))}));var n,r=this[h];if(r)n=new Promise(function(e,t){return function(n,r){e.then((function(){t[l]?n(p(void 0,!0)):t[f](n,r)}),r)}}(r,this));else{var o=this[d].read();if(null!==o)return Promise.resolve(p(o,!1));n=new Promise(this[f])}return this[h]=n,n}},Symbol.asyncIterator,(function(){return this})),o(r,"return",(function(){var e=this;return new Promise((function(t,n){e[d].destroy(null,(function(e){e?n(e):t(p(void 0,!0))}))}))})),r),v);e.exports=function(e){var t,n=Object.create(g,(o(t={},d,{value:e,writable:!0}),o(t,s,{value:null,writable:!0}),o(t,u,{value:null,writable:!0}),o(t,c,{value:null,writable:!0}),o(t,l,{value:e._readableState.endEmitted,writable:!0}),o(t,f,{value:function(e,t){var r=n[d].read();r?(n[h]=null,n[s]=null,n[u]=null,e(p(r,!1))):(n[s]=e,n[u]=t)},writable:!0}),t));return n[h]=null,a(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=n[u];return null!==t&&(n[h]=null,n[s]=null,n[u]=null,t(e)),void(n[c]=e)}var r=n[s];null!==r&&(n[h]=null,n[s]=null,n[u]=null,r(p(void 0,!0))),n[l]=!0})),e.on("readable",y.bind(null,n)),n}},2726:(e,t,n)=>{"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t,n){return(t=s(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var u=n(8287).Buffer,c=n(5340).inspect,l=c&&c.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,n,r;return t=e,(n=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n}},{key:"concat",value:function(e){if(0===this.length)return u.alloc(0);for(var t,n,r,i=u.allocUnsafe(e>>>0),o=this.head,a=0;o;)t=o.data,n=i,r=a,u.prototype.copy.call(t,n,r),a+=o.data.length,o=o.next;return i}},{key:"consume",value:function(e,t){var n;return e<this.head.data.length?(n=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):n=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,n=1,r=t.data;for(e-=r.length;t=t.next;){var i=t.data,o=e>i.length?i.length:e;if(o===i.length?r+=i:r+=i.slice(0,e),0==(e-=o)){o===i.length?(++n,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(o));break}++n}return this.length-=n,r}},{key:"_getBuffer",value:function(e){var t=u.allocUnsafe(e),n=this.head,r=1;for(n.data.copy(t),e-=n.data.length;n=n.next;){var i=n.data,o=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,o),0==(e-=o)){o===i.length?(++r,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=i.slice(o));break}++r}return this.length-=r,t}},{key:l,value:function(e,t){return c(this,i(i({},t),{},{depth:0,customInspect:!1}))}}])&&a(t.prototype,n),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()},5896:(e,t,n)=>{"use strict";var r=n(5606);function i(e,t){a(e,t),o(e)}function o(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function a(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var n=this,s=this._readableState&&this._readableState.destroyed,u=this._writableState&&this._writableState.destroyed;return s||u?(t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,r.nextTick(a,this,e)):r.nextTick(a,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?n._writableState?n._writableState.errorEmitted?r.nextTick(o,n):(n._writableState.errorEmitted=!0,r.nextTick(i,n,e)):r.nextTick(i,n,e):t?(r.nextTick(o,n),t(e)):r.nextTick(o,n)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var n=e._readableState,r=e._writableState;n&&n.autoDestroy||r&&r.autoDestroy?e.destroy(t):e.emit("error",t)}}},6238:(e,t,n)=>{"use strict";var r=n(6048).F.ERR_STREAM_PREMATURE_CLOSE;function i(){}e.exports=function e(t,n,o){if("function"==typeof n)return e(t,null,n);n||(n={}),o=function(e){var t=!1;return function(){if(!t){t=!0;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e.apply(this,r)}}}(o||i);var a=n.readable||!1!==n.readable&&t.readable,s=n.writable||!1!==n.writable&&t.writable,u=function(){t.writable||l()},c=t._writableState&&t._writableState.finished,l=function(){s=!1,c=!0,a||o.call(t)},h=t._readableState&&t._readableState.endEmitted,f=function(){a=!1,h=!0,s||o.call(t)},d=function(e){o.call(t,e)},p=function(){var e;return a&&!h?(t._readableState&&t._readableState.ended||(e=new r),o.call(t,e)):s&&!c?(t._writableState&&t._writableState.ended||(e=new r),o.call(t,e)):void 0},m=function(){t.req.on("finish",l)};return!function(e){return e.setHeader&&"function"==typeof e.abort}(t)?s&&!t._writableState&&(t.on("end",u),t.on("close",u)):(t.on("complete",l),t.on("abort",p),t.req?m():t.on("request",m)),t.on("end",f),t.on("finish",l),!1!==n.error&&t.on("error",d),t.on("close",p),function(){t.removeListener("complete",l),t.removeListener("abort",p),t.removeListener("request",m),t.req&&t.req.removeListener("finish",l),t.removeListener("end",u),t.removeListener("close",u),t.removeListener("finish",l),t.removeListener("end",f),t.removeListener("error",d),t.removeListener("close",p)}}},5157:e=>{e.exports=function(){throw new Error("Readable.from is not available in the browser")}},7758:(e,t,n)=>{"use strict";var r;var i=n(6048).F,o=i.ERR_MISSING_ARGS,a=i.ERR_STREAM_DESTROYED;function s(e){if(e)throw e}function u(e){e()}function c(e,t){return e.pipe(t)}e.exports=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var l,h=function(e){return e.length?"function"!=typeof e[e.length-1]?s:e.pop():s}(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new o("streams");var f=t.map((function(e,i){var o=i<t.length-1;return function(e,t,i,o){o=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(o);var s=!1;e.on("close",(function(){s=!0})),void 0===r&&(r=n(6238)),r(e,{readable:t,writable:i},(function(e){if(e)return o(e);s=!0,o()}));var u=!1;return function(t){if(!s&&!u)return u=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(e)?e.abort():"function"==typeof e.destroy?e.destroy():void o(t||new a("pipe"))}}(e,o,i>0,(function(e){l||(l=e),e&&f.forEach(u),o||(f.forEach(u),h(l))}))}));return t.reduce(c)}},5291:(e,t,n)=>{"use strict";var r=n(6048).F.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,n,i){var o=function(e,t,n){return null!=e.highWaterMark?e.highWaterMark:t?e[n]:null}(t,i,n);if(null!=o){if(!isFinite(o)||Math.floor(o)!==o||o<0)throw new r(i?n:"highWaterMark",o);return Math.floor(o)}return e.objectMode?16:16384}}},345:(e,t,n)=>{e.exports=n(7007).EventEmitter},8399:(e,t,n)=>{(t=e.exports=n(5412)).Stream=t,t.Readable=t,t.Writable=n(6708),t.Duplex=n(5382),t.Transform=n(4610),t.PassThrough=n(3600),t.finished=n(6238),t.pipeline=n(7758)},9426:(e,t,n)=>{"use strict";n.d(t,{t:()=>i});var r=n(1635),i=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return(0,r.C6)(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){var e=this,t=e.hasError,n=e.thrownError,r=e._value;if(t)throw n;return this._throwIfClosed(),r},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(n(7291).B)},3776:(e,t,n)=>{"use strict";n.d(t,{c:()=>h});var r=n(2685),i=n(2616),o=n(5604),a=n(8307);function s(e){return 0===e.length?a.D:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var u=n(4384),c=n(1209),l=n(7008),h=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var o,a=this,s=(o=e)&&o instanceof r.vU||function(e){return e&&(0,c.T)(e.next)&&(0,c.T)(e.error)&&(0,c.T)(e.complete)}(o)&&(0,i.Uv)(o)?e:new r.Ms(e,t,n);return(0,l.Y)((function(){var e=a,t=e.operator,n=e.source;s.add(t?t.call(s,n):n?a._subscribe(s):a._trySubscribe(s))})),s},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=f(t))((function(t,i){var o=new r.Ms({next:function(t){try{e(t)}catch(e){i(e),o.unsubscribe()}},error:i,complete:t});n.subscribe(o)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[o.s]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=f(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function f(e){var t;return null!==(t=null!=e?e:u.$.Promise)&&void 0!==t?t:Promise}},7291:(e,t,n)=>{"use strict";n.d(t,{B:()=>c});var r=n(1635),i=n(3776),o=n(2616),a=(0,n(2947).L)((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),s=n(6174),u=n(7008),c=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return(0,r.C6)(t,e),t.prototype.lift=function(e){var t=new l(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new a},t.prototype.next=function(e){var t=this;(0,u.Y)((function(){var n,i;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var o=(0,r.Ju)(t.currentObservers),a=o.next();!a.done;a=o.next()){a.value.next(e)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}}}))},t.prototype.error=function(e){var t=this;(0,u.Y)((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}}))},t.prototype.complete=function(){var e=this;(0,u.Y)((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=this,r=n.hasError,i=n.isStopped,a=n.observers;return r||i?o.Kn:(this.currentObservers=null,a.push(e),new o.yU((function(){t.currentObservers=null,(0,s.o)(a,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,r=t.thrownError,i=t.isStopped;n?e.error(r):i&&e.complete()},t.prototype.asObservable=function(){var e=new i.c;return e.source=this,e},t.create=function(e,t){return new l(e,t)},t}(i.c),l=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return(0,r.C6)(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:o.Kn},t}(c)},2685:(e,t,n)=>{"use strict";n.d(t,{Ms:()=>v,vU:()=>d});var r=n(1635),i=n(1209),o=n(2616),a=n(4384),s=n(2564);function u(){}var c=l("C",void 0,void 0);function l(e,t,n){return{kind:e,value:t,error:n}}var h=n(6744),f=n(7008),d=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,(0,o.Uv)(t)&&t.add(n)):n.destination=w,n}return(0,r.C6)(t,e),t.create=function(e,t,n){return new v(e,t,n)},t.prototype.next=function(e){this.isStopped?b(function(e){return l("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?b(l("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?b(c,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(o.yU),p=Function.prototype.bind;function m(e,t){return p.call(e,t)}var y=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){g(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){g(e)}else g(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){g(e)}},e}(),v=function(e){function t(t,n,r){var o,s,u=e.call(this)||this;(0,i.T)(t)||!t?o={next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=r?r:void 0}:u&&a.$.useDeprecatedNextContext?((s=Object.create(t)).unsubscribe=function(){return u.unsubscribe()},o={next:t.next&&m(t.next,s),error:t.error&&m(t.error,s),complete:t.complete&&m(t.complete,s)}):o=t;return u.destination=new y(o),u}return(0,r.C6)(t,e),t}(d);function g(e){a.$.useDeprecatedSynchronousErrorHandling?(0,f.l)(e):(0,s.m)(e)}function b(e,t){var n=a.$.onStoppedNotification;n&&h.f.setTimeout((function(){return n(e,t)}))}var w={closed:!0,next:u,error:function(e){throw e},complete:u}},2616:(e,t,n)=>{"use strict";n.d(t,{Kn:()=>u,yU:()=>s,Uv:()=>c});var r=n(1635),i=n(1209),o=(0,n(2947).L)((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}})),a=n(6174),s=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var e,t,n,a,s;if(!this.closed){this.closed=!0;var u=this._parentage;if(u)if(this._parentage=null,Array.isArray(u))try{for(var c=(0,r.Ju)(u),h=c.next();!h.done;h=c.next()){h.value.remove(this)}}catch(t){e={error:t}}finally{try{h&&!h.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}else u.remove(this);var f=this.initialTeardown;if((0,i.T)(f))try{f()}catch(e){s=e instanceof o?e.errors:[e]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var p=(0,r.Ju)(d),m=p.next();!m.done;m=p.next()){var y=m.value;try{l(y)}catch(e){s=null!=s?s:[],e instanceof o?s=(0,r.fX)((0,r.fX)([],(0,r.zs)(s)),(0,r.zs)(e.errors)):s.push(e)}}}catch(e){n={error:e}}finally{try{m&&!m.done&&(a=p.return)&&a.call(p)}finally{if(n)throw n.error}}}if(s)throw new o(s)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)l(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&(0,a.o)(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&(0,a.o)(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}(),u=s.EMPTY;function c(e){return e instanceof s||e&&"closed"in e&&(0,i.T)(e.remove)&&(0,i.T)(e.add)&&(0,i.T)(e.unsubscribe)}function l(e){(0,i.T)(e)?e():e.unsubscribe()}},4384:(e,t,n)=>{"use strict";n.d(t,{$:()=>r});var r={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},8825:(e,t,n)=>{"use strict";n.d(t,{_:()=>o});var r=(0,n(2947).L)((function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}})),i=n(2685);function o(e,t){var n="object"==typeof t;return new Promise((function(o,a){var s=new i.Ms({next:function(e){o(e),s.unsubscribe()},error:a,complete:function(){n?o(t.defaultValue):a(new r)}});e.subscribe(s)}))}},7968:(e,t,n)=>{"use strict";n.d(t,{H:()=>_});var r=n(5964),i=n(6315),o=n(2908),a=n(4878);function s(e,t){return void 0===t&&(t=0),(0,o.N)((function(n,r){n.subscribe((0,a._)(r,(function(n){return(0,i.N)(r,e,(function(){return r.next(n)}),t)}),(function(){return(0,i.N)(r,e,(function(){return r.complete()}),t)}),(function(n){return(0,i.N)(r,e,(function(){return r.error(n)}),t)})))}))}function u(e,t){return void 0===t&&(t=0),(0,o.N)((function(n,r){r.add(e.schedule((function(){return n.subscribe(r)}),t))}))}var c=n(3776);var l=n(2059),h=n(1209);function f(e,t){if(!e)throw new Error("Iterable cannot be null");return new c.c((function(n){(0,i.N)(n,t,(function(){var r=e[Symbol.asyncIterator]();(0,i.N)(n,t,(function(){r.next().then((function(e){e.done?n.complete():n.next(e.value)}))}),0,!0)}))}))}var d=n(7541),p=n(3440),m=n(9391),y=n(8667),v=n(2471),g=n(3465),b=n(8438);function w(e,t){if(null!=e){if((0,d.l)(e))return function(e,t){return(0,r.Tg)(e).pipe(u(t),s(t))}(e,t);if((0,m.X)(e))return function(e,t){return new c.c((function(n){var r=0;return t.schedule((function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())}))}))}(e,t);if((0,p.y)(e))return function(e,t){return(0,r.Tg)(e).pipe(u(t),s(t))}(e,t);if((0,v.T)(e))return f(e,t);if((0,y.x)(e))return function(e,t){return new c.c((function(n){var r;return(0,i.N)(n,t,(function(){r=e[l.l](),(0,i.N)(n,t,(function(){var e,t,i;try{t=(e=r.next()).value,i=e.done}catch(e){return void n.error(e)}i?n.complete():n.next(t)}),0,!0)})),function(){return(0,h.T)(null==r?void 0:r.return)&&r.return()}}))}(e,t);if((0,b.U)(e))return function(e,t){return f((0,b.C)(e),t)}(e,t)}throw(0,g.L)(e)}function _(e,t){return t?w(e,t):(0,r.Tg)(e)}},5964:(e,t,n)=>{"use strict";n.d(t,{Tg:()=>m});var r=n(1635),i=n(9391),o=n(3440),a=n(3776),s=n(7541),u=n(2471),c=n(3465),l=n(8667),h=n(8438),f=n(1209),d=n(2564),p=n(5604);function m(e){if(e instanceof a.c)return e;if(null!=e){if((0,s.l)(e))return g=e,new a.c((function(e){var t=g[p.s]();if((0,f.T)(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if((0,i.X)(e))return v=e,new a.c((function(e){for(var t=0;t<v.length&&!e.closed;t++)e.next(v[t]);e.complete()}));if((0,o.y)(e))return m=e,new a.c((function(e){m.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,d.m)}));if((0,u.T)(e))return y(e);if((0,l.x)(e))return n=e,new a.c((function(e){var t,i;try{for(var o=(0,r.Ju)(n),a=o.next();!a.done;a=o.next()){var s=a.value;if(e.next(s),e.closed)return}}catch(e){t={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(t)throw t.error}}e.complete()}));if((0,h.U)(e))return t=e,y((0,h.C)(t))}var t,n,m,v,g;throw(0,c.L)(e)}function y(e){return new a.c((function(t){(function(e,t){var n,i,o,a;return(0,r.sH)(this,void 0,void 0,(function(){var s,u;return(0,r.YH)(this,(function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),n=(0,r.xN)(e),c.label=1;case 1:return[4,n.next()];case 2:if((i=c.sent()).done)return[3,4];if(s=i.value,t.next(s),t.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return u=c.sent(),o={error:u},[3,11];case 6:return c.trys.push([6,,9,10]),i&&!i.done&&(a=n.return)?[4,a.call(n)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(o)throw o.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))}))})(e,t).catch((function(e){return t.error(e)}))}))}},4878:(e,t,n)=>{"use strict";n.d(t,{_:()=>i});var r=n(1635);function i(e,t,n,r,i){return new o(e,t,n,r,i)}var o=function(e){function t(t,n,r,i,o,a){var s=e.call(this,t)||this;return s.onFinalize=o,s.shouldUnsubscribe=a,s._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,s._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,s._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,s}return(0,r.C6)(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(n(2685).vU)},1900:(e,t,n)=>{"use strict";n.d(t,{F:()=>a});var r=n(8307),i=n(2908),o=n(4878);function a(e,t){return void 0===t&&(t=r.D),e=null!=e?e:s,(0,i.N)((function(n,r){var i,a=!0;n.subscribe((0,o._)(r,(function(n){var o=t(n);!a&&e(i,o)||(a=!1,i=o,r.next(n))})))}))}function s(e,t){return e===t}},6126:(e,t,n)=>{"use strict";n.d(t,{p:()=>o});var r=n(2908),i=n(4878);function o(e,t){return(0,r.N)((function(n,r){var o=0;n.subscribe((0,i._)(r,(function(n){return e.call(t,n,o++)&&r.next(n)})))}))}},1160:(e,t,n)=>{"use strict";n.d(t,{T:()=>o});var r=n(2908),i=n(4878);function o(e,t){return(0,r.N)((function(n,r){var o=0;n.subscribe((0,i._)(r,(function(n){r.next(e.call(t,n,o++))})))}))}},3031:(e,t,n)=>{"use strict";n.d(t,{U:()=>o});var r=n(8452),i=n(8307);function o(e){return void 0===e&&(e=1/0),(0,r.Z)(i.D,e)}},8452:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r=n(1160),i=n(5964),o=n(2908),a=n(6315),s=n(4878);var u=n(1209);function c(e,t,n){return void 0===n&&(n=1/0),(0,u.T)(t)?c((function(n,o){return(0,r.T)((function(e,r){return t(n,e,o,r)}))((0,i.Tg)(e(n,o)))}),n):("number"==typeof t&&(n=t),(0,o.N)((function(t,r){return function(e,t,n,r,o,u,c,l){var h=[],f=0,d=0,p=!1,m=function(){!p||h.length||f||t.complete()},y=function(e){return f<r?v(e):h.push(e)},v=function(e){u&&t.next(e),f++;var l=!1;(0,i.Tg)(n(e,d++)).subscribe((0,s._)(t,(function(e){null==o||o(e),u?y(e):t.next(e)}),(function(){l=!0}),void 0,(function(){if(l)try{f--;for(var e=function(){var e=h.shift();c?(0,a.N)(t,c,(function(){return v(e)})):v(e)};h.length&&f<r;)e();m()}catch(e){t.error(e)}})))};return e.subscribe((0,s._)(t,y,(function(){p=!0,m()}))),function(){null==l||l()}}(t,r,e,n)})))}},1636:(e,t,n)=>{"use strict";n.d(t,{t:()=>h});var r=n(1635),i=n(7291),o={now:function(){return(o.delegate||Date).now()},delegate:void 0},a=function(e){function t(t,n,r){void 0===t&&(t=1/0),void 0===n&&(n=1/0),void 0===r&&(r=o);var i=e.call(this)||this;return i._bufferSize=t,i._windowTime=n,i._timestampProvider=r,i._buffer=[],i._infiniteTimeWindow=!0,i._infiniteTimeWindow=n===1/0,i._bufferSize=Math.max(1,t),i._windowTime=Math.max(1,n),i}return(0,r.C6)(t,e),t.prototype.next=function(t){var n=this,r=n.isStopped,i=n._buffer,o=n._infiniteTimeWindow,a=n._timestampProvider,s=n._windowTime;r||(i.push(t),!o&&i.push(a.now()+s)),this._trimBuffer(),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),n=this._infiniteTimeWindow,r=this._buffer.slice(),i=0;i<r.length&&!e.closed;i+=n?1:2)e.next(r[i]);return this._checkFinalizedStatuses(e),t},t.prototype._trimBuffer=function(){var e=this,t=e._bufferSize,n=e._timestampProvider,r=e._buffer,i=e._infiniteTimeWindow,o=(i?1:2)*t;if(t<1/0&&o<r.length&&r.splice(0,r.length-o),!i){for(var a=n.now(),s=0,u=1;u<r.length&&r[u]<=a;u+=2)s=u;s&&r.splice(0,s+1)}},t}(i.B),s=n(5964),u=n(2685),c=n(2908);function l(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!0!==t){if(!1!==t){var o=new u.Ms({next:function(){o.unsubscribe(),e()}});return(0,s.Tg)(t.apply(void 0,(0,r.fX)([],(0,r.zs)(n)))).subscribe(o)}}else e()}function h(e,t,n){var r,o,h,f,d=!1;return e&&"object"==typeof e?(r=e.bufferSize,f=void 0===r?1/0:r,o=e.windowTime,t=void 0===o?1/0:o,d=void 0!==(h=e.refCount)&&h,n=e.scheduler):f=null!=e?e:1/0,function(e){void 0===e&&(e={});var t=e.connector,n=void 0===t?function(){return new i.B}:t,r=e.resetOnError,o=void 0===r||r,a=e.resetOnComplete,h=void 0===a||a,f=e.resetOnRefCountZero,d=void 0===f||f;return function(e){var t,r,i,a=0,f=!1,p=!1,m=function(){null==r||r.unsubscribe(),r=void 0},y=function(){m(),t=i=void 0,f=p=!1},v=function(){var e=t;y(),null==e||e.unsubscribe()};return(0,c.N)((function(e,c){a++,p||f||m();var g=i=null!=i?i:n();c.add((function(){0!=--a||p||f||(r=l(v,d))})),g.subscribe(c),!t&&a>0&&(t=new u.Ms({next:function(e){return g.next(e)},error:function(e){p=!0,m(),r=l(y,o,e),g.error(e)},complete:function(){f=!0,m(),r=l(y,h),g.complete()}}),(0,s.Tg)(e).subscribe(t))}))(e)}}({connector:function(){return new a(f,t,n)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:d})}},9050:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var r=n(3031);var i=n(6049),o=n(7968);function a(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,r.U)(1)((0,o.H)(e,(0,i.lI)(e)))}var s=n(2908);function u(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=(0,i.lI)(e);return(0,s.N)((function(t,r){(n?a(e,t,n):a(e,t)).subscribe(r)}))}},6744:(e,t,n)=>{"use strict";n.d(t,{f:()=>i});var r=n(1635),i={setTimeout:function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];var a=i.delegate;return(null==a?void 0:a.setTimeout)?a.setTimeout.apply(a,(0,r.fX)([e,t],(0,r.zs)(n))):setTimeout.apply(void 0,(0,r.fX)([e,t],(0,r.zs)(n)))},clearTimeout:function(e){var t=i.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0}},2059:(e,t,n)=>{"use strict";n.d(t,{l:()=>r});var r="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"},5604:(e,t,n)=>{"use strict";n.d(t,{s:()=>r});var r="function"==typeof Symbol&&Symbol.observable||"@@observable"},6049:(e,t,n)=>{"use strict";n.d(t,{R0:()=>s,ms:()=>o,lI:()=>a});var r=n(1209);function i(e){return e[e.length-1]}function o(e){return(0,r.T)(i(e))?e.pop():void 0}function a(e){return(t=i(e))&&(0,r.T)(t.schedule)?e.pop():void 0;var t}function s(e,t){return"number"==typeof i(e)?e.pop():t}},6174:(e,t,n)=>{"use strict";function r(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}n.d(t,{o:()=>r})},2947:(e,t,n)=>{"use strict";function r(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}n.d(t,{L:()=>r})},7008:(e,t,n)=>{"use strict";n.d(t,{Y:()=>o,l:()=>a});var r=n(4384),i=null;function o(e){if(r.$.useDeprecatedSynchronousErrorHandling){var t=!i;if(t&&(i={errorThrown:!1,error:null}),e(),t){var n=i,o=n.errorThrown,a=n.error;if(i=null,o)throw a}}else e()}function a(e){r.$.useDeprecatedSynchronousErrorHandling&&i&&(i.errorThrown=!0,i.error=e)}},6315:(e,t,n)=>{"use strict";function r(e,t,n,r,i){void 0===r&&(r=0),void 0===i&&(i=!1);var o=t.schedule((function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()}),r);if(e.add(o),!i)return o}n.d(t,{N:()=>r})},8307:(e,t,n)=>{"use strict";function r(e){return e}n.d(t,{D:()=>r})},9391:(e,t,n)=>{"use strict";n.d(t,{X:()=>r});var r=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e}},2471:(e,t,n)=>{"use strict";n.d(t,{T:()=>i});var r=n(1209);function i(e){return Symbol.asyncIterator&&(0,r.T)(null==e?void 0:e[Symbol.asyncIterator])}},1209:(e,t,n)=>{"use strict";function r(e){return"function"==typeof e}n.d(t,{T:()=>r})},7541:(e,t,n)=>{"use strict";n.d(t,{l:()=>o});var r=n(5604),i=n(1209);function o(e){return(0,i.T)(e[r.s])}},8667:(e,t,n)=>{"use strict";n.d(t,{x:()=>o});var r=n(2059),i=n(1209);function o(e){return(0,i.T)(null==e?void 0:e[r.l])}},3440:(e,t,n)=>{"use strict";n.d(t,{y:()=>i});var r=n(1209);function i(e){return(0,r.T)(null==e?void 0:e.then)}},8438:(e,t,n)=>{"use strict";n.d(t,{C:()=>o,U:()=>a});var r=n(1635),i=n(1209);function o(e){return(0,r.AQ)(this,arguments,(function(){var t,n,i;return(0,r.YH)(this,(function(o){switch(o.label){case 0:t=e.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,(0,r.N3)(t.read())];case 3:return n=o.sent(),i=n.value,n.done?[4,(0,r.N3)(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,(0,r.N3)(i)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}function a(e){return(0,i.T)(null==e?void 0:e.getReader)}},2908:(e,t,n)=>{"use strict";n.d(t,{N:()=>i});var r=n(1209);function i(e){return function(t){if(function(e){return(0,r.T)(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}},2564:(e,t,n)=>{"use strict";n.d(t,{m:()=>o});var r=n(4384),i=n(6744);function o(e){i.f.setTimeout((function(){var t=r.$.onUnhandledError;if(!t)throw e;t(e)}))}},3465:(e,t,n)=>{"use strict";function r(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}n.d(t,{L:()=>r})},2861:(e,t,n)=>{var r=n(8287),i=r.Buffer;function o(e,t){for(var n in e)t[n]=e[n]}function a(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(o(r,t),t.Buffer=a),a.prototype=Object.create(i.prototype),o(i,a),a.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},a.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=i(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},1770:(e,t,n)=>{const r=n(7833)("simple-peer"),i=n(5064),o=n(3209),a=n(8399),s=n(9596),u=n(6310),{Buffer:c}=n(8287),l=65536;function h(e){return e.replace(/a=ice-options:trickle\s\n/g,"")}class f extends a.Duplex{constructor(e){if(super(e=Object.assign({allowHalfOpen:!1},e)),this._id=o(4).toString("hex").slice(0,7),this._debug("new peer %o",e),this.channelName=e.initiator?e.channelName||o(20).toString("hex"):null,this.initiator=e.initiator||!1,this.channelConfig=e.channelConfig||f.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},f.config,e.config),this.offerOptions=e.offerOptions||{},this.answerOptions=e.answerOptions||{},this.sdpTransform=e.sdpTransform||(e=>e),this.streams=e.streams||(e.stream?[e.stream]:[]),this.trickle=void 0===e.trickle||e.trickle,this.allowHalfTrickle=void 0!==e.allowHalfTrickle&&e.allowHalfTrickle,this.iceCompleteTimeout=e.iceCompleteTimeout||5e3,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=e.wrtc&&"object"==typeof e.wrtc?e.wrtc:i(),!this._wrtc)throw"undefined"==typeof window?u(new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"),"ERR_WEBRTC_SUPPORT"):u(new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(e){return void this.destroy(u(e,"ERR_PC_CONSTRUCTOR"))}this._isReactNativeWebrtc="number"==typeof this._pc._peerConnectionId,this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=e=>{this._onIceCandidate(e)},"object"==typeof this._pc.peerIdentity&&this._pc.peerIdentity.catch((e=>{this.destroy(u(e,"ERR_PC_PEER_IDENTITY"))})),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=e=>{this._setupData(e)},this.streams&&this.streams.forEach((e=>{this.addStream(e)})),this._pc.ontrack=e=>{this._onTrack(e)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&"open"===this._channel.readyState}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(e){if(!this.destroying){if(this.destroyed)throw u(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if("string"==typeof e)try{e=JSON.parse(e)}catch(t){e={}}this._debug("signal()"),e.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),e.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(e.transceiverRequest.kind,e.transceiverRequest.init)),e.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(e.candidate):this._pendingCandidates.push(e.candidate)),e.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(e)).then((()=>{this.destroyed||(this._pendingCandidates.forEach((e=>{this._addIceCandidate(e)})),this._pendingCandidates=[],"offer"===this._pc.remoteDescription.type&&this._createAnswer())})).catch((e=>{this.destroy(u(e,"ERR_SET_REMOTE_DESCRIPTION"))})),e.sdp||e.candidate||e.renegotiate||e.transceiverRequest||this.destroy(u(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(e){const t=new this._wrtc.RTCIceCandidate(e);this._pc.addIceCandidate(t).catch((e=>{var n;!t.address||t.address.endsWith(".local")?(n="Ignoring unsupported ICE candidate.",console.warn(n)):this.destroy(u(e,"ERR_ADD_ICE_CANDIDATE"))}))}send(e){if(!this.destroying){if(this.destroyed)throw u(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(e)}}addTransceiver(e,t){if(!this.destroying){if(this.destroyed)throw u(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(e,t),this._needsNegotiation()}catch(e){this.destroy(u(e,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:e,init:t}})}}addStream(e){if(!this.destroying){if(this.destroyed)throw u(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),e.getTracks().forEach((t=>{this.addTrack(t,e)}))}}addTrack(e,t){if(this.destroying)return;if(this.destroyed)throw u(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const n=this._senderMap.get(e)||new Map;let r=n.get(t);if(r)throw r.removed?u(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):u(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED");r=this._pc.addTrack(e,t),n.set(t,r),this._senderMap.set(e,n),this._needsNegotiation()}replaceTrack(e,t,n){if(this.destroying)return;if(this.destroyed)throw u(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const r=this._senderMap.get(e),i=r?r.get(n):null;if(!i)throw u(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");t&&this._senderMap.set(t,r),null!=i.replaceTrack?i.replaceTrack(t):this.destroy(u(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK"))}removeTrack(e,t){if(this.destroying)return;if(this.destroyed)throw u(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const n=this._senderMap.get(e),r=n?n.get(t):null;if(!r)throw u(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{r.removed=!0,this._pc.removeTrack(r)}catch(e){"NS_ERROR_UNEXPECTED"===e.name?this._sendersAwaitingStable.push(r):this.destroy(u(e,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(e){if(!this.destroying){if(this.destroyed)throw u(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),e.getTracks().forEach((t=>{this.removeTrack(t,e)}))}}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,s((()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1})))}negotiate(){if(!this.destroying){if(this.destroyed)throw u(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout((()=>{this._createOffer()}),0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(e){this._destroy(e,(()=>{}))}_destroy(e,t){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",e&&(e.message||e)),s((()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch(e){}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch(e){}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,e&&this.emit("error",e),this.emit("close"),t()})))}_setupData(e){if(!e.channel)return this.destroy(u(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=e.channel,this._channel.binaryType="arraybuffer","number"==typeof this._channel.bufferedAmountLowThreshold&&(this._channel.bufferedAmountLowThreshold=l),this.channelName=this._channel.label,this._channel.onmessage=e=>{this._onChannelMessage(e)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=e=>{const t=e.error instanceof Error?e.error:new Error(`Datachannel error: ${e.message} ${e.filename}:${e.lineno}:${e.colno}`);this.destroy(u(t,"ERR_DATA_CHANNEL"))};let t=!1;this._closingInterval=setInterval((()=>{this._channel&&"closing"===this._channel.readyState?(t&&this._onChannelClose(),t=!0):t=!1}),5e3)}_read(){}_write(e,t,n){if(this.destroyed)return n(u(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(e)}catch(e){return this.destroy(u(e,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>l?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=n):n(null)}else this._debug("write before connect"),this._chunk=e,this._cb=n}_onFinish(){if(this.destroyed)return;const e=()=>{setTimeout((()=>this.destroy()),1e3)};this._connected?e():this.once("connect",e)}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout((()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))}),this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then((e=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(e.sdp=h(e.sdp)),e.sdp=this.sdpTransform(e.sdp);const t=()=>{if(this.destroyed)return;const t=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:t.type,sdp:t.sdp})};this._pc.setLocalDescription(e).then((()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?t():this.once("_iceComplete",t))})).catch((e=>{this.destroy(u(e,"ERR_SET_LOCAL_DESCRIPTION"))}))})).catch((e=>{this.destroy(u(e,"ERR_CREATE_OFFER"))}))}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach((e=>{e.mid||!e.sender.track||e.requested||(e.requested=!0,this.addTransceiver(e.sender.track.kind))}))}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then((e=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(e.sdp=h(e.sdp)),e.sdp=this.sdpTransform(e.sdp);const t=()=>{if(this.destroyed)return;const t=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:t.type,sdp:t.sdp}),this.initiator||this._requestMissingTransceivers()};this._pc.setLocalDescription(e).then((()=>{this.destroyed||(this.trickle||this._iceComplete?t():this.once("_iceComplete",t))})).catch((e=>{this.destroy(u(e,"ERR_SET_LOCAL_DESCRIPTION"))}))})).catch((e=>{this.destroy(u(e,"ERR_CREATE_ANSWER"))}))}_onConnectionStateChange(){this.destroyed||"failed"===this._pc.connectionState&&this.destroy(u(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const e=this._pc.iceConnectionState,t=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",e,t),this.emit("iceStateChange",e,t),"connected"!==e&&"completed"!==e||(this._pcReady=!0,this._maybeReady()),"failed"===e&&this.destroy(u(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),"closed"===e&&this.destroy(u(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(e){const t=e=>("[object Array]"===Object.prototype.toString.call(e.values)&&e.values.forEach((t=>{Object.assign(e,t)})),e);0===this._pc.getStats.length||this._isReactNativeWebrtc?this._pc.getStats().then((n=>{const r=[];n.forEach((e=>{r.push(t(e))})),e(null,r)}),(t=>e(t))):this._pc.getStats.length>0?this._pc.getStats((n=>{if(this.destroyed)return;const r=[];n.result().forEach((e=>{const n={};e.names().forEach((t=>{n[t]=e.stat(t)})),n.id=e.id,n.type=e.type,n.timestamp=e.timestamp,r.push(t(n))})),e(null,r)}),(t=>e(t))):e(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const e=()=>{this.destroyed||this.getStats(((t,n)=>{if(this.destroyed)return;t&&(n=[]);const r={},i={},o={};let a=!1;n.forEach((e=>{"remotecandidate"!==e.type&&"remote-candidate"!==e.type||(r[e.id]=e),"localcandidate"!==e.type&&"local-candidate"!==e.type||(i[e.id]=e),"candidatepair"!==e.type&&"candidate-pair"!==e.type||(o[e.id]=e)}));const s=e=>{a=!0;let t=i[e.localCandidateId];t&&(t.ip||t.address)?(this.localAddress=t.ip||t.address,this.localPort=Number(t.port)):t&&t.ipAddress?(this.localAddress=t.ipAddress,this.localPort=Number(t.portNumber)):"string"==typeof e.googLocalAddress&&(t=e.googLocalAddress.split(":"),this.localAddress=t[0],this.localPort=Number(t[1])),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let n=r[e.remoteCandidateId];n&&(n.ip||n.address)?(this.remoteAddress=n.ip||n.address,this.remotePort=Number(n.port)):n&&n.ipAddress?(this.remoteAddress=n.ipAddress,this.remotePort=Number(n.portNumber)):"string"==typeof e.googRemoteAddress&&(n=e.googRemoteAddress.split(":"),this.remoteAddress=n[0],this.remotePort=Number(n[1])),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(n.forEach((e=>{"transport"===e.type&&e.selectedCandidatePairId&&s(o[e.selectedCandidatePairId]),("googCandidatePair"===e.type&&"true"===e.googActiveConnection||("candidatepair"===e.type||"candidate-pair"===e.type)&&e.selected)&&s(e)})),a||Object.keys(o).length&&!Object.keys(i).length){if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(t){return this.destroy(u(t,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const e=this._cb;this._cb=null,e(null)}"number"!=typeof this._channel.bufferedAmountLowThreshold&&(this._interval=setInterval((()=>this._onInterval()),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")}else setTimeout(e,100)}))};e()}_onInterval(){!this._cb||!this._channel||this._channel.bufferedAmount>l||this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||("stable"===this._pc.signalingState&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach((e=>{this._pc.removeTrack(e),this._queuedNegotiation=!0})),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(e){this.destroyed||(e.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):e.candidate||this._iceComplete||(this._iceComplete=!0,this.emit("_iceComplete")),e.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(e){if(this.destroyed)return;let t=e.data;t instanceof ArrayBuffer&&(t=c.from(t)),this.push(t)}_onChannelBufferedAmountLow(){if(this.destroyed||!this._cb)return;this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const e=this._cb;this._cb=null,e(null)}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(e){this.destroyed||e.streams.forEach((t=>{this._debug("on track"),this.emit("track",e.track,t),this._remoteTracks.push({track:e.track,stream:t}),this._remoteStreams.some((e=>e.id===t.id))||(this._remoteStreams.push(t),s((()=>{this._debug("on stream"),this.emit("stream",t)})))}))}_debug(){const e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],r.apply(null,e)}}f.WEBRTC_SUPPORT=!!i(),f.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},f.channelConfig={},e.exports=f},3141:(e,t,n)=>{"use strict";var r=n(2861).Buffer,i=r.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(r.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=u,this.end=c,t=4;break;case"utf8":this.fillLast=s,t=4;break;case"base64":this.text=l,this.end=h,t=3;break;default:return this.write=f,void(this.end=d)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(t)}function a(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function s(e){var t=this.lastTotal-this.lastNeed,n=function(e,t,n){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function u(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function c(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function l(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function h(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function f(e){return e.toString(this.encoding)}function d(e){return e&&e.length?this.write(e):""}t.I=o,o.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},o.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},o.prototype.text=function(e,t){var n=function(e,t,n){var r=t.length-1;if(r<n)return 0;var i=a(t[r]);if(i>=0)return i>0&&(e.lastNeed=i-1),i;if(--r<n||-2===i)return 0;if(i=a(t[r]),i>=0)return i>0&&(e.lastNeed=i-2),i;if(--r<n||-2===i)return 0;if(i=a(t[r]),i>=0)return i>0&&(2===i?i=0:e.lastNeed=i-3),i;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var r=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},4643:(e,t,n)=>{function r(e){try{if(!n.g.localStorage)return!1}catch(e){return!1}var t=n.g.localStorage[e];return null!=t&&"true"===String(t).toLowerCase()}e.exports=function(e,t){if(r("noDeprecation"))return e;var n=!1;return function(){if(!n){if(r("throwDeprecation"))throw new Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),n=!0}return e.apply(this,arguments)}}},5340:()=>{},9838:()=>{},2212:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,i(r.key),r)}}function a(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}n.d(t,{A:()=>a})},1779:(e,t,n)=>{"use strict";n.d(t,{p4:()=>r});class r{ttl;map=new Map;_to=!1;constructor(e){this.ttl=e}has(e){return this.map.has(e)}add(e){this.map.set(e,i()),this._to||(this._to=!0,setTimeout((()=>{this._to=!1,function(e){const t=i()-e.ttl,n=e.map[Symbol.iterator]();for(;;){const r=n.next().value;if(!r)return;const i=r[0];if(!(r[1]<t))return;e.map.delete(i)}}(this)}),0))}clear(){this.map.clear()}}function i(){return Date.now()}},4344:(e,t,n)=>{"use strict";n.d(t,{K:()=>l,X:()=>h});var r=n(2212),i=n(6250),o=n(2085),a=n(4391),s=n(7205),u=n(2507),c=n(6493),l=function(){function e(e,t,n){this.cacheItemByDocId=new Map,this.registry="function"==typeof FinalizationRegistry?new FinalizationRegistry((e=>{var t=e.docId,n=this.cacheItemByDocId.get(t);n&&(n.byRev.delete(e.revisionHeight),0===n.byRev.size&&this.cacheItemByDocId.delete(t))})):void 0,this.registerIdleTasks=[],this.primaryPath=e,this.changes$=t,this.documentCreator=n,t.subscribe((e=>{var t=e.documentId,n=this.cacheItemByDocId.get(t);if(n){var r=(0,c.vk)(e);n.last=r}}))}var t=e.prototype;return t.getLatestDocumentData=function(e){return(0,i.m)(this.cacheItemByDocId,e).last},t.getLatestDocumentDataIfExists=function(e){var t=this.cacheItemByDocId.get(e);if(t)return t.last},(0,r.A)(e,[{key:"getCachedRxDocument",get:function(){var e=function(e){var t=e.primaryPath,n=e.cacheItemByDocId,r=e.registry,o=u.h.deepFreezeWhenDevMode,c=e.documentCreator,l=u=>{var l=u[t],h=(0,a.Wg)(u._rev),d=(0,i.q)(n,l,(()=>function(e){return{byRev:new Map,last:e}}(u))),p=d.byRev,m=p.get(h),y=m?m.deref():void 0;return y||(u=o(u),y=c(u),p.set(h,f(y)),r&&(e.registerIdleTasks.push(y),e.registerIdlePromise||(e.registerIdlePromise=(0,s.vN)().then((()=>{e.registerIdlePromise=void 0;var t=e.registerIdleTasks;0!==t.length&&(e.registerIdleTasks=[],t.forEach((e=>{r.register(e,{docId:e.primary,revisionHeight:(0,a.Wg)(e.revision)})})))}))))),y};return l}(this);return(0,o.Ns)(this,"getCachedRxDocument",e)}}])}();function h(e,t){for(var n=e.getCachedRxDocument,r=[],i=0;i<t.length;i++){var o=n(t[i]);r.push(o)}return r}var f="function"==typeof WeakRef?function(e){return new WeakRef(e)}:function(e){return{deref:()=>e}}},337:(e,t,n)=>{"use strict";n.d(t,{FX:()=>o,Xi:()=>i,r:()=>r});var r={preAddRxPlugin:[],preCreateRxDatabase:[],createRxDatabase:[],preCreateRxCollection:[],createRxCollection:[],createRxState:[],postDestroyRxCollection:[],postRemoveRxCollection:[],preCreateRxSchema:[],createRxSchema:[],preCreateRxQuery:[],prePrepareQuery:[],createRxDocument:[],postCreateRxDocument:[],preCreateRxStorageInstance:[],preMigrateDocument:[],postMigrateDocument:[],preDestroyRxDatabase:[],postRemoveRxDatabase:[],preReplicationMasterWrite:[],preReplicationMasterWriteDocumentsHandle:[]};function i(e,t){r[e]&&r[e].forEach((e=>e(t)))}function o(e,t){return Promise.all(r[e].map((e=>e(t))))}},2843:(e,t,n)=>{"use strict";n.d(t,{Hl:()=>l,N6:()=>c});var r=n(6606),i=n(6250),o=n(7494),a=n(2085),s=n(3715),u=n(4391),c=function(){function e(e,t,n,r){this.queueByDocId=new Map,this.isRunning=!1,this.storageInstance=e,this.primaryPath=t,this.preWrite=n,this.postWrite=r}var t=e.prototype;return t.addWrite=function(e,t){var n=e[this.primaryPath],r=(0,i.q)(this.queueByDocId,n,(()=>[]));return new Promise(((n,i)=>{var a={lastKnownDocumentState:e,modifier:t,resolve:n,reject:i};(0,o.ZN)(r).push(a),this.triggerRun()}))},t.triggerRun=async function(){if(!0!==this.isRunning&&0!==this.queueByDocId.size){this.isRunning=!0;var e=[],t=this.queueByDocId;this.queueByDocId=new Map,await Promise.all(Array.from(t.entries()).map((async([t,n])=>{var r,i,o,s=(r=n.map((e=>e.lastKnownDocumentState)),i=r[0],o=(0,u.Pp)(i._rev).height,r.forEach((e=>{var t=(0,u.Pp)(e._rev).height;t>o&&(i=e,o=t)})),i),c=s;for(var l of n)try{c=await l.modifier((0,a.o8)(c))}catch(e){l.reject(e),l.reject=()=>{},l.resolve=()=>{}}try{await this.preWrite(c,s)}catch(e){return void n.forEach((t=>t.reject(e)))}e.push({previous:s,document:c})})));var n=e.length>0?await this.storageInstance.bulkWrite(e,"incremental-write"):{error:[],success:[]};return await Promise.all(n.success.map((e=>{var n=e[this.primaryPath];this.postWrite(e),(0,i.m)(t,n).forEach((t=>t.resolve(e)))}))),n.error.forEach((e=>{var n=e.documentId,a=(0,i.m)(t,n),s=(0,r.sX)(e);if(s){var u=(0,i.q)(this.queueByDocId,n,(()=>[]));a.reverse().forEach((e=>{e.lastKnownDocumentState=(0,o.ZN)(s.documentInDb),(0,o.ZN)(u).unshift(e)}))}else{var c=(0,r.cg)(e);a.forEach((e=>e.reject(c)))}})),this.isRunning=!1,this.triggerRun()}},e}();function l(e){return async t=>{var n=(0,s.Xz)(t);n._deleted=t._deleted;var r=await e(n),i=Object.assign({},r,{_meta:t._meta,_attachments:t._attachments,_rev:t._rev,_deleted:void 0!==r._deleted?r._deleted:t._deleted});return void 0===i._deleted&&(i._deleted=!1),i}}},2507:(e,t,n)=>{"use strict";n.d(t,{h:()=>r});var r={isDevMode:()=>!1,deepFreezeWhenDevMode:e=>e,tunnelErrorMessage:e=>"RxDB Error-Code "+e+".\n        Error messages are not included in RxDB core to reduce build size.\n        - To find out what this error means, either use the dev-mode-plugin https://rxdb.info/dev-mode.html\n        - or search for the error code here: https://github.com/pubkey/rxdb/search?q="+e+"\n        "}},2217:(e,t,n)=>{"use strict";function r(e){return e[e.length-1]}function i(e){return Array.isArray(e)?e.slice(0):[e]}function o(e,t){e=e.slice(0);for(var n=[];e.length;){var r=e.splice(0,t);n.push(r)}return n}function a(e){return Array.isArray(e)}function s(e){return null!=e}function u(e,t){var n=0,r=-1;for(var i of e){if(!t(i,r+=1))break;n+=1}return n}function c(e,t){for(var n=t.length,r=0;r<n;++r){var i=t[r];e.push(i)}}function l(e){return e.filter((function(e,t,n){return n.indexOf(e)===t}))}n.d(t,{$r:()=>i,Aj:()=>o,Hb:()=>c,S7:()=>s,Sd:()=>u,dG:()=>r,jw:()=>l,k_:()=>a})},3715:(e,t,n)=>{"use strict";n.d(t,{Fq:()=>o,MC:()=>r,Xz:()=>a,YL:()=>s,o4:()=>i});var r=1;function i(){return{lwt:r}}function o(){return""}function a(e){return Object.assign({},e,{_meta:void 0,_deleted:void 0,_rev:void 0})}function s(e,t,n){if(t.length!==n.length)return!1;for(var r=0,i=t.length;r<i;){var o=t[r],a=n[r];if(r++,o._rev!==a._rev||o[e]!==a[e])return!1}return!0}},4034:(e,t,n)=>{"use strict";n.d(t,{S:()=>o,u:()=>i});var r=n(4815);function i(e){var t=e.split("-"),n="RxDB";return t.forEach((e=>{n+=(0,r.Z2)(e)})),n+="Plugin",new Error("You are using a function which must be overwritten by a plugin.\n        You should either prevent the usage of this function or add the plugin via:\n            import { "+n+" } from 'rxdb/plugins/"+e+"';\n            addRxPlugin("+n+");\n        ")}function o(e){return{name:e.name,message:e.message,rxdb:e.rxdb,parameters:e.parameters,code:e.code,stack:e.stack?e.stack.replace(/\n/g," \n "):void 0}}},2748:(e,t,n)=>{"use strict";n.d(t,{V0:()=>p});Object.freeze({ignoreUnknown:!1,respectType:!1,respectFunctionNames:!1,respectFunctionProperties:!1,unorderedObjects:!0,unorderedArrays:!1,unorderedSets:!1,excludeKeys:void 0,excludeValues:void 0,replacer:void 0});Object.freeze(["prototype","__proto__","constructor"]);const r="[native code] }";r.length;class i{constructor(e,t){e=this.words=e||[],this.sigBytes=void 0===t?4*e.length:t}toString(e){return(e||o).stringify(this)}concat(e){if(this.clamp(),this.sigBytes%4)for(let t=0;t<e.sigBytes;t++){const n=e.words[t>>>2]>>>24-t%4*8&255;this.words[this.sigBytes+t>>>2]|=n<<24-(this.sigBytes+t)%4*8}else for(let t=0;t<e.sigBytes;t+=4)this.words[this.sigBytes+t>>>2]=e.words[t>>>2];return this.sigBytes+=e.sigBytes,this}clamp(){this.words[this.sigBytes>>>2]&=4294967295<<32-this.sigBytes%4*8,this.words.length=Math.ceil(this.sigBytes/4)}clone(){return new i([...this.words])}}const o={stringify(e){const t=[];for(let n=0;n<e.sigBytes;n++){const r=e.words[n>>>2]>>>24-n%4*8&255;t.push((r>>>4).toString(16),(15&r).toString(16))}return t.join("")}},a={parse(e){const t=e.length,n=[];for(let r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new i(n,t)}},s={parse:e=>a.parse(unescape(encodeURIComponent(e)))};class u{constructor(){this._data=new i,this._nDataBytes=0,this._minBufferSize=0,this.blockSize=16}reset(){this._data=new i,this._nDataBytes=0}_append(e){"string"==typeof e&&(e=s.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes}_doProcessBlock(e,t){}_process(e){let t,n=this._data.sigBytes/(4*this.blockSize);n=e?Math.ceil(n):Math.max((0|n)-this._minBufferSize,0);const r=n*this.blockSize,o=Math.min(4*r,this._data.sigBytes);if(r){for(let e=0;e<r;e+=this.blockSize)this._doProcessBlock(this._data.words,e);t=this._data.words.splice(0,r),this._data.sigBytes-=o}return new i(t,o)}}class c extends u{update(e){return this._append(e),this._process(),this}finalize(e){e&&this._append(e)}}const l=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],h=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],f=[];class d extends c{constructor(){super(...arguments),this._hash=new i([...l])}reset(){super.reset(),this._hash=new i([...l])}_doProcessBlock(e,t){const n=this._hash.words;let r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=n[6],l=n[7];for(let n=0;n<64;n++){if(n<16)f[n]=0|e[t+n];else{const e=f[n-15],t=(e<<25|e>>>7)^(e<<14|e>>>18)^e>>>3,r=f[n-2],i=(r<<15|r>>>17)^(r<<13|r>>>19)^r>>>10;f[n]=t+f[n-7]+i+f[n-16]}const d=r&i^r&o^i&o,p=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),m=l+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&u^~s&c)+h[n]+f[n];l=c,c=u,u=s,s=a+m|0,a=o,o=i,i=r,r=m+(p+d)|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+a|0,n[4]=n[4]+s|0,n[5]=n[5]+u|0,n[6]=n[6]+c|0,n[7]=n[7]+l|0}finalize(e){super.finalize(e);const t=8*this._nDataBytes,n=8*this._data.sigBytes;return this._data.words[n>>>5]|=128<<24-n%32,this._data.words[14+(n+64>>>9<<4)]=Math.floor(t/4294967296),this._data.words[15+(n+64>>>9<<4)]=t,this._data.sigBytes=4*this._data.words.length,this._process(),this._hash}}var p="undefined"!=typeof crypto&&void 0!==crypto.subtle&&"function"==typeof crypto.subtle.digest?async function(e){var t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t);return Array.prototype.map.call(new Uint8Array(n),(e=>("00"+e.toString(16)).slice(-2))).join("")}:function(e){return Promise.resolve((t=e,(new d).finalize(t).toString()));var t}},6250:(e,t,n)=>{"use strict";function r(e,t){var n=e.get(t);if(void 0===n)throw new Error("missing value from map "+t);return n}function i(e,t,n,r){var i=e.get(t);return void 0===i?(i=n(),e.set(t,i)):r&&r(i),i}n.d(t,{m:()=>r,q:()=>i})},4701:(e,t,n)=>{"use strict";function r(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){if(e.constructor!==t.constructor)return!1;var n,i;if(Array.isArray(e)){if((n=e.length)!==t.length)return!1;for(i=n;0!=i--;)if(!r(e[i],t[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();var o=Object.keys(e);if((n=o.length)!==Object.keys(t).length)return!1;for(i=n;0!=i--;)if(!Object.prototype.hasOwnProperty.call(t,o[i]))return!1;for(i=n;0!=i--;){var a=o[i];if(!r(e[a],t[a]))return!1}return!0}return e!=e&&t!=t}n.d(t,{b:()=>r})},9101:(e,t,n)=>{"use strict";n.d(t,{UU:()=>c,oq:()=>l});var r=e=>{var t=typeof e;return null!==e&&("object"===t||"function"===t)},i=new Set(["__proto__","prototype","constructor"]),o=new Set("0123456789");function a(e){var t=[],n="",r="start",a=!1;for(var s of e)switch(s){case"\\":if("index"===r)throw new Error("Invalid character in an index");if("indexEnd"===r)throw new Error("Invalid character after an index");a&&(n+=s),r="property",a=!a;break;case".":if("index"===r)throw new Error("Invalid character in an index");if("indexEnd"===r){r="property";break}if(a){a=!1,n+=s;break}if(i.has(n))return[];t.push(n),n="",r="property";break;case"[":if("index"===r)throw new Error("Invalid character in an index");if("indexEnd"===r){r="index";break}if(a){a=!1,n+=s;break}if("property"===r){if(i.has(n))return[];t.push(n),n=""}r="index";break;case"]":if("index"===r){t.push(Number.parseInt(n,10)),n="",r="indexEnd";break}if("indexEnd"===r)throw new Error("Invalid character after an index");default:if("index"===r&&!o.has(s))throw new Error("Invalid character in an index");if("indexEnd"===r)throw new Error("Invalid character after an index");"start"===r&&(r="property"),a&&(a=!1,n+="\\"),n+=s}switch(a&&(n+="\\"),r){case"property":if(i.has(n))return[];t.push(n);break;case"index":throw new Error("Index was not closed");case"start":t.push("")}return t}function s(e,t){if("number"!=typeof t&&Array.isArray(e)){var n=Number.parseInt(t,10);return Number.isInteger(n)&&e[n]===e[t]}return!1}function u(e,t){if(s(e,t))throw new Error("Cannot use string index")}function c(e,t,n){if(Array.isArray(t)&&(t=t.join(".")),!t.includes(".")&&!t.includes("["))return e[t];if(!r(e)||"string"!=typeof t)return void 0===n?e:n;var i=a(t);if(0===i.length)return n;for(var o=0;o<i.length;o++){var u=i[o];if(null==(e=s(e,u)?o===i.length-1?void 0:null:e[u])){if(o!==i.length-1)return n;break}}return void 0===e?n:e}function l(e,t,n){if(Array.isArray(t)&&(t=t.join(".")),!r(e)||"string"!=typeof t)return e;for(var i=e,o=a(t),s=0;s<o.length;s++){var c=o[s];u(e,c),s===o.length-1?e[c]=n:r(e[c])||(e[c]="number"==typeof o[s+1]?[]:{}),e=e[c]}return i}},2085:(e,t,n)=>{"use strict";function r(e){return Object.freeze(e),Object.getOwnPropertyNames(e).forEach((function(t){!Object.prototype.hasOwnProperty.call(e,t)||null===e[t]||"object"!=typeof e[t]&&"function"!=typeof e[t]||Object.isFrozen(e[t])||r(e[t])})),e}function i(e){var t=e.split("."),n=t.length;return 1===n?t=>t[e]:e=>{for(var r=e,i=0;i<n;++i){if(void 0===(r=r[t[i]]))return r}return r}}function o(e){var t={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n))if("object"==typeof e[n]){var r=o(e[n]);for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[n+"."+i]=r[i])}else t[n]=e[n];return t}function a(e){return Object.assign({},e)}function s(e){return Object.keys(e)[0]}function u(e,t=!1){if(!e)return e;if(!t&&Array.isArray(e))return e.sort(((e,t)=>"string"==typeof e&&"string"==typeof t?e.localeCompare(t):"object"==typeof e?1:-1)).map((e=>u(e,t)));if("object"==typeof e&&!Array.isArray(e)){var n={};return Object.keys(e).sort(((e,t)=>e.localeCompare(t))).forEach((r=>{n[r]=u(e[r],t)})),n}return e}n.d(t,{FD:()=>a,Ln:()=>s,Ns:()=>l,SQ:()=>i,YO:()=>o,mf:()=>u,o8:()=>c,ol:()=>r});var c=function e(t){if(!t)return t;if(null===t||"object"!=typeof t)return t;if(Array.isArray(t)){for(var n=new Array(t.length),r=n.length;r--;)n[r]=e(t[r]);return n}var i={};for(var o in t)i[o]=e(t[o]);return i};function l(e,t,n){return Object.defineProperty(e,t,{get:function(){return n}}),n}},7494:(e,t,n)=>{"use strict";function r(e,t){if(!e)throw t||(t=""),new Error("ensureNotFalsy() is falsy: "+t);return e}n.d(t,{ZN:()=>r,bz:()=>i});var i={bufferSize:1,refCount:!0}},7205:(e,t,n)=>{"use strict";function r(){return new Promise((e=>setTimeout(e,0)))}function i(e=0){return new Promise((t=>setTimeout(t,e)))}function o(e){return e&&"function"==typeof e.then?e:Promise.resolve(e)}n.d(t,{$A:()=>u,D:()=>d,Dr:()=>s,Ms:()=>a,ND:()=>i,Ve:()=>f,dY:()=>r,em:()=>c,h$:()=>p,hq:()=>o,vN:()=>l});var a=Promise.resolve(!0),s=Promise.resolve(!1),u=Promise.resolve(null),c=Promise.resolve();function l(e=1e4){return"function"==typeof requestIdleCallback?new Promise((t=>{requestIdleCallback((()=>t()),{timeout:e})})):i(0)}var h=c;function f(e=void 0){return h=h.then((()=>l(e)))}function d(e){"function"==typeof requestIdleCallback&&requestIdleCallback((()=>{e()}))}function p(e,t){return e.reduce(((e,t)=>e.then(t)),Promise.resolve(t))}},4391:(e,t,n)=>{"use strict";function r(e){var t=e.split("-");if(2!==t.length)throw new Error("malformatted revision: "+e);return{height:parseInt(t[0],10),hash:t[1]}}function i(e){return parseInt(e.split("-")[0],10)}function o(e,t){var n=t?t._rev:null;return(n?r(n).height:0)+1+"-"+e}n.d(t,{CM:()=>o,Pp:()=>r,Wg:()=>i})},4807:(e,t,n)=>{"use strict";n.d(t,{o:()=>r});var r="15.15.0"},4815:(e,t,n)=>{"use strict";n.d(t,{L$:()=>a,Z2:()=>o,ky:()=>s,z3:()=>i});var r="abcdefghijklmnopqrstuvwxyz";function i(e=10){for(var t="",n=0;n<e;n++)t+=r.charAt(Math.floor(Math.random()*r.length));return t}function o(e){return(e+="").charAt(0).toUpperCase()+e.substr(1)}function a(e){for(;"."===e.charAt(0);)e=e.substr(1);for(;"."===e.slice(-1);)e=e.slice(0,-1);return e}function s(e){return!(!e.includes("/")&&!e.includes("\\"))}},5923:(e,t,n)=>{"use strict";n.d(t,{t:()=>i});var r=0;function i(){var e=Date.now();(e+=.01)<=r&&(e=r+.01);var t=parseFloat(e.toFixed(2));return r=t,t}},9110:(e,t,n)=>{"use strict";n.d(t,{Cx:()=>f,XA:()=>s,n9:()=>p});var r=n(6250),i=n(5923),o=n(7205),a=function(){function e(){this._map=new Map}return e.prototype.getByQuery=function(e){var t=e.toString();return(0,r.q)(this._map,t,(()=>e))},e}();function s(){return new a}function u(e,t){t.uncached=!0;var n=t.toString();e._map.delete(n)}function c(e){return e.refCount$.observers.length}var l,h,f=(l=100,h=3e4,(e,t)=>{if(!(t._map.size<l)){var n=(0,i.t)()-h,r=[],o=Array.from(t._map.values());for(var a of o)c(a)>0||(0===a._lastEnsureEqual&&a._creationTime<n?u(t,a):r.push(a));var s=r.length-l;s<=0||r.sort(((e,t)=>e._lastEnsureEqual-t._lastEnsureEqual)).slice(0,s).forEach((e=>u(t,e)))}}),d=new WeakSet;function p(e){d.has(e)||(d.add(e),(0,o.dY)().then((()=>(0,o.Ve)(200))).then((()=>{e.destroyed||e.cacheReplacementPolicy(e,e._queryCache),d.delete(e)})))}},3040:(e,t,n)=>{"use strict";n.d(t,{Cf:()=>c,OK:()=>s,g0:()=>a,sk:()=>u});var r=n(2217),i=n(6606),o=n(6143),a=String.fromCharCode(65535),s=Number.MIN_SAFE_INTEGER;function u(e,t){var n=t.selector,u=e.indexes?e.indexes.slice(0):[];t.index&&(u=[t.index]);var l=!!t.sort.find((e=>"desc"===Object.values(e)[0])),h=new Set;Object.keys(n).forEach((t=>{var r=(0,o.nT)(e,t);r&&"boolean"===r.type&&Object.prototype.hasOwnProperty.call(n[t],"$eq")&&h.add(t)}));var d,p=t.sort.map((e=>Object.keys(e)[0])).filter((e=>!h.has(e))).join(","),m=-1;if(u.forEach((e=>{var i=!0,o=!0,u=e.map((e=>{var t=n[e],r=t?Object.keys(t):[],u={};t&&r.length?r.forEach((e=>{if(c.has(e)){var n=function(e,t){switch(e){case"$eq":return{startKey:t,endKey:t,inclusiveEnd:!0,inclusiveStart:!0};case"$lte":return{endKey:t,inclusiveEnd:!0};case"$gte":return{startKey:t,inclusiveStart:!0};case"$lt":return{endKey:t,inclusiveEnd:!1};case"$gt":return{startKey:t,inclusiveStart:!1};default:throw new Error("SNH")}}(e,t[e]);u=Object.assign(u,n)}})):u={startKey:o?s:a,endKey:i?a:s,inclusiveStart:!0,inclusiveEnd:!0};return void 0===u.startKey&&(u.startKey=s),void 0===u.endKey&&(u.endKey=a),void 0===u.inclusiveStart&&(u.inclusiveStart=!0),void 0===u.inclusiveEnd&&(u.inclusiveEnd=!0),o&&!u.inclusiveStart&&(o=!1),i&&!u.inclusiveEnd&&(i=!1),u})),y=u.map((e=>e.startKey)),v=u.map((e=>e.endKey)),g={index:e,startKeys:y,endKeys:v,inclusiveEnd:i,inclusiveStart:o,sortSatisfiedByIndex:!l&&p===e.filter((e=>!h.has(e))).join(","),selectorSatisfiedByIndex:f(e,t.selector,y,v)},b=function(e,t,n){var i=0,o=e=>{e>0&&(i+=e)},u=10,c=(0,r.Sd)(n.startKeys,(e=>e!==s&&e!==a));o(c*u);var l=(0,r.Sd)(n.startKeys,(e=>e!==a&&e!==s));o(l*u);var h=(0,r.Sd)(n.startKeys,((e,t)=>e===n.endKeys[t]));o(h*u*1.5);var f=n.sortSatisfiedByIndex?5:0;return o(f),i}(0,0,g);(b>=m||t.index)&&(m=b,d=g)})),!d)throw(0,i.Br)("SNH",{query:t});return d}var c=new Set(["$eq","$gt","$gte","$lt","$lte"]),l=new Set(["$eq","$gt","$gte"]),h=new Set(["$eq","$lt","$lte"]);function f(e,t,n,r){var i=Object.entries(t).find((([t,n])=>!e.includes(t)||Object.entries(n).find((([e,t])=>!c.has(e)))));if(i)return!1;if(t.$and||t.$or)return!1;var o=[],a=new Set;for(var[s,u]of Object.entries(t)){if(!e.includes(s))return!1;var f=Object.keys(u).filter((e=>l.has(e)));if(f.length>1)return!1;var d=f[0];if(d&&a.add(s),"$eq"!==d){if(o.length>0)return!1;o.push(d)}}var p=[],m=new Set;for(var[y,v]of Object.entries(t)){if(!e.includes(y))return!1;var g=Object.keys(v).filter((e=>h.has(e)));if(g.length>1)return!1;var b=g[0];if(b&&m.add(y),"$eq"!==b){if(p.length>0)return!1;p.push(b)}}var w=0;for(var _ of e){for(var E of[a,m]){if(!E.has(_)&&E.size>0)return!1;E.delete(_)}if(n[w]!==r[w]&&a.size>0&&m.size>0)return!1;w++}return!0}},7092:(e,t,n)=>{"use strict";n.d(t,{a:()=>c,r:()=>l});var r=n(4701),i=n(2085),o=n(3715),a=n(5923),s=n(4391),u=n(1232),c=function(e,t){var n=(0,u.on)(e.newDocumentState),i=(0,u.on)(e.realMasterState);return(0,r.b)(n,i)?Promise.resolve({isEqual:!0}):Promise.resolve({isEqual:!1,documentData:e.realMasterState})};async function l(e,t,n){var r=e.input.conflictHandler,u=await r(t,"replication-resolve-conflict");if(!u.isEqual){var c=Object.assign({},u.documentData,{_meta:(0,i.FD)(n._meta),_rev:(0,o.Fq)(),_attachments:(0,i.FD)(n._attachments)});return c._meta.lwt=(0,a.t)(),c._rev=(0,s.CM)(await e.checkpointKey,n),{resolvedDoc:c,output:u}}}},6493:(e,t,n)=>{"use strict";n.d(t,{_r:()=>o,vk:()=>i});var r=n(2507);function i(e){return e.documentData?e.documentData:e.previousDocumentData}function o(e){switch(e.operation){case"INSERT":return{operation:e.operation,id:e.documentId,doc:e.documentData,previous:null};case"UPDATE":return{operation:e.operation,id:e.documentId,doc:r.h.deepFreezeWhenDevMode(e.documentData),previous:e.previousDocumentData?e.previousDocumentData:"UNKNOWN"};case"DELETE":return{operation:e.operation,id:e.documentId,doc:null,previous:e.previousDocumentData}}}},6377:(e,t,n)=>{"use strict";n.d(t,{JY:()=>f,vK:()=>d,vM:()=>p});var r=n(2085),i=n(3715),o=n(5923),a=n(4391),s=n(6143),u=n(337),c=n(467),l=n(1232),h=n(2507);function f(e,t){return t=(0,r.FD)(t),t=(0,s.pA)(e,t),(t=(0,s.Nq)(e.primaryPath,e.jsonSchema,t))._meta=(0,i.o4)(),Object.prototype.hasOwnProperty.call(t,"_deleted")||(t._deleted=!1),Object.prototype.hasOwnProperty.call(t,"_attachments")||(t._attachments={}),Object.prototype.hasOwnProperty.call(t,"_rev")||(t._rev=(0,i.Fq)()),t}async function d(e,t){return t.multiInstance=e.multiInstance,await e.storage.createStorageInstance(t)}async function p(e,t,n,r,i,s,f){var d=(await(0,c.WY)(t)).filter((e=>e.data.name===i)),p=[];d.forEach((e=>{p.push({collectionName:e.data.name,schema:e.data.schema,isCollection:!0}),e.data.connectedStorages.forEach((e=>p.push({collectionName:e.collectionName,isCollection:!1,schema:e.schema})))}));var m=new Set;if(p=p.filter((e=>{var t=e.collectionName+"||"+e.schema.version;return!m.has(t)&&(m.add(t),!0)})),await Promise.all(p.map((async t=>{var o=await e.createStorageInstance({collectionName:t.collectionName,databaseInstanceToken:n,databaseName:r,multiInstance:!1,options:{},schema:t.schema,password:s,devMode:h.h.isDevMode()});await o.remove(),t.isCollection&&await(0,u.FX)("postRemoveRxCollection",{storage:e,databaseName:r,collectionName:i})}))),f){var y=d.map((e=>{var t=(0,l.C9)(e);return t._deleted=!0,t._meta.lwt=(0,o.t)(),t._rev=(0,a.CM)(n,e),{previous:e,document:t}}));await t.bulkWrite(y,"rx-database-remove-collection-all")}}},7579:(e,t,n)=>{"use strict";n.d(t,{wm:()=>D,dN:()=>T});var r=n(2212),i=n(6126),o=n(8452),a=n(1160),s=n(7205),u=n(4034),c=n(7494),l=n(2085),h=n(6250),f=n(4815),d=n(6377),p=n(915),m=n(6606),y=n(4344),v=n(9110),g=function(){function e(e){this.subs=[],this.limit=100,this.counter=0,this.eventCounterMap=new WeakMap,this.buffer=[],this.collection=e,this.subs.push(this.collection.$.pipe((0,i.p)((e=>!e.isLocal))).subscribe((e=>this._handleChangeEvent(e))))}var t=e.prototype;return t._handleChangeEvent=function(e){for(this.counter++,this.buffer.push(e),this.eventCounterMap.set(e,this.counter);this.buffer.length>this.limit;)this.buffer.shift()},t.getArrayIndexByPointer=function(e){var t=this.buffer[0],n=this.eventCounterMap.get(t);return e<n?null:e-n},t.getFrom=function(e){var t=[],n=this.getArrayIndexByPointer(e);if(null===n)return null;for(;;){var r=this.buffer[n];if(n++,!r)return t;t.push(r)}},t.runFrom=function(e,t){var n=this.getFrom(e);if(null===n)throw new Error("out of bounds");n.forEach((e=>t(e)))},t.reduceByLastOfDoc=function(e){return e.slice(0)},t.destroy=function(){this.subs.forEach((e=>e.unsubscribe()))},e}();var b=n(337),w=n(2497),_=n(2507),E=new WeakMap;function k(e){var t=e.schema.getDocumentPrototype(),n=function(e){var t={};return Object.entries(e.methods).forEach((([e,n])=>{t[e]=n})),t}(e),r=w.ky,i={};return[t,n,r].forEach((e=>{Object.getOwnPropertyNames(e).forEach((t=>{var n=Object.getOwnPropertyDescriptor(e,t),r=!0;(t.startsWith("_")||t.endsWith("_")||t.startsWith("$")||t.endsWith("$"))&&(r=!1),"function"==typeof n.value?Object.defineProperty(i,t,{get(){return n.value.bind(this)},enumerable:r,configurable:!1}):(n.enumerable=r,n.configurable=!1,n.writable&&(n.writable=!1),Object.defineProperty(i,t,n))}))})),i}function S(e,t){var n=(0,w.Zb)(function(e){return(0,h.q)(E,e,(()=>(0,w.cM)(k(e))))}(e),e,_.h.deepFreezeWhenDevMode(t));return e._runHooksSync("post","create",t,n),(0,b.Xi)("postCreateRxDocument",n),n}var x=n(1232),C=n(7092),O=n(2843),R=["pre","post"],I=["insert","save","remove","create"],P=!1,D=function(){function e(e,t,n,r,i={},o={},a={},s={},u={},c=v.Cx,l={},h=C.a){this.storageInstance={},this.timeouts=new Set,this.incrementalWriteQueue={},this._incrementalUpsertQueues=new Map,this.synced=!1,this.hooks={},this._subs=[],this._docCache={},this._queryCache=(0,v.XA)(),this.$={},this.checkpoint$={},this._changeEventBuffer={},this.onDestroy=[],this.destroyed=!1,this.database=e,this.name=t,this.schema=n,this.internalStorageInstance=r,this.instanceCreationOptions=i,this.migrationStrategies=o,this.methods=a,this.attachments=s,this.options=u,this.cacheReplacementPolicy=c,this.statics=l,this.conflictHandler=h,function(e){if(P)return;P=!0;var t=Object.getPrototypeOf(e);I.forEach((e=>{R.map((n=>{var r=n+(0,f.Z2)(e);t[r]=function(t,r){return this.addHook(n,e,t,r)}}))}))}(this.asRxCollection)}var t=e.prototype;return t.prepare=async function(){this.storageInstance=(0,x.AM)(this.database,this.internalStorageInstance,this.schema.jsonSchema),this.incrementalWriteQueue=new O.N6(this.storageInstance,this.schema.primaryPath,((e,t)=>(0,w.Lt)(this,e,t)),(e=>this._runHooks("post","save",e)));var e,t=this.database.eventBulks$.pipe((0,i.p)((e=>e.collectionName===this.name)));this.$=t.pipe((0,o.Z)((e=>e.events))),this.checkpoint$=t.pipe((0,a.T)((e=>e.checkpoint))),this._changeEventBuffer=(e=this.asRxCollection,new g(e)),this._docCache=new y.K(this.schema.primaryPath,this.$.pipe((0,i.p)((e=>!e.isLocal))),(e=>S(this.asRxCollection,e)));var n=await this.database.storageToken,r=this.storageInstance.changeStream().subscribe((e=>{var t={id:e.id,internal:!1,collectionName:this.name,storageToken:n,events:e.events.map((e=>(0,x.$I)(!1,e,this))),databaseToken:this.database.token,checkpoint:e.checkpoint,context:e.context,endTime:e.endTime,startTime:e.startTime};this.database.$emit(t)}));return this._subs.push(r),this._subs.push(this.storageInstance.conflictResultionTasks().subscribe((e=>{this.conflictHandler(e.input,e.context).then((t=>{this.storageInstance.resolveConflictResultionTask({id:e.id,output:t})}))}))),s.em},t.cleanup=function(e){throw(0,u.u)("cleanup")},t.migrationNeeded=function(){throw(0,u.u)("migration-schema")},t.getMigrationState=function(){throw(0,u.u)("migration-schema")},t.startMigration=function(e=10){return this.getMigrationState().startMigration(e)},t.migratePromise=function(e=10){return this.getMigrationState().migratePromise(e)},t.insert=async function(e){var t=await this.bulkInsert([e]),n=t.error[0];return(0,x.WX)(this,e[this.schema.primaryPath],e,n),(0,c.ZN)(t.success[0])},t.bulkInsert=async function(e){if(0===e.length)return{success:[],error:[]};var t=this.schema.primaryPath,n=e.map((e=>(0,d.JY)(this.schema,e))),r=this.hasHooks("pre","insert")?await Promise.all(n.map((e=>this._runHooks("pre","insert",e).then((()=>e))))):n,i=r.map((e=>({document:e}))),o=await this.storageInstance.bulkWrite(i,"rx-collection-bulk-insert"),a=(0,y.X)(this._docCache,o.success);if(this.hasHooks("post","insert")){var s=new Map;r.forEach((e=>{s.set(e[t],e)})),await Promise.all(a.map((e=>this._runHooks("post","insert",s.get(e.primary),e))))}return{success:a,error:o.error}},t.bulkRemove=async function(e){var t=this.schema.primaryPath;if(0===e.length)return{success:[],error:[]};var n=await this.findByIds(e).exec(),r=[],i=new Map;Array.from(n.values()).forEach((e=>{var t=e.toMutableJSON(!0);r.push(t),i.set(e.primary,t)})),await Promise.all(r.map((e=>{var t=e[this.schema.primaryPath];return this._runHooks("pre","remove",e,n.get(t))})));var o=r.map((e=>{var t=(0,l.FD)(e);return t._deleted=!0,{previous:e,document:t}})),a=await this.storageInstance.bulkWrite(o,"rx-collection-bulk-remove"),s=a.success.map((e=>e[t]));return await Promise.all(s.map((e=>this._runHooks("post","remove",i.get(e),n.get(e))))),{success:s.map((e=>(0,h.m)(n,e))),error:a.error}},t.bulkUpsert=async function(e){var t=[],n=new Map;e.forEach((e=>{var r=(0,d.JY)(this.schema,e),i=r[this.schema.primaryPath];if(!i)throw(0,m.Br)("COL3",{primaryPath:this.schema.primaryPath,data:r,schema:this.schema.jsonSchema});n.set(i,r),t.push(r)}));var r=await this.bulkInsert(t),i=r.success.slice(0),o=[];return await Promise.all(r.error.map((async e=>{if(409!==e.status)o.push(e);else{var t=e.documentId,r=(0,h.m)(n,t),a=(0,c.ZN)(e.documentInDb),s=this._docCache.getCachedRxDocument(a),u=await s.incrementalModify((()=>r));i.push(u)}}))),{error:o,success:i}},t.upsert=async function(e){var t=await this.bulkUpsert([e]);return(0,x.WX)(this.asRxCollection,e[this.schema.primaryPath],e,t.error[0]),t.success[0]},t.incrementalUpsert=function(e){var t=(0,d.JY)(this.schema,e),n=t[this.schema.primaryPath];if(!n)throw(0,m.Br)("COL4",{data:e});var r=this._incrementalUpsertQueues.get(n);return r||(r=s.em),r=r.then((()=>function(e,t,n){var r=e._docCache.getLatestDocumentDataIfExists(t);if(r)return Promise.resolve({doc:e._docCache.getCachedRxDocument(r),inserted:!1});return e.findOne(t).exec().then((t=>t?{doc:t,inserted:!1}:e.insert(n).then((e=>({doc:e,inserted:!0})))))}(this,n,t))).then((e=>e.inserted?e.doc:function(e,t){return e.incrementalModify((e=>t))}(e.doc,t))),this._incrementalUpsertQueues.set(n,r),r},t.find=function(e){if("string"==typeof e)throw(0,m.Br)("COL5",{queryObj:e});return e||(e=(0,p.XX)()),(0,p.nd)("find",e,this)},t.findOne=function(e){if("number"==typeof e||Array.isArray(e))throw(0,m.JX)("COL6",{queryObj:e});var t;if("string"==typeof e)t=(0,p.nd)("findOne",{selector:{[this.schema.primaryPath]:e},limit:1},this);else{if(e||(e=(0,p.XX)()),e.limit)throw(0,m.Br)("QU6");(e=(0,l.FD)(e)).limit=1,t=(0,p.nd)("findOne",e,this)}return t},t.count=function(e){return e||(e=(0,p.XX)()),(0,p.nd)("count",e,this)},t.findByIds=function(e){var t={selector:{[this.schema.primaryPath]:{$in:e.slice(0)}}};return(0,p.nd)("findByIds",t,this)},t.exportJSON=function(){throw(0,u.u)("json-dump")},t.importJSON=function(e){throw(0,u.u)("json-dump")},t.insertCRDT=function(e){throw(0,u.u)("crdt")},t.addHook=function(e,t,n,r=!1){if("function"!=typeof n)throw(0,m.JX)("COL7",{key:t,when:e});if(!R.includes(e))throw(0,m.JX)("COL8",{key:t,when:e});if(!I.includes(t))throw(0,m.Br)("COL9",{key:t});if("post"===e&&"create"===t&&!0===r)throw(0,m.Br)("COL10",{when:e,key:t,parallel:r});var i=n.bind(this),o=r?"parallel":"series";this.hooks[t]=this.hooks[t]||{},this.hooks[t][e]=this.hooks[t][e]||{series:[],parallel:[]},this.hooks[t][e][o].push(i)},t.getHooks=function(e,t){return this.hooks[t]&&this.hooks[t][e]?this.hooks[t][e]:{series:[],parallel:[]}},t.hasHooks=function(e,t){var n=this.getHooks(e,t);return!!n&&(n.series.length>0||n.parallel.length>0)},t._runHooks=function(e,t,n,r){var i=this.getHooks(e,t);if(!i)return s.em;var o=i.series.map((e=>()=>e(n,r)));return(0,s.h$)(o).then((()=>Promise.all(i.parallel.map((e=>e(n,r))))))},t._runHooksSync=function(e,t,n,r){var i=this.getHooks(e,t);i&&i.series.forEach((e=>e(n,r)))},t.promiseWait=function(e){return new Promise((t=>{var n=setTimeout((()=>{this.timeouts.delete(n),t()}),e);this.timeouts.add(n)}))},t.destroy=function(){return this.destroyed?s.Dr:(this.destroyed=!0,Array.from(this.timeouts).forEach((e=>clearTimeout(e))),this._changeEventBuffer&&this._changeEventBuffer.destroy(),this.database.requestIdlePromise().then((()=>Promise.all(this.onDestroy.map((e=>e()))))).then((()=>this.storageInstance.close())).then((()=>(this._subs.forEach((e=>e.unsubscribe())),delete this.database.collections[this.name],(0,b.FX)("postDestroyRxCollection",this).then((()=>!0))))))},t.remove=async function(){await this.destroy(),await(0,d.vM)(this.database.storage,this.database.internalStore,this.database.token,this.database.name,this.name,this.database.password,this.database.hashFunction)},(0,r.A)(e,[{key:"insert$",get:function(){return this.$.pipe((0,i.p)((e=>"INSERT"===e.operation)))}},{key:"update$",get:function(){return this.$.pipe((0,i.p)((e=>"UPDATE"===e.operation)))}},{key:"remove$",get:function(){return this.$.pipe((0,i.p)((e=>"DELETE"===e.operation)))}},{key:"asRxCollection",get:function(){return this}}])}();function T({database:e,name:t,schema:n,instanceCreationOptions:r={},migrationStrategies:i={},autoMigrate:o=!0,statics:a={},methods:u={},attachments:c={},options:l={},localDocuments:h=!1,cacheReplacementPolicy:f=v.Cx,conflictHandler:p=C.a}){var m={databaseInstanceToken:e.token,databaseName:e.name,collectionName:t,schema:n.jsonSchema,options:r,multiInstance:e.multiInstance,password:e.password,devMode:_.h.isDevMode()};return(0,b.Xi)("preCreateRxStorageInstance",m),(0,d.vK)(e,m).then((d=>{var m=new D(e,t,n,d,r,i,u,c,l,f,a,p);return m.prepare().then((()=>{Object.entries(a).forEach((([e,t])=>{Object.defineProperty(m,e,{get:()=>t.bind(m)})}));var e=s.em;return o&&0!==m.schema.version&&(e=m.migratePromise()),e})).then((()=>((0,b.Xi)("createRxCollection",{collection:m,creator:{name:t,schema:n,storageInstance:d,instanceCreationOptions:r,migrationStrategies:i,methods:u,attachments:c,options:l,cacheReplacementPolicy:f,localDocuments:h,statics:a}}),m))).catch((e=>d.close().then((()=>Promise.reject(e)))))}))}},467:(e,t,n)=>{"use strict";n.d(t,{CC:()=>d,Nu:()=>h,WY:()=>m,bV:()=>w,lz:()=>p,ol:()=>g,vV:()=>b});var r=n(6606),i=n(6143),o=n(1232),a=n(4815),s=n(3715),u=n(7494),c=n(2085),l=n(915),h="collection",f="storage-token",d=(0,i.Ud)({version:0,title:"RxInternalDocument",primaryKey:{key:"id",fields:["context","key"],separator:"|"},type:"object",properties:{id:{type:"string",maxLength:200},key:{type:"string"},context:{type:"string",enum:[h,f,"rx-migration-status","OTHER"]},data:{type:"object",additionalProperties:!0}},indexes:[],required:["key","context","data"],additionalProperties:!1,sharding:{shards:1,mode:"collection"}});function p(e,t){return(0,i.U)(d,{key:e,context:t})}async function m(e){var t=(0,l.Ib)(e.schema,{selector:{context:h,_deleted:{$eq:!1}},sort:[{id:"asc"}],skip:0});return(await e.query(t)).documents}var y="storageToken",v=p(y,f);async function g(e){var t=(0,a.z3)(10),n=e.password?await e.hashFunction(JSON.stringify(e.password)):void 0,i={id:v,context:f,key:y,data:{rxdbVersion:e.rxdbVersion,token:t,instanceToken:e.token,passwordHash:n},_deleted:!1,_meta:(0,s.o4)(),_rev:(0,s.Fq)(),_attachments:{}},o=await e.internalStore.bulkWrite([{document:i}],"internal-add-storage-token");if(o.success[0])return o.success[0];var c=(0,u.ZN)(o.error[0]);if(c.isError&&(0,r.sX)(c)){var l=c;if(!function(e,t){if(!e)return!1;if(t.includes("beta")&&t!==e)return!1;var n=e.split(".")[0],r=t.split(".")[0];if(n!==r)return!1;return!0}(l.documentInDb.data.rxdbVersion,e.rxdbVersion))throw(0,r.Br)("DM5",{args:{database:e.name,databaseStateVersion:l.documentInDb.data.rxdbVersion,codeVersion:e.rxdbVersion}});if(n&&n!==l.documentInDb.data.passwordHash)throw(0,r.Br)("DB1",{passwordHash:n,existingPasswordHash:l.documentInDb.data.passwordHash});var h=l.documentInDb;return(0,u.ZN)(h)}throw c}async function b(e,t,n){if(e.schema.version!==n.version)throw(0,r.Br)("SNH",{schema:n,version:e.schema.version,name:e.name,collection:e,args:{storageCollectionName:t}});for(var i=p(w(e.name,e.schema.jsonSchema),h);;){var a=await(0,o.O5)(e.database.internalStore,i),s=(0,c.o8)((0,u.ZN)(a));if(s.data.connectedStorages.find((e=>e.collectionName===t&&e.schema.version===n.version)))return;s.data.connectedStorages.push({collectionName:t,schema:n});try{await(0,o.mQ)(e.database.internalStore,{previous:(0,u.ZN)(a),document:s},"add-connected-storage-to-collection")}catch(e){if(!(0,r.sX)(e))throw e}}}function w(e,t){return e+"-"+t.version}},5131:(e,t,n)=>{"use strict";n.d(t,{lB:()=>O,uh:()=>I});var r=n(2212),i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this._parallels=e||1,this._qC=0,this._iC=new Set,this._lHN=0,this._hPM=new Map,this._pHM=new Map};function o(e,t){if(t){if(t._timeoutObj&&clearTimeout(t._timeoutObj),e._pHM.has(t)){var n=e._pHM.get(t);e._hPM.delete(n),e._pHM.delete(t)}e._iC.delete(t)}}function a(e){e._tryIR||0===e._iC.size||(e._tryIR=!0,setTimeout((function(){e.isIdle()?setTimeout((function(){e.isIdle()?(!function(e){0!==e._iC.size&&(e._iC.values().next().value._manRes(),setTimeout((function(){return a(e)}),0))}(e),e._tryIR=!1):e._tryIR=!1}),0):e._tryIR=!1}),0))}i.prototype={isIdle:function(){return this._qC<this._parallels},lock:function(){this._qC++},unlock:function(){this._qC--,a(this)},wrapCall:function(e){var t,n=this;this.lock();try{t=e()}catch(e){throw this.unlock(),e}return t.then&&"function"==typeof t.then?t.then((function(e){return n.unlock(),e})).catch((function(e){throw n.unlock(),e})):(this.unlock(),t)},requestIdlePromise:function(e){var t,n=this;e=e||{};var r=new Promise((function(e){return t=e}));if(r._manRes=function(){o(n,r),t()},e.timeout){var i=setTimeout((function(){r._manRes()}),e.timeout);r._timeoutObj=i}return this._iC.add(r),a(this),r},cancelIdlePromise:function(e){o(this,e)},requestIdleCallback:function(e,t){var n=this._lHN++,r=this.requestIdlePromise(t);return this._hPM.set(n,r),this._pHM.set(r,n),r.then((function(){return e()})),n},cancelIdleCallback:function(e){var t=this._hPM.get(e);this.cancelIdlePromise(t)},clear:function(){var e=this;this._iC.forEach((function(t){return o(e,t)})),this._qC=0,this._iC.clear(),this._hPM=new Map,this._pHM=new Map}};var s=n(4807),u=n(7205),c=n(3715),l=n(2085),h=n(7494),f=n(4034),d=n(2748),p=n(4815),m=n(6606),y=n(3907),v=n(337),g=n(7291),b=n(8452),w=n(7579),_=n(1232),E=n(1779),k=n(467),S=n(6377),x=n(2507),C=new Set,O=function(){function e(e,t,n,r,o,a,c=!1,l={},h,f,d,p,m){this.idleQueue=new i,this.rxdbVersion=s.o,this.storageInstances=new Set,this._subs=[],this.startupErrors=[],this.onDestroy=[],this.destroyed=!1,this.collections={},this.states={},this.eventBulks$=new g.B,this.observable$=this.eventBulks$.pipe((0,b.Z)((e=>e.events))),this.storageToken=u.Dr,this.storageTokenDocument=u.Dr,this.emittedEventBulkIds=new E.p4(6e4),this.name=e,this.token=t,this.storage=n,this.instanceCreationOptions=r,this.password=o,this.multiInstance=a,this.eventReduce=c,this.options=l,this.internalStore=h,this.hashFunction=f,this.cleanupPolicy=d,this.allowSlowCount=p,this.reactivity=m,"pseudoInstance"!==this.name&&(this.internalStore=(0,_.AM)(this.asRxDatabase,h,k.CC),this.storageTokenDocument=(0,k.ol)(this.asRxDatabase).catch((e=>this.startupErrors.push(e))),this.storageToken=this.storageTokenDocument.then((e=>e.data.token)).catch((e=>this.startupErrors.push(e))))}var t=e.prototype;return t.getReactivityFactory=function(){if(!this.reactivity)throw(0,m.Br)("DB14",{database:this.name});return this.reactivity},t.$emit=function(e){this.emittedEventBulkIds.has(e.id)||(this.emittedEventBulkIds.add(e.id),this.eventBulks$.next(e))},t.removeCollectionDoc=async function(e,t){var n=await(0,_.O5)(this.internalStore,(0,k.lz)((0,k.bV)(e,t),k.Nu));if(!n)throw(0,m.Br)("SNH",{name:e,schema:t});var r=(0,_.C9)(n);r._deleted=!0,await this.internalStore.bulkWrite([{document:r,previous:n}],"rx-database-remove-collection")},t.addCollections=async function(e){var t={},n={},r=[],i={};await Promise.all(Object.entries(e).map((async([e,o])=>{var a=e,s=o.schema;t[a]=s;var u=(0,y.Wq)(s,this.hashFunction);if(n[a]=u,this.collections[e])throw(0,m.Br)("DB3",{name:e});var h=(0,k.bV)(e,s),f={id:(0,k.lz)(h,k.Nu),key:h,context:k.Nu,data:{name:a,schemaHash:await u.hash,schema:u.jsonSchema,version:u.version,connectedStorages:[]},_deleted:!1,_meta:(0,c.o4)(),_rev:(0,c.Fq)(),_attachments:{}};r.push({document:f});var d=Object.assign({},o,{name:a,schema:u,database:this}),p=(0,l.FD)(o);p.database=this,p.name=e,(0,v.Xi)("preCreateRxCollection",p),d.conflictHandler=p.conflictHandler,i[a]=d})));var o=await this.internalStore.bulkWrite(r,"rx-database-add-collection");await async function(e){if(await e.storageToken,e.startupErrors[0])throw e.startupErrors[0]}(this),await Promise.all(o.error.map((async e=>{if(409!==e.status)throw(0,m.Br)("DB12",{database:this.name,writeError:e});var r=(0,h.ZN)(e.documentInDb),i=r.data.name,o=n[i];if(r.data.schemaHash!==await o.hash)throw(0,m.Br)("DB6",{database:this.name,collection:i,previousSchemaHash:r.data.schemaHash,schemaHash:await o.hash,previousSchema:r.data.schema,schema:(0,h.ZN)(t[i])})})));var a={};return await Promise.all(Object.keys(e).map((async e=>{var t=i[e],n=await(0,w.dN)(t);a[e]=n,this.collections[e]=n,this[e]||Object.defineProperty(this,e,{get:()=>this.collections[e]})}))),a},t.lockedRun=function(e){return this.idleQueue.wrapCall(e)},t.requestIdlePromise=function(){return this.idleQueue.requestIdlePromise()},t.exportJSON=function(e){throw(0,f.u)("json-dump")},t.addState=function(e){throw(0,f.u)("state")},t.importJSON=function(e){throw(0,f.u)("json-dump")},t.backup=function(e){throw(0,f.u)("backup")},t.leaderElector=function(){throw(0,f.u)("leader-election")},t.isLeader=function(){throw(0,f.u)("leader-election")},t.waitForLeadership=function(){throw(0,f.u)("leader-election")},t.migrationStates=function(){throw(0,f.u)("migration-schema")},t.destroy=async function(){return this.destroyed?u.Dr:(this.destroyed=!0,await(0,v.FX)("preDestroyRxDatabase",this),this.eventBulks$.complete(),this._subs.map((e=>e.unsubscribe())),"pseudoInstance"===this.name?u.Dr:this.requestIdlePromise().then((()=>Promise.all(this.onDestroy.map((e=>e()))))).then((()=>Promise.all(Object.keys(this.collections).map((e=>this.collections[e])).map((e=>e.destroy()))))).then((()=>this.internalStore.close())).then((()=>C.delete(this.storage.name+"|"+this.name))).then((()=>!0)))},t.remove=function(){return this.destroy().then((()=>async function(e,t,n){var r=(0,p.z3)(10),i=await R(r,t,e,{},!1,n),o=await(0,k.WY)(i),a=new Set;o.forEach((e=>a.add(e.data.name)));var s=Array.from(a);return await Promise.all(s.map((o=>(0,S.vM)(t,i,r,e,o,n)))),await(0,v.FX)("postRemoveRxDatabase",{databaseName:e,storage:t}),await i.remove(),s}(this.name,this.storage,this.password)))},(0,r.A)(e,[{key:"$",get:function(){return this.observable$}},{key:"asRxDatabase",get:function(){return this}}])}();async function R(e,t,n,r,i,o){return await t.createStorageInstance({databaseInstanceToken:e,databaseName:n,collectionName:_.OG,schema:k.CC,options:r,multiInstance:i,password:o,devMode:x.h.isDevMode()})}function I({storage:e,instanceCreationOptions:t,name:n,password:r,multiInstance:i=!0,eventReduce:o=!0,ignoreDuplicate:a=!1,options:s={},cleanupPolicy:u,allowSlowCount:c=!1,localDocuments:l=!1,hashFunction:h=d.V0,reactivity:f}){(0,v.Xi)("preCreateRxDatabase",{storage:e,instanceCreationOptions:t,name:n,password:r,multiInstance:i,eventReduce:o,ignoreDuplicate:a,options:s,localDocuments:l}),a||function(e,t){var n=t.name+"|"+e;if(C.has(n))throw(0,m.Br)("DB8",{name:e,storage:t.name,link:"https://rxdb.info/rx-database.html#ignoreduplicate"})}(n,e),C.add(e.name+"|"+n);var y=(0,p.z3)(10);return R(y,e,n,t,i,r).catch((t=>{throw C.delete(e.name+"|"+n),t})).then((d=>{var p=new O(n,y,e,t,r,i,o,s,d,h,u,c,f);return(0,v.FX)("createRxDatabase",{database:p,creator:{storage:e,instanceCreationOptions:t,name:n,password:r,multiInstance:i,eventReduce:o,ignoreDuplicate:a,options:s,localDocuments:l}}).then((()=>p))}))}},2497:(e,t,n)=>{"use strict";n.d(t,{Lt:()=>x,Zb:()=>S,cM:()=>k,ky:()=>E});var r=n(1160),i=n(6126),o=n(9050),a=n(1900),s=n(1636),u=n(7494),c=n(9101),l=n(7205),h=n(6250),f=n(2085),d=n(4815),p=n(4034),m=n(6606),y=n(337),v=n(6493),g=n(2507),b=n(6143),w=n(1232),_=n(2843),E={get primaryPath(){if(this.isInstanceOfRxDocument)return this.collection.schema.primaryPath},get primary(){var e=this;if(e.isInstanceOfRxDocument)return e._data[e.primaryPath]},get revision(){if(this.isInstanceOfRxDocument)return this._data._rev},get deleted$(){if(this.isInstanceOfRxDocument)return this.$.pipe((0,r.T)((e=>e._data._deleted)))},get deleted$$(){var e=this;return e.collection.database.getReactivityFactory().fromObservable(e.deleted$,e.getLatest().deleted,e.collection.database)},get deleted(){if(this.isInstanceOfRxDocument)return this._data._deleted},getLatest(){var e=this.collection._docCache.getLatestDocumentData(this.primary);return this.collection._docCache.getCachedRxDocument(e)},get $(){return this.collection.$.pipe((0,i.p)((e=>!e.isLocal)),(0,i.p)((e=>e.documentId===this.primary)),(0,r.T)((e=>(0,v.vk)(e))),(0,o.Z)(this.collection._docCache.getLatestDocumentData(this.primary)),(0,a.F)(((e,t)=>e._rev===t._rev)),(0,r.T)((e=>this.collection._docCache.getCachedRxDocument(e))),(0,s.t)(u.bz))},get $$(){var e=this;return e.collection.database.getReactivityFactory().fromObservable(e.$,e.getLatest()._data,e.collection.database)},get$(e){if(g.h.isDevMode()){if(e.includes(".item."))throw(0,m.Br)("DOC1",{path:e});if(e===this.primaryPath)throw(0,m.Br)("DOC2");if(this.collection.schema.finalFields.includes(e))throw(0,m.Br)("DOC3",{path:e});if(!(0,b.nT)(this.collection.schema.jsonSchema,e))throw(0,m.Br)("DOC4",{path:e})}return this.$.pipe((0,r.T)((t=>(0,c.UU)(t,e))),(0,a.F)())},get$$(e){var t=this.get$(e);return this.collection.database.getReactivityFactory().fromObservable(t,this.getLatest().get(e),this.collection.database)},populate(e){var t=(0,b.nT)(this.collection.schema.jsonSchema,e),n=this.get(e);if(!n)return l.$A;if(!t)throw(0,m.Br)("DOC5",{path:e});if(!t.ref)throw(0,m.Br)("DOC6",{path:e,schemaObj:t});var r=this.collection.database.collections[t.ref];if(!r)throw(0,m.Br)("DOC7",{ref:t.ref,path:e,schemaObj:t});return"array"===t.type?r.findByIds(n).exec().then((e=>{var t=e.values();return Array.from(t)})):r.findOne(n).exec()},get(e){return(0,h.q)(this._propertyCache,e,(()=>{var t=(0,c.UU)(this._data,e);if("object"!=typeof t||null===t||Array.isArray(t))return g.h.deepFreezeWhenDevMode(t);var n=this;return new Proxy((0,f.FD)(t),{get(t,r){if("string"!=typeof r)return t[r];var i=r.charAt(r.length-1);if(r.endsWith("$$")){var o=r.slice(0,-2);return n.get$$((0,d.L$)(e+"."+o))}if("$"===i){var a=r.slice(0,-1);return n.get$((0,d.L$)(e+"."+a))}if("_"===i){var s=r.slice(0,-1);return n.populate((0,d.L$)(e+"."+s))}return n.get((0,d.L$)(e+"."+r))}})}))},toJSON(e=!1){if(e)return g.h.deepFreezeWhenDevMode(this._data);var t=(0,f.FD)(this._data);return delete t._rev,delete t._attachments,delete t._deleted,delete t._meta,g.h.deepFreezeWhenDevMode(t)},toMutableJSON(e=!1){return(0,f.o8)(this.toJSON(e))},update(e){throw(0,p.u)("update")},incrementalUpdate(e){throw(0,p.u)("update")},updateCRDT(e){throw(0,p.u)("crdt")},putAttachment(){throw(0,p.u)("attachments")},getAttachment(){throw(0,p.u)("attachments")},allAttachments(){throw(0,p.u)("attachments")},get allAttachments$(){throw(0,p.u)("attachments")},async modify(e,t){var n=this._data,r=await(0,_.Hl)(e)(n);return this._saveData(r,n)},incrementalModify(e,t){return this.collection.incrementalWriteQueue.addWrite(this._data,(0,_.Hl)(e)).then((e=>this.collection._docCache.getCachedRxDocument(e)))},patch(e){var t=this._data,n=(0,f.o8)(t);return Object.entries(e).forEach((([e,t])=>{n[e]=t})),this._saveData(n,t)},incrementalPatch(e){return this.incrementalModify((t=>(Object.entries(e).forEach((([e,n])=>{t[e]=n})),t)))},async _saveData(e,t){if(e=(0,f.FD)(e),this._data._deleted)throw(0,m.Br)("DOC11",{id:this.primary,document:this});await x(this.collection,e,t);var n=await this.collection.storageInstance.bulkWrite([{previous:t,document:e}],"rx-document-save-data"),r=n.error[0];return(0,w.WX)(this.collection,this.primary,e,r),await this.collection._runHooks("post","save",e,this),this.collection._docCache.getCachedRxDocument(n.success[0])},remove(){var e=this.collection;if(this.deleted)return Promise.reject((0,m.Br)("DOC13",{document:this,id:this.primary}));var t,n=(0,f.FD)(this._data);return e._runHooks("pre","remove",n,this).then((async()=>{n._deleted=!0;var t=await e.storageInstance.bulkWrite([{previous:this._data,document:n}],"rx-document-remove"),r=t.error[0];return(0,w.WX)(e,this.primary,n,r),t.success[0]})).then((e=>(t=e,this.collection._runHooks("post","remove",n,this)))).then((()=>this.collection._docCache.getCachedRxDocument(t)))},incrementalRemove(){return this.incrementalModify((async e=>(await this.collection._runHooks("pre","remove",e,this),e._deleted=!0,e))).then((async e=>(await this.collection._runHooks("post","remove",e._data,e),e)))},destroy(){throw(0,m.Br)("DOC14")}};function k(e=E){var t=function(e,t){this.collection=e,this._data=t,this._propertyCache=new Map,this.isInstanceOfRxDocument=!0};return t.prototype=e,t}function S(e,t,n){var r=new e(t,n);return(0,y.Xi)("createRxDocument",r),r}function x(e,t,n){return t._meta=Object.assign({},n._meta,t._meta),g.h.isDevMode()&&e.schema.validateChange(n,t),e._runHooks("pre","save",t,n)}},6606:(e,t,n)=>{"use strict";n.d(t,{sX:()=>m,Br:()=>d,JX:()=>p,cg:()=>v});var r=n(2212);function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function o(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,i(e,t)}function a(e){return a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},a(e)}function s(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(s=function(){return!!e})()}function u(e){var t="function"==typeof Map?new Map:void 0;return u=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return function(e,t,n){if(s())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var o=new(e.bind.apply(e,r));return n&&i(o,n.prototype),o}(e,arguments,a(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),i(n,e)},u(e)}var c=n(2507);function l(e,t,n){return"RxError ("+t+"):\n"+e+"\n"+function(e){var t="";return 0===Object.keys(e).length?t:(t+="Given parameters: {\n",t+=Object.keys(e).map((t=>{var n="[object Object]";try{n="errors"===t?e[t].map((e=>JSON.stringify(e,Object.getOwnPropertyNames(e)))):JSON.stringify(e[t],(function(e,t){return void 0===t?null:t}),2)}catch(e){}return t+":"+n})).join("\n"),t+="}")}(n)}var h=function(e){function t(t,n,r={}){var i,o=l(n,t,r);return(i=e.call(this,o)||this).code=t,i.message=o,i.parameters=r,i.rxdb=!0,i}return o(t,e),t.prototype.toString=function(){return this.message},(0,r.A)(t,[{key:"name",get:function(){return"RxError ("+this.code+")"}},{key:"typeError",get:function(){return!1}}])}(u(Error)),f=function(e){function t(t,n,r={}){var i,o=l(n,t,r);return(i=e.call(this,o)||this).code=t,i.message=o,i.parameters=r,i.rxdb=!0,i}return o(t,e),t.prototype.toString=function(){return this.message},(0,r.A)(t,[{key:"name",get:function(){return"RxTypeError ("+this.code+")"}},{key:"typeError",get:function(){return!0}}])}(u(TypeError));function d(e,t){return new h(e,c.h.tunnelErrorMessage(e),t)}function p(e,t){return new f(e,c.h.tunnelErrorMessage(e),t)}function m(e){return!(!e||409!==e.status)&&e}var y={409:"document write conflict",422:"schema validation error",510:"attachment data missing"};function v(e){return d("COL20",{name:y[e.status],document:e.documentId,writeError:e})}},1845:(e,t,n)=>{"use strict";n.d(t,{Lr:()=>Pt,Xw:()=>It,_V:()=>Rt});var r=n(3040),i=n(6143),o=n(2085),a=n(2217);class s extends Error{}const u=Number.MAX_SAFE_INTEGER,c=Number.MIN_SAFE_INTEGER,l=Symbol("missing"),h=Object.freeze(new Error("mingo: cycle detected while processing object/array")),f=Object.getPrototypeOf([]),d=Object.getPrototypeOf({}),p=/^\[object ([a-zA-Z0-9]+)\]$/;class m{}class y{}const v=e=>null===e?m:void 0===e?y:e.constructor,g=e=>{const t=function(e){const t=new Set,n=e=>{const r=v(e);if(k.has(r))return k.get(r)(e);const i=r===Object?"":r.name;if(B(e.toJSON))return`${i}(${JSON.stringify(e)})`;if(t.has(e))throw h;t.add(e);try{if(r===Array)return"["+e.map(n).join(",")+"]";if(r!==Object){const[t,r]=Y(e);if(T(e))return`${i}${n([...e,t])}`;e=t}const t=Object.keys(e);return t.sort(),`${i}{`+t.map((t=>`${t}:${n(e[t])}`)).join(",")+"}"}finally{t.delete(e)}};return n(e)}(e);let n=0,r=t.length;for(;r;)n=(n<<5)-n^t.charCodeAt(--r);return n>>>0},b=new Set(["null","undefined","boolean","number","string","date","regexp"]),w=new Set([y,m,Boolean,String,Number]),_=e=>e.toString(),E=e=>`${v(e).name}[${e.toString()}]`,k=new Map([[Number,_],[Boolean,_],[RegExp,_],[Function,_],[Symbol,_],[Date,e=>e.toISOString()],[String,JSON.stringify],[m,e=>"null"],[y,e=>"undefined"],[Int8Array,E],[Uint8Array,E],[Uint8ClampedArray,E],[Int16Array,E],[Uint16Array,E],[Int32Array,E],[Uint32Array,E],[Float32Array,E],[Float64Array,E]]);"undefined"!=typeof BigInt&&k.set(BigInt,(e=>"0x"+e.toString(16))),"undefined"!=typeof BigInt64Array&&k.set(BigInt64Array,E),"undefined"!=typeof BigUint64Array&&k.set(BigUint64Array,E);const S={null:0,undefined:0,number:1,string:2,object:3,array:4,boolean:5,date:6,regexp:7,function:8},x=(e,t)=>{e===l&&(e=void 0),t===l&&(t=void 0);const[n,r]=[e,t].map((e=>S[R(e).toLowerCase()]));return n!==r?n-r:1===n||2===n||6===n?e<t?-1:e>t?1:0:Z(e,t)?0:e<t?-1:e>t?1:0};function C(e,t){if(!e)throw new s(t)}const O=e=>{if(w.has(v(e)))return e;const t=new Set,n=e=>{if(t.has(e))throw h;const r=v(e);if(w.has(r))return e;try{if(T(e))return t.add(e),e.map(n);if(A(e)){t.add(e);const r={};for(const t in e)r[t]=n(e[t]);return r}}finally{t.delete(e)}return r===Date||r===RegExp||(e=>{const t=Object.getPrototypeOf(v(e));return t&&"TypedArray"===t.name})(e)?new r(e):e};return n(e)},R=e=>p.exec(Object.prototype.toString.call(e))[1],I=e=>"boolean"==typeof e,P=e=>"string"==typeof e,D=e=>!isNaN(e)&&"number"==typeof e,T=Array.isArray,A=e=>{if(!e)return!1;const t=Object.getPrototypeOf(e);return(t===d||null===t)&&"[object Object]"===Object.prototype.toString.call(e)},j=e=>e===Object(e),N=e=>e instanceof Date,M=e=>e instanceof RegExp,B=e=>"function"==typeof e,L=e=>null==e,F=(e,t)=>e.includes(t),q=(e,t)=>!F(e,t),$=e=>L(e)||P(e)&&!e||e instanceof Array&&0===e.length||A(e)&&0===Object.keys(e).length,U=e=>e===l,K=e=>e instanceof Array?e:[e],W=(e,t)=>!!e&&Object.prototype.hasOwnProperty.call(e,t),H=(e,t)=>A(e)&&A(t)||T(e)&&T(t);function z(e,t,n){if(n=n||{flatten:!1},U(e)||L(e))return t;if(U(t)||L(t))return e;if(!H(e,t)){if(n.skipValidation)return t||e;throw Error("mismatched types. must both be array or object")}if(n.skipValidation=!0,T(e)){const r=e,i=t;if(n.flatten){let e=0,o=0;for(;e<r.length&&o<i.length;)r[e]=z(r[e++],i[o++],n);for(;o<i.length;)r.push(t[o++])}else te(r,i)}else for(const r in t)e[r]=z(e[r],t[r],n);return e}function Q(e,t=g){const n=new Map;return e.forEach(((r,i)=>{const o=J(r,t);n.has(o)?n.get(o).some((t=>Z(e[t],r)))||n.get(o).push(i):n.set(o,[i])})),n}function V(e,t=g){if(e.some((e=>0==e.length)))return[];if(1===e.length)return Array.from(e);const n=function(e,t,n=x){if($(e))return e;const r=new Array,i=new Array;for(let n=0;n<e.length;n++){const o=e[n],a=t(o,n);L(a)?i.push(o):r.push([a,o])}return r.sort(((e,t)=>n(e[0],t[0]))),te(i,r.map((e=>e[1])))}(e.map(((e,t)=>[t,e.length])),(e=>e[1])),r=e[n[0][0]],i=Q(r,t),o=new Map,a=new Array;return i.forEach(((t,i)=>{const s=t.map((e=>r[e])),u=s.map((e=>0)),c=s.map((e=>[n[0][0],0]));let h=!1;for(let t=1;t<e.length;t++){const[r,a]=n[t],l=e[r];if(o.has(t)||o.set(t,Q(l)),o.get(t).has(i)){const e=o.get(t).get(i).map((e=>l[e]));h=s.map(((n,a)=>e.some(((e,s)=>{const l=u[a];return Z(n,e)&&(u[a]++,r<c[a][0]&&(c[a]=[r,o.get(t).get(i)[s]])),l<u[a]})))).some(Boolean)}if(!h)return}h&&te(a,u.map(((t,n)=>t===e.length-1?[s[n],c[n]]:l)).filter((e=>e!==l)))})),a.sort(((e,t)=>{const[n,[r,i]]=e,[o,[a,s]]=t,u=x(r,a);return 0!==u?u:x(i,s)})).map((e=>e[0]))}function X(e,t=0){const n=new Array;return function e(t,r){for(let i=0,o=t.length;i<o;i++)T(t[i])&&(r>0||r<0)?e(t[i],Math.max(-1,r-1)):n.push(t[i])}(e,t),n}const Y=e=>{let[t,n]=[Object.getPrototypeOf(e),Object.getOwnPropertyNames(e)],r=t;for(;!n.length&&t!==d&&t!==f;)r=t,n=Object.getOwnPropertyNames(t),t=Object.getPrototypeOf(t);const i={};return n.forEach((t=>i[t]=e[t])),[i,r]};function Z(e,t){const n=[[e,t]];for(;n.length>0;){if([e,t]=n.pop(),e===t)continue;const r=v(e);if(r!==v(t)||B(e))return!1;if(k.has(r)){const n=k.get(r);if(n(e)!==n(t))return!1}else{if(r!==Array&&r!==Object)return!1;{const r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;if(new Set(r.concat(i)).size!=r.length)return!1;for(const i of r)n.push([e[i],t[i]])}}}return!n.length}function J(e,t){return t=t||g,L(e)?null:t(e).toString()}function G(e,t,n=g){if(e.length<1)return new Map;const r=new Map,i=new Map;for(let o=0;o<e.length;o++){const a=e[o],s=t(a,o),u=J(s,n);if(null===u)i.has(null)?i.get(null).push(a):i.set(null,[a]);else{const e=r.has(u)?r.get(u).find((e=>Z(e,s))):null;L(e)?(i.set(s,[a]),r.has(u)?r.get(u).push(s):r.set(u,[s])):i.get(e).push(a)}}return i}const ee=5e4;function te(e,...t){return e instanceof Array?t.reduce(((e,t)=>{let n=Math.ceil(t.length/ee),r=0;for(;n-- >0;)Array.prototype.push.apply(e,t.slice(r,r+ee)),r+=ee;return e}),e):t.filter(j).reduce(((e,t)=>(Object.assign(e,t),e)),e)}function ne(e,t){return j(e)?e[t]:void 0}function re(e,t,n){let r=0;const i=b.has(R(e).toLowerCase())?e:function e(t,n){let i=t;for(let t=0;t<n.length;t++){const o=n[t];if(null===/^\d+$/.exec(o)&&i instanceof Array){if(0===t&&r>0)break;r+=1;const o=n.slice(t);i=i.reduce(((t,n)=>{const r=e(n,o);return void 0!==r&&t.push(r),t}),[]);break}if(i=ne(i,o),void 0===i)break}return i}(e,t.split("."));return i instanceof Array&&(null==n?void 0:n.unwrapArray)?function(e,t){if(t<1)return e;for(;t--&&1===e.length;)e=e[0];return e}(i,r):i}function ie(e,t,n){const r=t.split("."),i=r[0],o=r.slice(1).join("."),a=null!==/^\d+$/.exec(i),s=r.length>1;let u,c;if(e instanceof Array)if(a)u=ne(e,Number(i)),s&&(u=ie(u,o,n)),u=[u];else{u=[];for(const r of e)c=ie(r,t,n),(null==n?void 0:n.preserveMissing)?(void 0===c&&(c=l),u.push(c)):void 0!==c&&u.push(c)}else{if(c=ne(e,i),s&&(c=ie(c,o,n)),void 0===c)return;u=(null==n?void 0:n.preserveKeys)?Object.assign({},e):{},u[i]=c}return u}function oe(e){if(e instanceof Array)for(let t=e.length-1;t>=0;t--)e[t]===l?e.splice(t,1):oe(e[t]);else if(A(e))for(const t in e)W(e,t)&&oe(e[t])}const ae=/^\d+$/;function se(e,t,n,r){const i=t.split("."),o=i[0],a=i.slice(1).join(".");if(1===i.length)(A(e)||T(e)&&ae.test(o))&&n(e,o);else{(null==r?void 0:r.buildGraph)&&L(e[o])&&(e[o]={});const t=e[o];if(!t)return;const s=!!(i.length>1&&ae.test(i[1]));t instanceof Array&&(null==r?void 0:r.descendArray)&&!s?t.forEach((e=>se(e,a,n,r))):se(t,a,n,r)}}function ue(e,t,n){se(e,t,((e,t)=>{e[t]=B(n)?n(e[t]):n}),{buildGraph:!0})}function ce(e,t,n){se(e,t,((e,t)=>{if(e instanceof Array){if(/^\d+$/.test(t))e.splice(parseInt(t),1);else if(n&&n.descendArray)for(const n of e)A(n)&&delete n[t]}else A(e)&&delete e[t]}),n)}const le=/^\$[a-zA-Z0-9_]+$/;function he(e){return le.test(e)}function fe(e){if(b.has(R(e).toLowerCase()))return M(e)?{$regex:e}:{$eq:e};if(j(e)){const t=e;if(!Object.keys(t).some(he))return{$eq:e};if(W(e,"$regex")){const t=Object.assign({},e);return t.$regex=new RegExp(e.$regex,e.$options),delete t.$options,t}}return e}var de,pe,me=n(6606);!function(e){e.CLONE_ALL="CLONE_ALL",e.CLONE_INPUT="CLONE_INPUT",e.CLONE_OUTPUT="CLONE_OUTPUT",e.CLONE_OFF="CLONE_OFF"}(de||(de={}));class ye{constructor(e,t,n,r=Date.now()){this._opts=e,this._root=t,this._local=n,this.timestamp=r,this.update(t,n)}static init(e,t,n){return e instanceof ye?new ye(e._opts,L(e.root)?t:e.root,Object.assign({},e.local,n)):new ye(e,t,n)}update(e,t){var n;return this._root=e,this._local=t?Object.assign({},t,{variables:Object.assign({},null===(n=this._local)||void 0===n?void 0:n.variables,null==t?void 0:t.variables)}):t,this}getOptions(){return Object.freeze(Object.assign(Object.assign({},this._opts),{context:ge.from(this._opts.context)}))}get root(){return this._root}get local(){return this._local}get idKey(){return this._opts.idKey}get collation(){var e;return null===(e=this._opts)||void 0===e?void 0:e.collation}get processingMode(){var e;return(null===(e=this._opts)||void 0===e?void 0:e.processingMode)||de.CLONE_OFF}get useStrictMode(){var e;return null===(e=this._opts)||void 0===e?void 0:e.useStrictMode}get scriptEnabled(){var e;return null===(e=this._opts)||void 0===e?void 0:e.scriptEnabled}get useGlobalContext(){var e;return null===(e=this._opts)||void 0===e?void 0:e.useGlobalContext}get hashFunction(){var e;return null===(e=this._opts)||void 0===e?void 0:e.hashFunction}get collectionResolver(){var e;return null===(e=this._opts)||void 0===e?void 0:e.collectionResolver}get jsonSchemaValidator(){var e;return null===(e=this._opts)||void 0===e?void 0:e.jsonSchemaValidator}get variables(){var e;return null===(e=this._opts)||void 0===e?void 0:e.variables}get context(){var e;return null===(e=this._opts)||void 0===e?void 0:e.context}}function ve(e){return e instanceof ye?e.getOptions():Object.freeze(Object.assign(Object.assign({idKey:"_id",scriptEnabled:!0,useStrictMode:!0,useGlobalContext:!0,processingMode:de.CLONE_OFF},e),{context:(null==e?void 0:e.context)?ge.from(null==e?void 0:e.context):ge.init({})}))}!function(e){e.ACCUMULATOR="accumulator",e.EXPRESSION="expression",e.PIPELINE="pipeline",e.PROJECTION="projection",e.QUERY="query",e.WINDOW="window"}(pe||(pe={}));class ge{constructor(e){this.operators={[pe.ACCUMULATOR]:{},[pe.EXPRESSION]:{},[pe.PIPELINE]:{},[pe.PROJECTION]:{},[pe.QUERY]:{},[pe.WINDOW]:{}};for(const[t,n]of Object.entries(e))this.addOperators(t,n)}static init(e={}){return new ge(e)}static from(e){return new ge(e.operators)}addOperators(e,t){for(const[n,r]of Object.entries(t))this.getOperator(e,n)||(this.operators[e][n]=r);return this}addAccumulatorOps(e){return this.addOperators(pe.ACCUMULATOR,e)}addExpressionOps(e){return this.addOperators(pe.EXPRESSION,e)}addQueryOps(e){return this.addOperators(pe.QUERY,e)}addPipelineOps(e){return this.addOperators(pe.PIPELINE,e)}addProjectionOps(e){return this.addOperators(pe.PROJECTION,e)}addWindowOps(e){return this.addOperators(pe.WINDOW,e)}getOperator(e,t){return e in this.operators&&this.operators[e][t]||null}}const be=ge.init();function we(e,t){for(const[n,r]of Object.entries(t)){C(B(r)&&he(n),`'${n}' is not a valid operator`);const t=_e(e,n,null);C(!t||r===t,`${n} already exists for '${e}' operators. Cannot change operator function once registered.`)}switch(e){case pe.ACCUMULATOR:be.addAccumulatorOps(t);break;case pe.EXPRESSION:be.addExpressionOps(t);break;case pe.PIPELINE:be.addPipelineOps(t);break;case pe.PROJECTION:be.addProjectionOps(t);break;case pe.QUERY:be.addQueryOps(t);break;case pe.WINDOW:be.addWindowOps(t)}}function _e(e,t,n){const{context:r,useGlobalContext:i}=n||{},o=r?r.getOperator(e,t):null;return!o&&i?be.getOperator(e,t):o}const Ee={$$ROOT:(e,t,n)=>n.root,$$CURRENT:(e,t,n)=>e,$$REMOVE(e,t,n){},$$NOW:(e,t,n)=>new Date(n.timestamp)},ke={$$KEEP:(e,t,n)=>e,$$PRUNE(e,t,n){},$$DESCEND(e,t,n){if(!W(t,"$cond"))return e;let r;for(const[i,o]of Object.entries(e))if(j(o)){if(o instanceof Array){const e=[];for(let r of o)A(r)&&(r=xe(r,t,n.update(r))),L(r)||e.push(r);r=e}else r=xe(o,t,n.update(o));L(r)?delete e[i]:e[i]=r}return e}};function Se(e,t,n,r){var i;const o=ye.init(r,e);if(he(n=n||"")){const i=_e(pe.EXPRESSION,n,r);if(i)return i(e,t,o);const a=_e(pe.ACCUMULATOR,n,r);if(a)return e instanceof Array||(e=Se(e,t,null,o),t=null),C(e instanceof Array,`'${n}' target must be an array.`),a(e,t,o.update(null,o.local));throw new s(`operator '${n}' is not registered`)}if(P(t)&&t.length>0&&"$"===t[0]){if(W(ke,t))return t;let n=o.root;const r=t.split(".");if(W(Ee,r[0]))n=Ee[r[0]](e,null,o),t=t.slice(r[0].length+1);else if("$$"===r[0].slice(0,2)){n=Object.assign({},o.variables,{this:e},null===(i=o.local)||void 0===i?void 0:i.variables);const a=r[0].slice(2);C(W(n,a),`Use of undefined variable: ${a}`),t=t.slice(2)}else t=t.slice(1);return""===t?n:re(n,t)}if(T(t))return t.map((t=>Se(e,t,null,o)));if(A(t)){const n={};for(const[i,a]of Object.entries(t))if(n[i]=Se(e,a,i,o),[pe.EXPRESSION,pe.ACCUMULATOR].some((e=>!!_e(e,i,r))))return C(1===Object.keys(t).length,"Invalid aggregation expression '"+JSON.stringify(t)+"'"),n[i];return n}return t}function xe(e,t,n){const r=Se(e,t,null,n);return W(ke,r)?ke[r](e,t,n):r}function Ce(e){return e instanceof Pe?e:new Pe(e)}function Oe(e,t){const n=e.slice(t+1);e.splice(t),Array.prototype.push.apply(e,n)}const Re=new Error;var Ie;!function(e){e[e.MAP=0]="MAP",e[e.FILTER=1]="FILTER",e[e.TAKE=2]="TAKE",e[e.DROP=3]="DROP"}(Ie||(Ie={}));class Pe{constructor(e){let t;if(this.iteratees=[],this.yieldedValues=[],this.isDone=!1,e instanceof Function&&(e={next:e}),(n=e)&&"object"==typeof n&&(null==n?void 0:n.next)instanceof Function){const n=e;t=()=>{const e=n.next();if(e.done)throw Re;return e.value}}else if(e instanceof Array){const n=e,r=n.length;let i=0;t=()=>{if(i<r)return n[i++];throw Re}}else if(!(e instanceof Function))throw new s("Lazy must be initialized with an array, generator, or function.");var n;this.getNext=function(e,t,n){let r=!1,i=-1,o=0;return function(a){try{e:for(;!r;){let s=e();i++;let u=-1;const c=t.length;let l=!1;for(;++u<c;){const e=t[u];switch(e.action){case Ie.MAP:s=e.func(s,i);break;case Ie.FILTER:if(!e.func(s,i))continue e;break;case Ie.TAKE:--e.count,e.count||(l=!0);break;case Ie.DROP:--e.count,e.count||Oe(t,u);continue e;default:break e}}if(r=l,!a)return{value:s,done:!1};n[o++]=s}}catch(e){if(e!==Re)throw e}return r=!0,{done:r}}}(t,this.iteratees,this.yieldedValues)}push(e,t){return"function"==typeof t?this.iteratees.push({action:e,func:t}):"number"==typeof t&&this.iteratees.push({action:e,count:t}),this}next(){return this.getNext()}map(e){return this.push(Ie.MAP,e)}filter(e){return this.push(Ie.FILTER,e)}take(e){return e>0?this.push(Ie.TAKE,e):this}drop(e){return e>0?this.push(Ie.DROP,e):this}transform(e){const t=this;let n;return Ce((()=>(n||(n=Ce(e(t.value()))),n.next())))}value(){return this.isDone||(this.isDone=this.getNext(!0).done),this.yieldedValues}each(e){for(;;){const t=this.next();if(t.done)break;if(!1===e(t.value))return!1}return!0}reduce(e,t){let n=this.next();for(void 0!==t||n.done||(t=n.value,n=this.next());!n.done;)t=e(t,n.value),n=this.next();return t}size(){return this.reduce(((e,t)=>++e),0)}[Symbol.iterator](){return this}}class De{constructor(e,t){this.pipeline=e,this.options=ve(t)}stream(e){let t=Ce(e);const n=this.options.processingMode;n!=de.CLONE_ALL&&n!=de.CLONE_INPUT||t.map(O);const r=new Array;if(!$(this.pipeline))for(const e of this.pipeline){const n=Object.keys(e),i=n[0],o=_e(pe.PIPELINE,i,this.options);C(1===n.length&&!!o,`invalid pipeline operator ${i}`),r.push(i),t=o(t,e[i],this.options)}return(n==de.CLONE_OUTPUT||n==de.CLONE_ALL&&V([["$group","$unwind"],r]).length)&&t.map(O),t}run(e){return this.stream(e).value()}}class Te{constructor(e,t,n,r){this.source=e,this.predicate=t,this.projection=n,this.options=r,this.operators=[],this.result=null,this.buffer=[]}fetch(){return this.result||(A(this.projection)&&this.operators.push({$project:this.projection}),this.result=Ce(this.source).filter(this.predicate),this.operators.length>0&&(this.result=new De(this.operators,this.options).stream(this.result))),this.result}fetchAll(){const e=Ce([...this.buffer]);return this.buffer=[],function(...e){let t=0;return Ce((()=>{for(;t<e.length;){const n=e[t].next();if(!n.done)return n;t++}return{done:!0}}))}(e,this.fetch())}all(){return this.fetchAll().value()}count(){return this.all().length}skip(e){return this.operators.push({$skip:e}),this}limit(e){return this.operators.push({$limit:e}),this}sort(e){return this.operators.push({$sort:e}),this}collation(e){return this.options=Object.assign(Object.assign({},this.options),{collation:e}),this}next(){if(this.buffer.length>0)return this.buffer.pop();const e=this.fetch().next();return e.done?void 0:e.value}hasNext(){if(this.buffer.length>0)return!0;const e=this.fetch().next();return!e.done&&(this.buffer.push(e.value),!0)}map(e){return this.all().map(e)}forEach(e){this.all().forEach(e)}[Symbol.iterator](){return this.fetchAll()}}class Ae{constructor(e,t){this.condition=e,this.options=ve(t),this.compiled=[],this.compile()}compile(){C(A(this.condition),`query criteria must be an object: ${JSON.stringify(this.condition)}`);const e={};for(const[t,n]of Object.entries(this.condition)){if("$where"===t)Object.assign(e,{field:t,expr:n});else if(F(["$and","$or","$nor","$expr","$jsonSchema"],t))this.processOperator(t,t,n);else{C(!he(t),`unknown top level operator: ${t}`);for(const[e,r]of Object.entries(fe(n)))this.processOperator(t,e,r)}e.field&&this.processOperator(e.field,e.field,e.expr)}}processOperator(e,t,n){const r=_e(pe.QUERY,t,this.options);if(!r)throw new s(`unknown query operator ${t}`);const i=r(e,n,this.options);this.compiled.push(i)}test(e){for(let t=0,n=this.compiled.length;t<n;t++)if(!this.compiled[t](e))return!1;return!0}find(e,t){return new Te(e,(e=>this.test(e)),t||{},this.options)}remove(e){return e.reduce(((e,t)=>(this.test(t)||e.push(t),e)),[])}}new WeakMap;const je=(e,t,n)=>{if($(t)||!A(t))return e;let r=x;const i=n.collation;return A(i)&&P(i.locale)&&(r=function(e){const t={sensitivity:Ne[e.strength||3],caseFirst:"off"===e.caseFirst?"false":e.caseFirst||"false",numeric:e.numericOrdering||!1,ignorePunctuation:"shifted"===e.alternate};!0===(e.caseLevel||!1)&&("base"===t.sensitivity&&(t.sensitivity="case"),"accent"===t.sensitivity&&(t.sensitivity="variant"));const n=new Intl.Collator(e.locale,t);return(e,t)=>{if(!P(e)||!P(t))return x(e,t);const r=n.compare(e,t);return r<0?-1:r>0?1:0}}(i)),e.transform((e=>{const i=Object.keys(t);for(const o of i.reverse()){const i=G(e,(e=>re(e,o)),n.hashFunction),a=Array.from(i.keys()).sort(r);-1===t[o]&&a.reverse(),e=[],a.reduce(((e,t)=>te(e,i.get(t))),e)}return e}))},Ne={1:"base",2:"accent",3:"variant"};new Set(["$denseRank","$documentNumber","$first","$last","$linearFill","$rank","$shift"]),new Set(["$denseRank","$expMovingAvg","$linearFill","$locf","$rank","$shift"]);function Me(e){const t=(t,n,r)=>{const i={unwrapArray:!0},o=Math.max(1,t.split(".").length-1);return a=>{const s=re(a,t,i);return e(s,n,Object.assign(Object.assign({},r),{depth:o}))}};return t.op="query",t}function Be(e){return(t,n,r)=>{const i=Se(t,n,null,r);return e(...i)}}function Le(e,t,n){if(Z(e,t))return!0;if(L(e)&&L(t))return!0;if(e instanceof Array){const r=Z.bind(null,t);return e.some(r)||X(e,null==n?void 0:n.depth).some(r)}return!1}function Fe(e,t,n){return!Le(e,t,n)}function qe(e,t,n){return L(e)?t.some((e=>null===e)):V([K(e),t],null==n?void 0:n.hashFunction).length>0}function $e(e,t,n){return!qe(e,t,n)}function Ue(e,t,n){return Ge(e,t,((e,t)=>x(e,t)<0))}function Ke(e,t,n){return Ge(e,t,((e,t)=>x(e,t)<=0))}function We(e,t,n){return Ge(e,t,((e,t)=>x(e,t)>0))}function He(e,t,n){return Ge(e,t,((e,t)=>x(e,t)>=0))}function ze(e){return he(e)&&-1===["$and","$or","$nor"].indexOf(e)}function Qe(e,t,n){if(T(e)&&!$(e)){let r=e=>e,i=t;Object.keys(t).every(ze)&&(i={temp:t},r=e=>({temp:e}));const o=new Ae(i,n);for(let t=0,n=e.length;t<n;t++)if(o.test(r(e[t])))return!0}return!1}const Ve=e=>null===e,Xe=e=>D(e)&&e>=-2147483648&&e<=2147483647&&-1===e.toString().indexOf("."),Ye=e=>D(e)&&e>=c&&e<=u&&-1===e.toString().indexOf("."),Ze={array:T,bool:I,boolean:I,date:N,decimal:D,double:D,int:Xe,long:Ye,number:D,null:Ve,object:A,regex:M,regexp:M,string:P,undefined:L,function:e=>{throw new s("unsupported type key `function`.")},1:D,2:P,3:A,4:T,6:L,8:I,9:N,10:Ve,11:M,16:Xe,18:Ye,19:D};function Je(e,t,n){const r=Ze[t];return!!r&&r(e)}function Ge(e,t,n){return K(e).some((e=>R(e)===R(t)&&n(e,t)))}Be($e);const et=(e,t)=>(n,r,i)=>{C(T(r),`${e}: expression must be an array.`);const o=Se(n,r,null,i);return o.some(L)?null:(C(o.every(D),`${e}: expression must evalue to array of numbers.`),t(o))};et("$bitAnd",(e=>e.reduce(((e,t)=>e&t),-1))),et("$bitOr",(e=>e.reduce(((e,t)=>e|t),0))),et("$bitXor",(e=>e.reduce(((e,t)=>e^t),0))),Be(Le),Be(We),Be(He),Be(Ue),Be(Ke),Be(Fe);const tt=(e,t)=>{const n={};return e.split("").forEach(((e,r)=>n[e]=t*(r+1))),n};Object.assign(Object.assign(Object.assign({},tt("ABCDEFGHIKLM",1)),tt("NOPQRSTUVWXY",-1)),{Z:0});const nt={undefined:null,null:null,NaN:NaN,Infinity:new Error,"-Infinity":new Error};function rt(e,t=nt){const n=Object.assign({},nt,t),r=new Set(Object.keys(n));return(t,i,o)=>{const a=Se(t,i,null,o);if(r.has(`${a}`)){const t=n[`${a}`];if(t instanceof Error)throw new s(`cannot apply $${e.name} to -inf, value must in (-inf,inf)`);return t}return e(a)}}rt(Math.acos,{Infinity:1/0,0:new Error}),rt(Math.acosh,{Infinity:1/0,0:new Error}),rt(Math.asin),rt(Math.asinh,{Infinity:1/0,"-Infinity":-1/0}),rt(Math.atan),rt(Math.atanh,{1:1/0,"-1":-1/0}),rt(Math.cos),rt(Math.cosh,{"-Infinity":1/0,Infinity:1/0});const it=Math.PI/180,ot=(rt((e=>e*it),{Infinity:1/0,"-Infinity":1/0}),180/Math.PI);rt((e=>e*ot),{Infinity:1/0,"-Infinity":-1/0}),rt(Math.sin),rt(Math.sinh,{"-Infinity":-1/0,Infinity:1/0}),rt(Math.tan);Error;const at=(e,t,n)=>{if($(t))return e;let r=Object.keys(t),i=!1;ut(t,n);const o=n.idKey;if(F(r,o)){const e=t[o];0!==e&&!1!==e||(r=r.filter(q.bind(null,[o])),i=0==r.length)}else r.push(o);const a=ye.init(n);return e.map((e=>st(e,t,a.update(e),r,i)))};function st(e,t,n,r,i){let o={},a=!1,s=!1;const u=[];i&&u.push(n.idKey);for(const i of r){let r;const c=t[i];if(i!==n.idKey&&F([0,!1],c)&&(s=!0),i===n.idKey&&$(c))r=e[i];else if(P(c))r=Se(e,c,i,n);else if(F([1,!0],c));else if(c instanceof Array)r=c.map((t=>{const r=Se(e,t,null,n);return L(r)?null:r}));else{if(!A(c)){u.push(i);continue}{const t=c,o=Object.keys(c),s=1==o.length?o[0]:"",u=_e(pe.PROJECTION,s,n);if(u)"$slice"===s?K(t[s]).every(D)?(r=u(e,t[s],i,n),a=!0):r=Se(e,t,i,n):r=u(e,t[s],i,n);else if(he(s))r=Se(e,t[s],s,n);else if(W(e,i)){ut(t,n);let a=e[i];a instanceof Array?r=a.map((e=>st(e,t,n,o,!1))):(a=A(a)?a:e,r=st(a,t,n,o,!1))}else r=Se(e,c,null,n)}}const l=ie(e,i,{preserveMissing:!0});void 0!==l&&z(o,l,{flatten:!0}),q([0,1,!1,!0],c)&&(void 0===r?ce(o,i,{descendArray:!0}):ue(o,i,r))}if(oe(o),(a||s||i)&&(o=te({},e,o),u.length>0))for(const e of u)ce(o,e,{descendArray:!0});return o}function ut(e,t){const n=[!1,!1];for(const[r,i]of Object.entries(e)){if(r===(null==t?void 0:t.idKey))return;0===i||!1===i?n[0]=!0:1!==i&&!0!==i||(n[1]=!0),C(!(n[0]&&n[1]),"Projection cannot have a mix of inclusion and exclusion.")}}const ct=(e,t,n)=>{C(T(t),"Invalid expression: $and expects value to be an Array.");const r=t.map((e=>new Ae(e,n)));return e=>r.every((t=>t.test(e)))},lt=(e,t,n)=>{C(T(t),"Invalid expression. $or expects value to be an Array");const r=t.map((e=>new Ae(e,n)));return e=>r.some((t=>t.test(e)))},ht=(e,t,n)=>{C(T(t),"Invalid expression. $nor expects value to be an array.");const r=lt("$or",t,n);return e=>!r(e)},ft=(e,t,n)=>{const r={};r[e]=fe(t);const i=new Ae(r,n);return e=>!i.test(e)},dt=Me(Le),pt=Me(We),mt=Me(He),yt=Me(qe),vt=Me(Ue),gt=Me(Ke),bt=Me(Fe),wt=Me($e);const _t=Me((function(e,t,n){return K(e).some((e=>2===t.length&&e%t[0]===t[1]))})),Et=Me((function(e,t,n){const r=K(e),i=e=>P(e)&&((e,t=!0)=>!!e||t&&""===e)(t.exec(e),null==n?void 0:n.useStrictMode);return r.some(i)||X(r,1).some(i)}));Me((function(e,t,n){if(!(T(e)&&T(t)&&e.length&&t.length))return!1;let r=!0;for(const i of t){if(!r)break;r=A(i)&&F(Object.keys(i),"$elemMatch")?Qe(e,i.$elemMatch,n):i instanceof RegExp?e.some((e=>"string"==typeof e&&i.test(e))):e.some((e=>Z(i,e)))}return r}));const kt=Me(Qe),St=Me((function(e,t,n){return Array.isArray(e)&&e.length===t})),xt=Me((function(e,t,n){return(!1===t||0===t)&&void 0===e||(!0===t||1===t)&&void 0!==e})),Ct=Me((function(e,t,n){return Array.isArray(t)?t.findIndex((t=>Je(e,t)))>=0:Je(e,t)}));var Ot=!1;function Rt(e,t){var n=(0,i.xQ)(e.primaryKey);t=(0,o.FD)(t);var s=(0,o.o8)(t);if("number"!=typeof s.skip&&(s.skip=0),s.selector?(s.selector=s.selector,Object.entries(s.selector).forEach((([e,t])=>{"object"==typeof t&&null!==t||(s.selector[e]={$eq:t})}))):s.selector={},s.index){var u=(0,a.$r)(s.index);u.includes(n)||u.push(n),s.index=u}if(s.sort){var c=s.sort.find((e=>(0,o.Ln)(e)===n));c||(s.sort=s.sort.slice(0),s.sort.push({[n]:"asc"}))}else if(s.index)s.sort=s.index.map((e=>({[e]:"asc"})));else{if(e.indexes){var l=new Set;Object.entries(s.selector).forEach((([e,t])=>{("object"!=typeof t||null===t||!!Object.keys(t).find((e=>r.Cf.has(e))))&&l.add(e)}));var h,f=-1;e.indexes.forEach((e=>{var t=(0,a.k_)(e)?e:[e],n=t.findIndex((e=>!l.has(e)));n>0&&n>f&&(f=n,h=t)})),h&&(s.sort=h.map((e=>({[e]:"asc"}))))}s.sort||(s.sort=[{[n]:"asc"}])}return s}function It(e,t){if(!t.sort)throw(0,me.Br)("SNH",{query:t});var n=[];t.sort.forEach((e=>{var t=Object.keys(e)[0],r=Object.values(e)[0];n.push({key:t,direction:r,getValueFn:(0,o.SQ)(t)})}));return(e,t)=>{for(var r=0;r<n.length;++r){var i=n[r],o=i.getValueFn(e),a=i.getValueFn(t);if(o!==a)return"asc"===i.direction?x(o,a):x(a,o)}}}function Pt(e,t){if(!t.sort)throw(0,me.Br)("SNH",{query:t});var n,r=(n=t.selector,Ot||(we(pe.PIPELINE,{$sort:je,$project:at}),we(pe.QUERY,{$and:ct,$eq:dt,$elemMatch:kt,$exists:xt,$gt:pt,$gte:mt,$in:yt,$lt:vt,$lte:gt,$ne:bt,$nin:wt,$mod:_t,$nor:ht,$not:ft,$or:lt,$regex:Et,$size:St,$type:Ct}),Ot=!0),new Ae(n));return e=>r.test(e)}},915:(e,t,n)=>{"use strict";n.d(t,{Mh:()=>we,XX:()=>_e,nd:()=>Ee,Ib:()=>xe});var r=n(2212),i=n(9426),o=n(8825),a=n(3031),s=n(5964),u=new(n(3776).c)((function(e){return e.complete()}));var c=n(6049),l=n(7968);var h=n(6126),f=n(9050),d=n(8452),p=n(1160),m=n(1636),y=n(1900),v=n(5923),g=n(7205),b=n(7494),w=n(2085),_=n(4034),E=n(3715),k=n(2217),S=n(6606),x=n(337);const C=e=>{e.previousResults.unshift(e.changeEvent.doc),e.keyDocumentMap&&e.keyDocumentMap.set(e.changeEvent.id,e.changeEvent.doc)},O=e=>{e.previousResults.push(e.changeEvent.doc),e.keyDocumentMap&&e.keyDocumentMap.set(e.changeEvent.id,e.changeEvent.doc)},R=e=>{const t=e.previousResults.shift();e.keyDocumentMap&&t&&e.keyDocumentMap.delete(t[e.queryParams.primaryKey])},I=e=>{const t=e.previousResults.pop();e.keyDocumentMap&&t&&e.keyDocumentMap.delete(t[e.queryParams.primaryKey])},P=e=>{e.keyDocumentMap&&e.keyDocumentMap.delete(e.changeEvent.id);const t=e.queryParams.primaryKey,n=e.previousResults;for(let r=0;r<n.length;r++){if(n[r][t]===e.changeEvent.id){n.splice(r,1);break}}},D=e=>{const t=e.changeEvent.id,n=e.changeEvent.doc;if(e.keyDocumentMap){if(e.keyDocumentMap.has(t))return;e.keyDocumentMap.set(t,n)}else{if(e.previousResults.find((n=>n[e.queryParams.primaryKey]===t)))return}!function(e,t,n,r){var i,o=e.length,a=o-1,s=0;if(0===o)return e.push(t),0;for(;r<=a;)n(i=e[s=r+(a-r>>1)],t)<=0?r=s+1:a=s-1;n(i,t)<=0&&s++,e.splice(s,0,t)}(e.previousResults,n,e.queryParams.sortComparator,0)},T=["doNothing","insertFirst","insertLast","removeFirstItem","removeLastItem","removeFirstInsertLast","removeLastInsertFirst","removeFirstInsertFirst","removeLastInsertLast","removeExisting","replaceExisting","alwaysWrong","insertAtSortPosition","removeExistingAndInsertAtSortPosition","runFullQueryAgain","unknownAction"],A={doNothing:e=>{},insertFirst:C,insertLast:O,removeFirstItem:R,removeLastItem:I,removeFirstInsertLast:e=>{R(e),O(e)},removeLastInsertFirst:e=>{I(e),C(e)},removeFirstInsertFirst:e=>{R(e),C(e)},removeLastInsertLast:e=>{I(e),O(e)},removeExisting:P,replaceExisting:e=>{const t=e.changeEvent.doc,n=e.queryParams.primaryKey,r=e.previousResults;for(let i=0;i<r.length;i++){if(r[i][n]===e.changeEvent.id){r[i]=t,e.keyDocumentMap&&e.keyDocumentMap.set(e.changeEvent.id,t);break}}},alwaysWrong:e=>{const t={_id:"wrongHuman"+(new Date).getTime()};e.previousResults.length=0,e.previousResults.push(t),e.keyDocumentMap&&(e.keyDocumentMap.clear(),e.keyDocumentMap.set(t._id,t))},insertAtSortPosition:D,removeExistingAndInsertAtSortPosition:e=>{P(e),D(e)},runFullQueryAgain:e=>{throw new Error("Action runFullQueryAgain must be implemented by yourself")},unknownAction:e=>{throw new Error("Action unknownAction should never be called")}};!function(e=6){let t="";const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let r=0;r<e;r++)t+=n.charAt(Math.floor(62*Math.random()))}(4);function j(e,t){const n=[];for(let r=0,i=e.length;r<i;r+=t)n.push(e.substring(r,r+t));return n}const N=40;function M(e){return e.charCodeAt(0)-N}function B(e){return e[e.length-1]}function L(e,t,n){if(Array.isArray(t)&&(t=t.join(".")),!function(e){const t=typeof e;return null!==e&&("object"===t||"function"===t)}(e)||"string"!=typeof t)return void 0===n?e:n;const r=t.split(".");if(0===r.length)return n;for(let t=0;t<r.length;t++){const i=r[t];if(null==(e=F(e,i)?t===r.length-1?void 0:null:e[i])){if(t!==r.length-1)return n;break}}return void 0===e?n:e}function F(e,t){if("number"!=typeof t&&Array.isArray(e)){const n=Number.parseInt(t,10);return Number.isInteger(n)&&e[n]===e[t]}return!1}const q=e=>!!e.queryParams.limit,$=e=>1===e.queryParams.limit,U=e=>!!(e.queryParams.skip&&e.queryParams.skip>0),K=e=>"DELETE"===e.changeEvent.operation,W=e=>"INSERT"===e.changeEvent.operation,H=e=>"UPDATE"===e.changeEvent.operation,z=e=>q(e)&&e.previousResults.length>=e.queryParams.limit,Q=e=>{const t=e.queryParams.sortFields,n=e.changeEvent.previous,r=e.changeEvent.doc;if(!r)return!1;if(!n)return!0;for(let e=0;e<t.length;e++){const i=t[e];if(L(n,i)!==L(r,i))return!0}return!1},V=e=>{const t=e.changeEvent.id;if(e.keyDocumentMap){return e.keyDocumentMap.has(t)}{const n=e.queryParams.primaryKey,r=e.previousResults;for(let e=0;e<r.length;e++){if(r[e][n]===t)return!0}return!1}},X=e=>{const t=e.previousResults[0];return!(!t||t[e.queryParams.primaryKey]!==e.changeEvent.id)},Y=e=>{const t=B(e.previousResults);return!(!t||t[e.queryParams.primaryKey]!==e.changeEvent.id)},Z=e=>{const t=e.changeEvent.previous;if(!t)return!1;const n=e.previousResults[0];if(!n)return!1;if(n[e.queryParams.primaryKey]===e.changeEvent.id)return!0;return e.queryParams.sortComparator(t,n)<0},J=e=>{const t=e.changeEvent.previous;if(!t)return!1;const n=B(e.previousResults);if(!n)return!1;if(n[e.queryParams.primaryKey]===e.changeEvent.id)return!0;return e.queryParams.sortComparator(t,n)>0},G=e=>{const t=e.changeEvent.doc;if(!t)return!1;const n=e.previousResults[0];if(!n)return!1;if(n[e.queryParams.primaryKey]===e.changeEvent.id)return!0;return e.queryParams.sortComparator(t,n)<0},ee=e=>{const t=e.changeEvent.doc;if(!t)return!1;const n=B(e.previousResults);if(!n)return!1;if(n[e.queryParams.primaryKey]===e.changeEvent.id)return!0;return e.queryParams.sortComparator(t,n)>0},te=e=>{const t=e.changeEvent.previous;return!!t&&e.queryParams.queryMatcher(t)},ne=e=>{const t=e.changeEvent.doc;if(!t)return!1;return e.queryParams.queryMatcher(t)},re=e=>0===e.previousResults.length,ie={0:W,1:H,2:K,3:q,4:$,5:U,6:re,7:z,8:X,9:Y,10:Q,11:V,12:Z,13:J,14:G,15:ee,16:te,17:ne};let oe;function ae(){return oe||(oe=function(e){const t=new Map,n=2+2*parseInt(e.charAt(0)+e.charAt(1),10),r=j(e.substring(2,n),2);for(let e=0;e<r.length;e++){const n=r[e],i=n.charAt(0),o=M(n.charAt(1));t.set(i,o)}const i=j(e.substring(n,e.length-3),4);for(let e=0;e<i.length;e++){const n=i[e],r=n.charAt(0),o=n.charAt(1),a=n.charAt(2),s=M(n.charAt(3));if(!t.has(o))throw new Error("missing node with id "+o);if(!t.has(a))throw new Error("missing node with id "+a);const u={l:s,0:t.get(o),1:t.get(a)};t.set(r,u)}const o=e.slice(-3),a=o.charAt(0),s=o.charAt(1);return{l:M(o.charAt(2)),0:t.get(a),1:t.get(s)}}("14a1b,c+d2e5f0g/h.i4j*k-l)m(n6oeh6pnm6qen6ril6snh6tin6ubo9vce9wmh9xns9yne9zmi9{cm9|ad9}cp9~aq9ae9bf9bq9cg9ck9cn9nd9np9nq9nf9ng9nm9nk9mr9ms9mt9mj9mk9ml9mn9mc8{8}888mn88m8m4z4w4z44444m4v7yn77~777n777m77m7m7m5m5m55m555m55m5m552|2u2222x222|222222n2n222n2/an/bn/cn///////////,cn,,,,,,,ac0bc00000000000m-m-----------3333(((++++11*m*.")),oe}const se=e=>function(e,t,n){let r=e,i=e.l;for(;;){if(r=r[t[i](n)?"1":"0"],"number"==typeof r||"string"==typeof r)return r;i=r.l}}(ae(),ie,e);function ue(e){const t=se(e);return T[t]}var ce=n(6493),le=n(6250),he=n(1845);function fe(e,t){return t.sort&&0!==t.sort.length?t.sort.map((e=>Object.keys(e)[0])):[e]}var de=new WeakMap;function pe(e,t){if(!e.collection.database.eventReduce)return{runFullQueryAgain:!0};var n=function(e){return(0,le.q)(de,e,(()=>{var t=e.collection,n=(0,he._V)(t.storageInstance.schema,(0,w.o8)(e.mangoQuery)),r=t.schema.primaryPath,i=(0,he.Xw)(t.schema.jsonSchema,n),o=(0,he.Lr)(t.schema.jsonSchema,n);return{primaryKey:e.collection.schema.primaryPath,skip:n.skip,limit:n.limit,sortFields:fe(r,n),sortComparator:(t,n)=>{var r={docA:t,docB:n,rxQuery:e};return i(r.docA,r.docB)},queryMatcher:t=>o({doc:t,rxQuery:e}.doc)}}))}(e),r=(0,b.ZN)(e._result).docsData.slice(0),i=(0,b.ZN)(e._result).docsDataMap,o=!1,a=t.map((e=>(0,ce._r)(e))).filter(k.S7).find((e=>{var t=ue({queryParams:n,changeEvent:e,previousResults:r,keyDocumentMap:i});return"runFullQueryAgain"===t||("doNothing"!==t?(o=!0,function(e,t,n,r,i){(0,A[e])({queryParams:t,changeEvent:n,previousResults:r,keyDocumentMap:i})}(t,n,e,r,i),!1):void 0)}));return a?{runFullQueryAgain:!0}:{runFullQueryAgain:!1,changed:o,newResults:r}}var me=n(9110),ye=n(4344),ve=function(){return(0,r.A)((function(e,t,n){this.time=(0,v.t)(),this.collection=e,this.count=n,this.documents=(0,ye.X)(this.collection._docCache,t)}),[{key:"docsData",get:function(){return(0,w.Ns)(this,"docsData",this.documents.map((e=>e._data)))}},{key:"docsDataMap",get:function(){var e=new Map;return this.documents.forEach((t=>{e.set(t.primary,t._data)})),(0,w.Ns)(this,"docsDataMap",e)}},{key:"docsMap",get:function(){for(var e=new Map,t=this.documents,n=0;n<t.length;n++){var r=t[n];e.set(r.primary,r)}return(0,w.Ns)(this,"docsMap",e)}}])}(),ge=n(3040),be=0,we=function(){function e(e,t,n,r={}){this.id=++be,this._execOverDatabaseCount=0,this._creationTime=(0,v.t)(),this._lastEnsureEqual=0,this.uncached=!1,this.refCount$=new i.t(null),this._result=null,this._latestChangeEvent=-1,this._lastExecStart=0,this._lastExecEnd=0,this._ensureEqualQueue=g.Dr,this.op=e,this.mangoQuery=t,this.collection=n,this.other=r,t||(this.mangoQuery={selector:{}}),this.isFindOneByIdQuery=function(e,t){if(!t.skip&&t.selector&&1===Object.keys(t.selector).length&&t.selector[e]){var n=t.selector[e];if("string"==typeof n)return n;if(1===Object.keys(n).length&&"string"==typeof n.$eq)return n.$eq;if(1===Object.keys(n).length&&Array.isArray(n.$eq)&&!n.$eq.find((e=>"string"!=typeof e)))return n.$eq}return!1}(this.collection.schema.primaryPath,t)}var t=e.prototype;return t._setResultData=function(e){if("number"!=typeof e){e instanceof Map&&(e=Array.from(e.values()));var t=new ve(this.collection,e,e.length);this._result=t}else this._result=new ve(this.collection,[],e)},t._execOverDatabase=async function(){if(this._execOverDatabaseCount=this._execOverDatabaseCount+1,this._lastExecStart=(0,v.t)(),"count"===this.op){var e=this.getPreparedQuery(),t=await this.collection.storageInstance.count(e);if("slow"!==t.mode||this.collection.database.allowSlowCount)return t.count;throw(0,S.Br)("QU14",{collection:this.collection,queryObj:this.mangoQuery})}if("findByIds"===this.op){var n=(0,b.ZN)(this.mangoQuery.selector)[this.collection.schema.primaryPath].$in,r=new Map,i=[];if(n.forEach((e=>{var t=this.collection._docCache.getLatestDocumentDataIfExists(e);if(t){if(!t._deleted){var n=this.collection._docCache.getCachedRxDocument(t);r.set(e,n)}}else i.push(e)})),i.length>0)(await this.collection.storageInstance.findDocumentsById(i,!1)).forEach((e=>{var t=this.collection._docCache.getCachedRxDocument(e);r.set(t.primary,t)}));return r}var o=async function(e){var t=[],n=e.collection;if(e.isFindOneByIdQuery)if(Array.isArray(e.isFindOneByIdQuery)){var r=e.isFindOneByIdQuery;if(r=r.filter((n=>{var r=e.collection._docCache.getLatestDocumentDataIfExists(n);return!r||(r._deleted||t.push(r),!1)})),r.length>0){var i=await n.storageInstance.findDocumentsById(r,!1);(0,k.Hb)(t,i)}}else{var o=e.isFindOneByIdQuery,a=e.collection._docCache.getLatestDocumentDataIfExists(o);if(!a){var s=await n.storageInstance.findDocumentsById([o],!1);s[0]&&(a=s[0])}a&&!a._deleted&&t.push(a)}else{var u=e.getPreparedQuery(),c=await n.storageInstance.query(u);t=c.documents}return t}(this);return o.then((e=>(this._lastExecEnd=(0,v.t)(),e)))},t.exec=function(e){if(e&&"findOne"!==this.op)throw(0,S.Br)("QU9",{collection:this.collection.name,query:this.mangoQuery,op:this.op});return Se(this).then((()=>(0,o._)(this.$))).then((t=>{if(!t&&e)throw(0,S.Br)("QU10",{collection:this.collection.name,query:this.mangoQuery,op:this.op});return t}))},t.toString=function(){var e=(0,w.mf)({op:this.op,query:this.mangoQuery,other:this.other},!0),t=JSON.stringify(e);return this.toString=()=>t,t},t.getPreparedQuery=function(){var e={rxQuery:this,mangoQuery:(0,he._V)(this.collection.schema.jsonSchema,this.mangoQuery)};e.mangoQuery.selector._deleted={$eq:!1},e.mangoQuery.index&&e.mangoQuery.index.unshift("_deleted"),(0,x.Xi)("prePrepareQuery",e);var t=xe(this.collection.schema.jsonSchema,e.mangoQuery);return this.getPreparedQuery=()=>t,t},t.doesDocumentDataMatch=function(e){return!e._deleted&&this.queryMatcher(e)},t.remove=function(){return this.exec().then((e=>Array.isArray(e)?Promise.all(e.map((e=>e.remove()))):e.remove()))},t.update=function(e){throw(0,_.u)("update")},t.where=function(e){throw(0,_.u)("query-builder")},t.sort=function(e){throw(0,_.u)("query-builder")},t.skip=function(e){throw(0,_.u)("query-builder")},t.limit=function(e){throw(0,_.u)("query-builder")},(0,r.A)(e,[{key:"$",get:function(){if(!this._$){var e=this.collection.$.pipe((0,h.p)((e=>!e.isLocal)),(0,f.Z)(null),(0,d.Z)((()=>Se(this))),(0,p.T)((()=>this._result)),(0,m.t)(b.bz),(0,y.F)(((e,t)=>!(!e||e.time!==(0,b.ZN)(t).time))),(0,h.p)((e=>!!e)),(0,p.T)((e=>{var t=(0,b.ZN)(e);return"count"===this.op?t.count:"findOne"===this.op?0===t.documents.length?null:t.documents[0]:"findByIds"===this.op?t.docsMap:t.documents.slice(0)})));this._$=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=(0,c.lI)(e),r=(0,c.R0)(e,1/0),i=e;return i.length?1===i.length?(0,s.Tg)(i[0]):(0,a.U)(r)((0,l.H)(i,n)):u}(e,this.refCount$.pipe((0,h.p)((()=>!1))))}return this._$}},{key:"$$",get:function(){return this.collection.database.getReactivityFactory().fromObservable(this.$,void 0,this.collection.database)}},{key:"queryMatcher",get:function(){var e=this.collection.schema.jsonSchema,t=(0,he._V)(this.collection.schema.jsonSchema,this.mangoQuery);return(0,w.Ns)(this,"queryMatcher",(0,he.Lr)(e,t))}},{key:"asRxQuery",get:function(){return this}}])}();function _e(){return{selector:{}}}function Ee(e,t,n,r){(0,x.Xi)("preCreateRxQuery",{op:e,queryObj:t,collection:n,other:r});var i,o=new we(e,t,n,r);return o=(i=o).collection._queryCache.getByQuery(i),(0,me.n9)(n),o}function ke(e){var t=e.asRxQuery.collection._changeEventBuffer.counter;return e._latestChangeEvent>=t}function Se(e){return e.collection.database.destroyed||ke(e)?g.Dr:(e._ensureEqualQueue=e._ensureEqualQueue.then((()=>function(e){if(e._lastEnsureEqual=(0,v.t)(),e.collection.database.destroyed||ke(e))return g.Dr;var t=!1,n=!1;-1===e._latestChangeEvent&&(n=!0);if(!n){var r=e.asRxQuery.collection._changeEventBuffer.getFrom(e._latestChangeEvent+1);if(null===r)n=!0;else{e._latestChangeEvent=e.asRxQuery.collection._changeEventBuffer.counter;var i=e.asRxQuery.collection._changeEventBuffer.reduceByLastOfDoc(r);if("count"===e.op){var o=(0,b.ZN)(e._result).count,a=o;i.forEach((t=>{var n=t.previousDocumentData&&e.doesDocumentDataMatch(t.previousDocumentData),r=e.doesDocumentDataMatch(t.documentData);!n&&r&&a++,n&&!r&&a--})),a!==o&&(t=!0,e._setResultData(a))}else{var s=pe(e,i);s.runFullQueryAgain?n=!0:s.changed&&(t=!0,e._setResultData(s.newResults))}}}if(n)return e._execOverDatabase().then((n=>(e._latestChangeEvent=e.collection._changeEventBuffer.counter,"number"==typeof n?(e._result&&n===e._result.count||(t=!0,e._setResultData(n)),t):(e._result&&(0,E.YL)(e.collection.schema.primaryPath,n,e._result.docsData)||(t=!0,e._setResultData(n)),t))));return Promise.resolve(t)}(e))),e._ensureEqualQueue)}function xe(e,t){if(!t.sort)throw(0,S.Br)("SNH",{query:t});return{query:t,queryPlan:(0,ge.sk)(e,t)}}},6143:(e,t,n)=>{"use strict";n.d(t,{pA:()=>b,Nq:()=>h,Ud:()=>y,U:()=>p,uK:()=>g,Hq:()=>d,xQ:()=>f,nT:()=>l,d1:()=>m});var r=n(6606),i=/\./g,o=n(4815),a=n(9101),s=n(7494),u=n(2085),c=n(2217);function l(e,t){var n=t;return n="properties."+(n=n.replace(i,".properties.")),n=(0,o.L$)(n),(0,a.UU)(e,n)}function h(e,t,n){if("string"==typeof t.primaryKey)return n;var i=p(t,n),o=n[e];if(o&&o!==i)throw(0,r.Br)("DOC19",{args:{documentData:n,existingPrimary:o,newPrimary:i},schema:t});return n[e]=i,n}function f(e){return"string"==typeof e?e:e.key}function d(e){var t=l(e,f(e.primaryKey));return(0,s.ZN)(t.maxLength)}function p(e,t){if("string"==typeof e.primaryKey)return t[e.primaryKey];var n=e.primaryKey;return n.fields.map((e=>{var n=(0,a.UU)(t,e);if(void 0===n)throw(0,r.Br)("DOC18",{args:{field:e,documentData:t}});return n})).join(n.separator)}function m(e){return(0,u.mf)(e,!0)}function y(e){var t=f((e=(0,u.FD)(e)).primaryKey);e.properties=(0,u.FD)(e.properties),e.additionalProperties=!1,Object.prototype.hasOwnProperty.call(e,"keyCompression")||(e.keyCompression=!1),e.indexes=e.indexes?e.indexes.slice(0):[],e.required=e.required?e.required.slice(0):[],e.encrypted=e.encrypted?e.encrypted.slice(0):[],e.properties._rev={type:"string",minLength:1},e.properties._attachments={type:"object"},e.properties._deleted={type:"boolean"},e.properties._meta=v,e.required=e.required?e.required.slice(0):[],e.required.push("_deleted"),e.required.push("_rev"),e.required.push("_meta"),e.required.push("_attachments");var n=g(e);(0,c.Hb)(e.required,n),e.required=e.required.filter((e=>!e.includes("."))).filter(((e,t,n)=>n.indexOf(e)===t)),e.version=e.version||0;var r=e.indexes.map((e=>{var n=(0,c.k_)(e)?e.slice(0):[e];return n.includes(t)||n.push(t),"_deleted"!==n[0]&&n.unshift("_deleted"),n}));0===r.length&&r.push(function(e){return["_deleted",e]}(t)),r.push(["_meta.lwt",t]),e.internalIndexes&&e.internalIndexes.map((e=>{r.push(e)}));var i=new Set;return r.filter((e=>{var t=e.join(",");return!i.has(t)&&(i.add(t),!0)})),e.indexes=r,e}var v={type:"object",properties:{lwt:{type:"number",minimum:n(3715).MC,maximum:1e15,multipleOf:.01}},additionalProperties:!0,required:["lwt"]};function g(e){var t=Object.keys(e.properties).filter((t=>e.properties[t].final)),n=f(e.primaryKey);return t.push(n),"string"!=typeof e.primaryKey&&e.primaryKey.fields.forEach((e=>t.push(e))),t}function b(e,t){for(var n=Object.keys(e.defaultValues),r=0;r<n.length;++r){var i=n[r];Object.prototype.hasOwnProperty.call(t,i)&&void 0!==t[i]||(t[i]=e.defaultValues[i])}return t}},3907:(e,t,n)=>{"use strict";n.d(t,{NP:()=>f,Wq:()=>d,wJ:()=>h});var r=n(2212),i=n(4701),o=n(2085),a=n(2217),s=n(6606),u=n(337),c=n(6143),l=n(2507),h=function(){function e(e,t){this.jsonSchema=e,this.hashFunction=t,this.indexes=function(e){return(e.indexes||[]).map((e=>(0,a.k_)(e)?e:[e]))}(this.jsonSchema),this.primaryPath=(0,c.xQ)(this.jsonSchema.primaryKey),this.finalFields=(0,c.uK)(this.jsonSchema)}var t=e.prototype;return t.validateChange=function(e,t){this.finalFields.forEach((n=>{if(!(0,i.b)(e[n],t[n]))throw(0,s.Br)("DOC9",{dataBefore:e,dataAfter:t,fieldName:n,schema:this.jsonSchema})}))},t.getDocumentPrototype=function(){var e={},t=(0,c.nT)(this.jsonSchema,"");return Object.keys(t).forEach((t=>{var n=t;e.__defineGetter__(t,(function(){if(this.get&&"function"==typeof this.get)return this.get(n)})),Object.defineProperty(e,t+"$",{get:function(){return this.get$(n)},enumerable:!1,configurable:!1}),Object.defineProperty(e,t+"$$",{get:function(){return this.get$$(n)},enumerable:!1,configurable:!1}),Object.defineProperty(e,t+"_",{get:function(){return this.populate(n)},enumerable:!1,configurable:!1})})),(0,o.Ns)(this,"getDocumentPrototype",(()=>e)),e},t.getPrimaryOfDocumentData=function(e){return(0,c.U)(this.jsonSchema,e)},(0,r.A)(e,[{key:"version",get:function(){return this.jsonSchema.version}},{key:"defaultValues",get:function(){var e={};return Object.entries(this.jsonSchema.properties).filter((([,e])=>Object.prototype.hasOwnProperty.call(e,"default"))).forEach((([t,n])=>e[t]=n.default)),(0,o.Ns)(this,"defaultValues",e)}},{key:"hash",get:function(){return(0,o.Ns)(this,"hash",this.hashFunction(JSON.stringify(this.jsonSchema)))}}])}();function f(e){var t=e.version?e.version:0,n=0;return new Array(t).fill(0).map((()=>n++))}function d(e,t,n=!0){n&&(0,u.Xi)("preCreateRxSchema",e);var r=(0,c.Ud)(e);r=(0,c.d1)(r),l.h.deepFreezeWhenDevMode(r);var i=new h(r,t);return(0,u.Xi)("createRxSchema",i),i}},1232:(e,t,n)=>{"use strict";n.d(t,{$I:()=>b,AM:()=>x,C9:()=>S,ME:()=>O,Mu:()=>g,O5:()=>y,OG:()=>m,WX:()=>w,gi:()=>_,mQ:()=>v,on:()=>k,p0:()=>R,pZ:()=>C});var r=n(2507),i=n(6606),o=n(6143),a=n(4815),s=n(5923),u=n(7494),c=n(2085),l=n(4391),h=n(2217),f=n(3715),d=n(915),p=n(1845),m="_rxdb_internal";async function y(e,t){var n=(await e.findDocumentsById([t],!1))[0];return n||void 0}async function v(e,t,n){var r=await e.bulkWrite([t],n);if(r.error.length>0)throw r.error[0];return r.success[0]}function g(e){return Object.assign({},...e)}function b(e,t,n){var i=t.documentData,o=t.previousDocumentData;return{documentId:t.documentId,collectionName:n?n.name:void 0,isLocal:e,operation:t.operation,documentData:r.h.deepFreezeWhenDevMode(i),previousDocumentData:r.h.deepFreezeWhenDevMode(o)}}function w(e,t,n,r){if(r)throw 409===r.status?(0,i.Br)("CONFLICT",{collection:e.name,id:t,writeError:r,data:n}):422===r.status?(0,i.Br)("VD2",{collection:e.name,id:t,writeError:r,data:n}):r}function _(e,t,n,r,o,c,l){for(var h,f=!!e.schema.attachments,d=[],p=[],m=[],y={id:(0,a.z3)(10),events:[],checkpoint:null,context:o,startTime:(0,s.t)(),endTime:0},v=y.events,g=[],b=[],w=[],_=n.size>0,S=r.length,x=function(){var e,o=r[C],a=o.document,s=o.previous,y=a[t],S=a._deleted,x=s&&s._deleted,O=void 0;if(_&&(O=n.get(y)),O){var R=O._rev;if(!s||s&&R!==s._rev){var I={isError:!0,status:409,documentId:y,writeRow:o,documentInDb:O};return m.push(I),1}var P=f?E(o):o;f&&(S?s&&Object.keys(s._attachments).forEach((e=>{b.push({documentId:y,attachmentId:e,digest:(0,u.ZN)(s)._attachments[e].digest})})):(Object.entries(a._attachments).find((([t,n])=>((s?s._attachments[t]:void 0)||n.data||(e={documentId:y,documentInDb:O,isError:!0,status:510,writeRow:o,attachmentId:t}),!0))),e||Object.entries(a._attachments).forEach((([e,t])=>{var n=s?s._attachments[e]:void 0;if(n){var r=P.document._attachments[e].digest;t.data&&n.digest!==r&&w.push({documentId:y,attachmentId:e,attachmentData:t,digest:t.digest})}else g.push({documentId:y,attachmentId:e,attachmentData:t,digest:t.digest})})))),e?m.push(e):(f?(p.push(E(P)),l&&l(a)):(p.push(P),l&&l(a)),h=P);var D=null,T=null,A=null;if(x&&!S)A="INSERT",D=f?k(a):a;else if(!s||x||S){if(!S)throw(0,i.Br)("SNH",{args:{writeRow:o}});A="DELETE",D=(0,u.ZN)(a),T=s}else A="UPDATE",D=f?k(a):a,T=s;var j={documentId:y,documentData:D,previousDocumentData:T,operation:A};v.push(j)}else{var N=!!S;if(f&&Object.entries(a._attachments).forEach((([t,n])=>{n.data?g.push({documentId:y,attachmentId:t,attachmentData:n,digest:n.digest}):(e={documentId:y,isError:!0,status:510,writeRow:o,attachmentId:t},m.push(e))})),e||(f?(d.push(E(o)),c&&c(a)):(d.push(o),c&&c(a)),h=o),!N){var M={documentId:y,operation:"INSERT",documentData:f?k(a):a,previousDocumentData:f&&s?k(s):s};v.push(M)}}},C=0;C<S;C++)x();return{bulkInsertDocs:d,bulkUpdateDocs:p,newestRow:h,errors:m,eventBulk:y,attachmentsAdd:g,attachmentsRemove:b,attachmentsUpdate:w}}function E(e){return{previous:e.previous,document:k(e.document)}}function k(e){if(!e._attachments||0===Object.keys(e._attachments).length)return e;var t=(0,c.FD)(e);return t._attachments={},Object.entries(e._attachments).forEach((([e,n])=>{var r,i,o;t._attachments[e]=(o=(r=n).data)?{length:(i=o,atob(i).length),digest:r.digest,type:r.type}:r})),t}function S(e){var t=(0,c.FD)(e);return t._meta=(0,c.FD)(e._meta),t}function x(e,t,n){r.h.deepFreezeWhenDevMode(n);var a=(0,o.xQ)(n.primaryKey);var d={originalStorageInstance:t,schema:t.schema,internals:t.internals,collectionName:t.collectionName,databaseName:t.databaseName,options:t.options,bulkWrite(f,d){var p=f.map((u=>function(u){var h=(0,c.FD)(u.document);if(h._meta=(0,c.FD)(h._meta),r.h.isDevMode()){h=(0,o.Nq)(a,n,h);try{"function"==typeof structuredClone?structuredClone(u):JSON.parse(JSON.stringify(u))}catch(e){throw(0,i.Br)("DOC24",{collection:t.collectionName,document:u.document})}u.previous,u.previous&&Object.keys(u.previous._meta).forEach((e=>{if(!Object.prototype.hasOwnProperty.call(u.document._meta,e))throw(0,i.Br)("SNH",{dataBefore:u.previous,dataAfter:u.document})}))}return h._meta.lwt=(0,s.t)(),h._rev=(0,l.CM)(e.token,u.previous),{document:h,previous:u.previous}}(u)));return e.lockedRun((()=>t.bulkWrite(p,d))).then((n=>{var r={error:[],success:n.success.slice(0)},i=n.error.filter((e=>!(409!==e.status||e.writeRow.previous||e.writeRow.document._deleted||!(0,u.ZN)(e.documentInDb)._deleted)||(r.error.push(e),!1)));if(i.length>0){var o=i.map((t=>({previous:t.documentInDb,document:Object.assign({},t.writeRow.document,{_rev:(0,l.CM)(e.token,t.documentInDb)})})));return e.lockedRun((()=>t.bulkWrite(o,d))).then((e=>((0,h.Hb)(r.error,e.error),(0,h.Hb)(r.success,e.success),r)))}return n}))},query:n=>e.lockedRun((()=>t.query(n))),count:n=>e.lockedRun((()=>t.count(n))),findDocumentsById:(n,r)=>e.lockedRun((()=>t.findDocumentsById(n,r))),getAttachmentData:(n,r,i)=>e.lockedRun((()=>t.getAttachmentData(n,r,i))),getChangedDocumentsSince:t.getChangedDocumentsSince?(n,r)=>e.lockedRun((()=>t.getChangedDocumentsSince((0,u.ZN)(n),r))):void 0,cleanup:n=>e.lockedRun((()=>t.cleanup(n))),remove:()=>(e.storageInstances.delete(d),e.lockedRun((()=>t.remove()))),close:()=>(e.storageInstances.delete(d),e.lockedRun((()=>t.close()))),changeStream:()=>t.changeStream(),conflictResultionTasks:()=>t.conflictResultionTasks(),resolveConflictResultionTask(e){if(e.output.isEqual)return t.resolveConflictResultionTask(e);var n=Object.assign({},e.output.documentData,{_meta:(0,f.o4)(),_rev:(0,f.Fq)(),_attachments:{}}),r=(0,c.FD)(n);return delete r._meta,delete r._rev,delete r._attachments,t.resolveConflictResultionTask({id:e.id,output:{isEqual:!1,documentData:r}})}};return e.storageInstances.add(d),d}function C(e){if(e.schema.keyCompression)throw(0,i.Br)("UT5",{args:{params:e}});if(O(e.schema))throw(0,i.Br)("UT6",{args:{params:e}});if(e.schema.attachments&&e.schema.attachments.compression)throw(0,i.Br)("UT7",{args:{params:e}})}function O(e){return!!(e.encrypted&&e.encrypted.length>0||e.attachments&&e.attachments.encrypted)}async function R(e,t,n){if(e.getChangedDocumentsSince)return e.getChangedDocumentsSince(t,n);var r=(0,o.xQ)(e.schema.primaryKey),i=(0,d.Ib)(e.schema,function(e,t,n){var r=(0,o.xQ)(e.schema.primaryKey),i=n?n.lwt:f.MC,a=n?n.id:"";return(0,p._V)(e.schema,{selector:{$or:[{"_meta.lwt":{$gt:i}},{"_meta.lwt":{$eq:i},[r]:{$gt:n?a:""}}],"_meta.lwt":{$gte:i}},sort:[{"_meta.lwt":"asc"},{[r]:"asc"}],skip:0,limit:t})}(e,t,n)),a=(await e.query(i)).documents,s=(0,h.dG)(a);return{documents:a,checkpoint:s?{id:s[r],lwt:s._meta.lwt}:n||{id:"",lwt:0}}}},1635:(e,t,n)=>{"use strict";n.d(t,{AQ:()=>h,C6:()=>i,Ju:()=>s,N3:()=>l,YH:()=>a,fX:()=>c,sH:()=>o,xN:()=>f,zs:()=>u});var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function o(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function a(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}Object.create;function s(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function u(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function c(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function l(e){return this instanceof l?(this.v=e,this):new l(e)}function h(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||s(e,t)}))})}function s(e,t){try{(n=i[e](t)).value instanceof l?Promise.resolve(n.value.v).then(u,c):h(o[0][2],n)}catch(e){h(o[0][3],e)}var n}function u(e){s("next",e)}function c(e){s("throw",e)}function h(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}function f(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=s(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,i,(t=e[n](t)).done,t.value)}))}}}Object.create;"function"==typeof SuppressedError&&SuppressedError}},r={};function i(e){var t=r[e];if(void 0!==t)return t.exports;var o=r[e]={exports:{}};return n[e].call(o.exports,o,o.exports,i),o.exports}i.m=n,i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((t,n)=>(i.f[n](e,t),t)),[])),i.u=e=>({234:"8de6f6997c16c83f95a1",383:"0f3b926757b24c988f11"}[e]+".bundle.js"),i.miniCssF=e=>{},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="rxdb-quickstart:",i.l=(n,r,o,a)=>{if(e[n])e[n].push(r);else{var s,u;if(void 0!==o)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var h=c[l];if(h.getAttribute("src")==n||h.getAttribute("data-webpack")==t+o){s=h;break}}s||(u=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.setAttribute("data-webpack",t+o),s.src=n),e[n]=[r];var f=(t,r)=>{s.onerror=s.onload=null,clearTimeout(d);var i=e[n];if(delete e[n],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((e=>e(r))),t)return t(r)},d=setTimeout(f.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=f.bind(null,s.onerror),s.onload=f.bind(null,s.onload),u&&document.head.appendChild(s)}},i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e})(),(()=>{var e={792:0};i.f.j=(t,n)=>{var r=i.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var o=new Promise(((n,i)=>r=e[t]=[n,i]));n.push(r[2]=o);var a=i.p+i.u(t),s=new Error;i.l(a,(n=>{if(i.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var o=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+o+": "+a+")",s.name="ChunkLoadError",s.type=o,s.request=a,r[1](s)}}),"chunk-"+t,t)}};var t=(t,n)=>{var r,o,[a,s,u]=n,c=0;if(a.some((t=>0!==e[t]))){for(r in s)i.o(s,r)&&(i.m[r]=s[r]);if(u)u(i)}for(t&&t(n);c<a.length;c++)o=a[c],i.o(e,o)&&e[o]&&e[o][0](),e[o]=0},n=self.webpackChunkrxdb_quickstart=self.webpackChunkrxdb_quickstart||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),(()=>{"use strict";var e=i(4815),t=i(7494),n=i(3907),r=i(2497),o=i(915),a=i(7579),s=i(5131),u=i(2507),c=i(337),l=i(6606),h={RxSchema:n.wJ.prototype,RxDocument:r.ky,RxQuery:o.Mh.prototype,RxCollection:a.wm.prototype,RxDatabase:s.lB.prototype},f=new Set,d=new Set;function p(e){if((0,c.Xi)("preAddRxPlugin",{plugin:e,plugins:f}),!f.has(e)){if(d.has(e.name))throw(0,l.Br)("PL3",{name:e.name,plugin:e});if(f.add(e),d.add(e.name),!e.rxdb)throw(0,l.JX)("PL1",{plugin:e});e.init&&e.init(),e.prototypes&&Object.entries(e.prototypes).forEach((([e,t])=>t(h[e]))),e.overwritable&&Object.assign(u.h,e.overwritable),e.hooks&&Object.entries(e.hooks).forEach((([e,t])=>{t.after&&c.r[e].push(t.after),t.before&&c.r[e].unshift(t.before)}))}}var m=i(2748),y=i(4807),v=i(4701),g=i(6126),b=i(1160),w=i(9426),_=i(7291),E=i(8825),k=i(3776),S=Array.isArray,x=Object.getPrototypeOf,C=Object.prototype,O=Object.keys;function R(e){if(1===e.length){var t=e[0];if(S(t))return{args:t,keys:null};if((r=t)&&"object"==typeof r&&x(r)===C){var n=O(t);return{args:n.map((function(e){return t[e]})),keys:n}}}var r;return{args:e,keys:null}}var I=i(7968),P=i(8307),D=i(1635),T=Array.isArray;function A(e){return(0,b.T)((function(t){return function(e,t){return T(t)?e.apply(void 0,(0,D.fX)([],(0,D.zs)(t))):e(t)}(e,t)}))}var j=i(6049);var N=i(4878),M=i(6315);function B(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=(0,j.lI)(e),r=(0,j.ms)(e),i=R(e),o=i.args,a=i.keys;if(0===o.length)return(0,I.H)([],n);var s=new k.c(function(e,t,n){void 0===n&&(n=P.D);return function(r){L(t,(function(){for(var i=e.length,o=new Array(i),a=i,s=i,u=function(i){L(t,(function(){var u=(0,I.H)(e[i],t),c=!1;u.subscribe((0,N._)(r,(function(e){o[i]=e,c||(c=!0,s--),s||r.next(n(o.slice()))}),(function(){--a||r.complete()})))}),r)},c=0;c<i;c++)u(c)}),r)}}(o,n,a?function(e){return function(e,t){return e.reduce((function(e,n,r){return e[n]=t[r],e}),{})}(a,e)}:P.D));return r?s.pipe(A(r)):s}function L(e,t,n){e?(0,M.N)(n,e,t):t()}var F=i(8452),q=i(6143),$=i(2085),U=i(7205),K=i(1232),W=i(3715),H=i(5923),z=i(4391);async function Q(e,t){var n=(0,q.U)(e.input.metaInstance.schema,{isCheckpoint:"1",itemId:t}),r=(await e.input.metaInstance.findDocumentsById([n],!1))[0];return e.lastCheckpointDoc[t]=r,r?r.checkpointData:void 0}async function V(e,n,r){e.checkpointQueue=e.checkpointQueue.then((async()=>{var i=e.lastCheckpointDoc[n];if(r&&!e.events.canceled.getValue()&&(!i||JSON.stringify(i.checkpointData)!==JSON.stringify(r))){var o={id:"",isCheckpoint:"1",itemId:n,_deleted:!1,_attachments:{},checkpointData:r,_meta:(0,W.o4)(),_rev:(0,W.Fq)()};for(o.id=(0,q.U)(e.input.metaInstance.schema,o);!e.events.canceled.getValue();){if(i&&(o.checkpointData=(0,K.Mu)([i.checkpointData,o.checkpointData])),o._meta.lwt=(0,H.t)(),o._rev=(0,z.CM)(await e.checkpointKey,i),e.events.canceled.getValue())return;var a=await e.input.metaInstance.bulkWrite([{previous:i,document:o}],"replication-set-checkpoint"),s=a.success[0];if(s)return void(e.lastCheckpointDoc[n]=s);var u=a.error[0];if(409!==u.status)throw u;i=(0,t.ZN)(u.documentInDb),o._rev=(0,z.CM)(await e.checkpointKey,i)}}})),await e.checkpointQueue}var X=i(2217);function Y(e,t,n,r,i){var o=Object.assign({},r,{_attachments:t&&r._attachments?r._attachments:{},_meta:n?r._meta:{lwt:(0,H.t)()},_rev:n?r._rev:(0,W.Fq)()});return o._rev||(o._rev=(0,z.CM)(e,i)),o}function Z(e,t,n){var r=(0,$.FD)(e);return t||delete r._attachments,n||(delete r._meta,delete r._rev),r}function J(e,t){return e.hasAttachments?t.map((e=>{var t=(0,$.o8)(e.document);return t.docData=(0,K.on)(t.docData),{document:t,previous:e.previous}})):t}function G(e){for(;;){if(!e.underlyingPersistentStorage)return e;e=e.underlyingPersistentStorage}}function ee(e,t){return e.input.metaInstance.findDocumentsById(t.map((t=>(0,q.U)(e.input.metaInstance.schema,{itemId:t,isCheckpoint:"0"}))),!0).then((e=>{var t={};return Object.values(e).forEach((e=>{t[e.itemId]={docData:e.docData,metaDocument:e}})),t}))}async function te(e,t,n,r){var i=t[e.primaryPath],o=n?(0,K.C9)(n):{id:"",isCheckpoint:"0",itemId:i,docData:t,_attachments:{},_deleted:!1,_rev:(0,W.Fq)(),_meta:{lwt:0}};return o.docData=t,r&&(o.isResolvedConflict=r),o._meta.lwt=(0,H.t)(),o.id=(0,q.U)(e.input.metaInstance.schema,o),o._rev=(0,z.CM)(await e.checkpointKey,n),{previous:n,document:o}}async function ne(e){e.input.initialCheckpoint&&e.input.initialCheckpoint.downstream&&(await Q(e,"down")||await V(e,"down",e.input.initialCheckpoint.downstream));var n=await e.input.hashFunction(e.input.identifier),r=e.input.replicationHandler,i=0,o=[];function a(n){e.stats.down.addNewTask=e.stats.down.addNewTask+1;var a={time:i++,task:n};o.push(a),e.streamQueue.down=e.streamQueue.down.then((()=>{for(var n=[];o.length>0;){e.events.active.down.next(!0);var a=(0,t.ZN)(o.shift());if(!(a.time<u)){if("RESYNC"===a.task){if(0===n.length){n.push(a.task);break}break}n.push(a.task)}}if(0!==n.length)return"RESYNC"===n[0]?async function(){if(e.stats.down.downstreamResyncOnce=e.stats.down.downstreamResyncOnce+1,e.events.canceled.getValue())return;e.checkpointQueue=e.checkpointQueue.then((()=>Q(e,"down")));var t=await e.checkpointQueue,n=[];for(;!e.events.canceled.getValue();){u=i++;var o=await r.masterChangesSince(t,e.input.pullBatchSize);if(0===o.documents.length)break;if(t=(0,K.Mu)([t,o.checkpoint]),n.push(f(o.documents,t)),o.documents.length<e.input.pullBatchSize)break}await Promise.all(n)}():function(n){e.stats.down.downstreamProcessChanges=e.stats.down.downstreamProcessChanges+1;var r=[],i=null;return n.forEach((e=>{if("RESYNC"===e)throw new Error("SNH");(0,X.Hb)(r,e.documents),i=(0,K.Mu)([i,e.checkpoint])})),f(r,(0,t.ZN)(i))}(n)})).then((()=>{e.events.active.down.next(!1),e.firstSyncDone.down.getValue()||e.events.canceled.getValue()||e.firstSyncDone.down.next(!0)}))}if(a("RESYNC"),!e.events.canceled.getValue()){var s=r.masterChangeStream$.pipe((0,F.Z)((async t=>(await(0,E._)(e.events.active.up.pipe((0,g.p)((e=>!e)))),t)))).subscribe((t=>{e.stats.down.masterChangeStreamEmit=e.stats.down.masterChangeStreamEmit+1,a(t)}));(0,E._)(e.events.canceled.pipe((0,g.p)((e=>!!e)))).then((()=>s.unsubscribe()))}var u=-1;var c=U.em,h={docs:{}};function f(t,r){var i=e.primaryPath;return e.stats.down.persistFromMaster=e.stats.down.persistFromMaster+1,t.forEach((e=>{var t=e[i];h.docs[t]=e})),h.checkpoint=r,c=c.then((()=>{var t=h.docs;h.docs={};var r=h.checkpoint,o=Object.keys(t);if(e.events.canceled.getValue()||0===o.length)return U.em;var a=[],s={},u={},c=[];return Promise.all([e.input.forkInstance.findDocumentsById(o,!0),ee(e,o)]).then((([r,l])=>{var h=new Map;return r.forEach((e=>h.set(e[i],e))),Promise.all(o.map((async r=>{var i=h.get(r),o=i?Z(i,e.hasAttachments,!1):void 0,f=t[r],d=l[r];if(d&&i&&d.metaDocument.isResolvedConflict===i._rev)return U.em;var p=!(!d||!o)&&await e.input.conflictHandler({realMasterState:d.docData,newDocumentState:o},"downstream-check-if-equal-0").then((e=>e.isEqual));if(!p&&d&&d.docData._rev&&i&&i._meta[e.input.identifier]&&(0,z.Pp)(i._rev).height===i._meta[e.input.identifier]&&(p=!0),i&&d&&!1===p||i&&!d)return U.em;var m=!!o&&await e.input.conflictHandler({realMasterState:f,newDocumentState:o},"downstream-check-if-equal-1").then((e=>e.isEqual));if(o&&m)return d&&!1!==p||c.push(await te(e,o,d?d.metaDocument:void 0)),U.em;var y=Object.assign({},f,i?{_meta:(0,$.FD)(i._meta),_attachments:e.hasAttachments&&f._attachments?f._attachments:{},_rev:(0,W.Fq)()}:{_meta:{lwt:(0,H.t)()},_rev:(0,W.Fq)(),_attachments:e.hasAttachments&&f._attachments?f._attachments:{}});if(f._rev){var v=i?(0,z.Pp)(i._rev).height+1:1;y._meta[e.input.identifier]=v,e.input.keepMeta&&(y._rev=f._rev)}e.input.keepMeta&&f._meta&&(y._meta=f._meta);var g={previous:i,document:y};g.document._rev=g.document._rev?g.document._rev:(0,z.CM)(n,g.previous),a.push(g),s[r]=g,u[r]=await te(e,f,d?d.metaDocument:void 0)})))})).then((async()=>{if(a.length>0)return e.input.forkInstance.bulkWrite(a,await e.downstreamBulkWriteFlag).then((t=>{t.success.forEach((t=>{var n=t[i];e.events.processed.down.next(s[n]),c.push(u[n])})),t.error.forEach((t=>{409!==t.status&&e.events.error.next((0,l.Br)("RC_PULL",{writeError:t}))}))}))})).then((()=>{if(c.length>0)return e.input.metaInstance.bulkWrite(J(e,c),"replication-down-write-meta").then((t=>{t.error.forEach((t=>{e.events.error.next((0,l.Br)("RC_PULL",{id:t.documentId,writeError:t}))}))}))})).then((()=>{V(e,"down",r)}))})).catch((t=>e.events.error.next(t)))}}var re=i(7092);async function ie(e,n,r,i){if(!r._attachments||i&&!i._attachments)throw new Error("_attachments missing");var o=r[e],a=new Set(i&&i._attachments?Object.keys(i._attachments):[]);return await Promise.all(Object.entries(r._attachments).map((async([e,r])=>{if((!a.has(e)||i&&(0,t.ZN)(i._attachments)[e].digest!==r.digest)&&!r.data){var s=await n.getAttachmentData(o,e,r.digest);r.data=s}}))),r}async function oe(e){e.input.initialCheckpoint&&e.input.initialCheckpoint.upstream&&(await Q(e,"up")||await V(e,"up",e.input.initialCheckpoint.upstream));var n=e.input.replicationHandler;e.streamQueue.up=e.streamQueue.up.then((()=>c().then((()=>{l()}))));var r=0,i=-1,o=[],a=U.Dr,s={docs:{}},u=e.input.forkInstance.changeStream().subscribe((async t=>{if(t.context!==await e.downstreamBulkWriteFlag)return e.stats.up.forkChangeStreamEmit=e.stats.up.forkChangeStreamEmit+1,o.push({task:t,time:r++}),e.events.active.up.getValue()||e.events.active.up.next(!0),e.input.waitBeforePersist?e.input.waitBeforePersist().then((()=>l())):l()}));async function c(){if(e.stats.up.upstreamInitialSync=e.stats.up.upstreamInitialSync+1,!e.events.canceled.getValue()){e.checkpointQueue=e.checkpointQueue.then((()=>Q(e,"up")));for(var n=await e.checkpointQueue,o=new Set,a=async function(){i=r++,o.size>3&&await Promise.race(Array.from(o));var a=await(0,K.p0)(e.input.forkInstance,e.input.pushBatchSize,n);if(0===a.documents.length)return 1;n=(0,K.Mu)([n,a.checkpoint]);var s=h(a.documents,(0,t.ZN)(n));o.add(s),s.catch().then((()=>o.delete(s)))};!e.events.canceled.getValue()&&!await a(););(await Promise.all(o)).find((e=>!!e))?await c():e.firstSyncDone.up.getValue()||e.events.canceled.getValue()||e.firstSyncDone.up.next(!0)}}function l(){e.events.canceled.getValue()||0===o.length?e.events.active.up.next(!1):(e.stats.up.processTasks=e.stats.up.processTasks+1,e.events.active.up.next(!0),e.streamQueue.up=e.streamQueue.up.then((()=>{for(var n=[],r={};o.length>0;){var a=(0,t.ZN)(o.shift());a.time<i||((0,X.Hb)(n,a.task.events.map((e=>e.documentData))),r=(0,K.Mu)([r,a.task.checkpoint]))}return(0===n.length?U.Dr:h(n,r)).then((()=>{0===o.length?e.events.active.up.next(!1):l()}))})))}function h(r,i){return e.stats.up.persistToMaster=e.stats.up.persistToMaster+1,r.forEach((t=>{var n=t[e.primaryPath];s.docs[n]=t})),s.checkpoint=i,a=a.then((async()=>{if(e.events.canceled.getValue())return!1;var r=s.docs;s.docs={};var i=s.checkpoint,o=Object.keys(r);if(0===o.length)return!1;var a=await ee(e,o),u={},c=[],l={},h={};if(await Promise.all(o.map((async t=>{var n=r[t];h[t]=n;var i=Z(n,e.hasAttachments,!!e.input.keepMeta),o=a[t];o&&o.metaDocument.isResolvedConflict!==n._rev&&(await e.input.conflictHandler({realMasterState:o.docData,newDocumentState:i},"upstream-check-if-equal")).isEqual||o&&o.docData._rev&&(0,z.Pp)(n._rev).height===n._meta[e.input.identifier]||(c.push(t),u[t]={assumedMasterState:o?o.docData:void 0,newDocumentState:i},l[t]=await te(e,i,o?o.metaDocument:void 0))}))),0===c.length)return!1;var f=Object.values(u),d=new Set,p={},m=(0,X.Aj)(f,e.input.pushBatchSize);await Promise.all(m.map((async t=>{e.hasAttachments&&await Promise.all(t.map((async t=>{t.newDocumentState=await ie(e.primaryPath,e.input.forkInstance,(0,$.o8)(t.newDocumentState),t.assumedMasterState)}))),(await n.masterWrite(t)).forEach((t=>{var n=t[e.primaryPath];d.add(n),p[n]=t}))})));var y=[];if(c.forEach((t=>{d.has(t)||(e.events.processed.up.next(u[t]),y.push(l[t]))})),e.events.canceled.getValue())return!1;y.length>0&&await e.input.metaInstance.bulkWrite(J(e,y),"replication-up-write-meta");var v=!1;if(d.size>0){e.stats.up.persistToMasterHadConflicts=e.stats.up.persistToMasterHadConflicts+1;var g=[],b={};if(await Promise.all(Object.entries(p).map((([n,r])=>{var i=u[n],o={newDocumentState:i.newDocumentState,assumedMasterState:i.assumedMasterState,realMasterState:r};return(0,re.r)(e,o,h[n]).then((async i=>{if(i){e.events.resolvedConflicts.next({input:o,output:i.output}),g.push({previous:h[n],document:i.resolvedDoc});var s=a[n];b[n]=await te(e,(0,t.ZN)(r),s?s.metaDocument:void 0,i.resolvedDoc._rev)}}))}))),g.length>0){v=!0,e.stats.up.persistToMasterConflictWrites=e.stats.up.persistToMasterConflictWrites+1;var w=await e.input.forkInstance.bulkWrite(g,"replication-up-write-conflict"),_=[];w.success.forEach((t=>{var n=t[e.primaryPath];_.push(b[n])})),_.length>0&&await e.input.metaInstance.bulkWrite(J(e,_),"replication-up-write-conflict-meta")}}return V(e,"up",i),v})).catch((t=>(e.events.error.next(t),!1)))}(0,E._)(e.events.canceled.pipe((0,g.p)((e=>!!e)))).then((()=>u.unsubscribe()))}function ae(e){return(0,E._)(B([e.firstSyncDone.down.pipe((0,g.p)((e=>!!e))),e.firstSyncDone.up.pipe((0,g.p)((e=>!!e)))])).then((()=>{}))}function se(e){return Promise.all([e.streamQueue.up,e.streamQueue.down,e.checkpointQueue])}var ue=i(6250);Promise.resolve(!1);var ce=Promise.resolve(!0),le=Promise.resolve();function he(e,t){return e||(e=0),new Promise((function(n){return setTimeout((function(){return n(t)}),e)}))}function fe(){return Math.random().toString(36).substring(2)}var de=0;function pe(){var e=1e3*Date.now();return e<=de&&(e=de+1),de=e,e}var me=i(5606);var ye=i(5606),ve="[object process]"===Object.prototype.toString.call(void 0!==ye?ye:0)?function(e){me.on("exit",(function(){return e()})),me.on("beforeExit",(function(){return e().then((function(){return me.exit()}))})),me.on("SIGINT",(function(){return e().then((function(){return me.exit()}))})),me.on("uncaughtException",(function(t){return e().then((function(){console.trace(t),me.exit(101)}))}))}:function(e){if("function"==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope){var t=self.close.bind(self);self.close=function(){return e(),t()}}else{if("function"!=typeof window.addEventListener)return;window.addEventListener("beforeunload",(function(){e()}),!0),window.addEventListener("unload",(function(){e()}),!0)}},ge=new Set,be=!1;function we(e){if(be||(be=!0,ve(_e)),"function"!=typeof e)throw new Error("Listener is no function");return ge.add(e),{remove:function(){return ge.delete(e)},run:function(){return ge.delete(e),e()}}}function _e(){var e=[];return ge.forEach((function(t){e.push(t()),ge.delete(t)})),Promise.all(e)}function Ee(e,t){var n={context:"leader",action:t,token:e.token};return e.broadcastChannel.postInternal(n)}function ke(e){e.isLeader=!0,e._hasLeader=!0;var t=we((function(){return e.die()}));e._unl.push(t);var n=function(t){"leader"===t.context&&"apply"===t.action&&Ee(e,"tell"),"leader"!==t.context||"tell"!==t.action||e._dpLC||(e._dpLC=!0,e._dpL(),Ee(e,"tell"))};return e.broadcastChannel.addEventListener("internal",n),e._lstns.push(n),Ee(e,"tell")}var Se=function(e,t){var n=this;this.broadcastChannel=e,e._befC.push((function(){return n.die()})),this._options=t,this.isLeader=!1,this.isDead=!1,this.token=fe(),this._lstns=[],this._unl=[],this._dpL=function(){},this._dpLC=!1,this._wKMC={},this.lN="pubkey-bc||"+e.method.type+"||"+e.name};Se.prototype={hasLeader:function(){var e=this;return navigator.locks.query().then((function(t){var n=t.held?t.held.filter((function(t){return t.name===e.lN})):[];return!!(n&&n.length>0)}))},awaitLeadership:function(){var e=this;if(!this._wLMP){this._wKMC.c=new AbortController;var t=new Promise((function(t,n){e._wKMC.res=t,e._wKMC.rej=n}));this._wLMP=new Promise((function(n){navigator.locks.request(e.lN,{signal:e._wKMC.c.signal},(function(){return e._wKMC.c=void 0,ke(e),n(),t})).catch((function(){}))}))}return this._wLMP},set onduplicate(e){},die:function(){var e=this;return this._lstns.forEach((function(t){return e.broadcastChannel.removeEventListener("internal",t)})),this._lstns=[],this._unl.forEach((function(e){return e.remove()})),this._unl=[],this.isLeader&&(this.isLeader=!1),this.isDead=!0,this._wKMC.res&&this._wKMC.res(),this._wKMC.c&&this._wKMC.c.abort("LeaderElectionWebLock.die() called"),Ee(this,"death")}};var xe=function(e,t){var n=this;this.broadcastChannel=e,this._options=t,this.isLeader=!1,this._hasLeader=!1,this.isDead=!1,this.token=fe(),this._aplQ=le,this._aplQC=0,this._unl=[],this._lstns=[],this._dpL=function(){},this._dpLC=!1;var r=function(e){"leader"===e.context&&("death"===e.action&&(n._hasLeader=!1),"tell"===e.action&&(n._hasLeader=!0))};this.broadcastChannel.addEventListener("internal",r),this._lstns.push(r)};function Ce(e,t){if(e._leaderElector)throw new Error("BroadcastChannel already has a leader-elector");t=function(e,t){return e||(e={}),(e=JSON.parse(JSON.stringify(e))).fallbackInterval||(e.fallbackInterval=3e3),e.responseTime||(e.responseTime=t.method.averageResponseTime(t.options)),e}(t,e);var n="undefined"!=typeof navigator&&void 0!==navigator.locks&&"function"==typeof navigator.locks.request?new Se(e,t):new xe(e,t);return e._befC.push((function(){return n.die()})),e._leaderElector=n,n}xe.prototype={hasLeader:function(){return Promise.resolve(this._hasLeader)},applyOnce:function(e){var t=this;if(this.isLeader)return he(0,!0);if(this.isDead)return he(0,!1);if(this._aplQC>1)return this._aplQ;return this._aplQC=this._aplQC+1,this._aplQ=this._aplQ.then((function(){return function(){if(t.isLeader)return ce;var n,r=!1,i=new Promise((function(e){n=function(){r=!0,e()}})),o=function(e){"leader"===e.context&&e.token!=t.token&&("apply"===e.action&&e.token>t.token&&n(),"tell"===e.action&&(n(),t._hasLeader=!0))};t.broadcastChannel.addEventListener("internal",o);var a=e?4*t._options.responseTime:t._options.responseTime;return Ee(t,"apply").then((function(){return Promise.race([he(a),i.then((function(){return Promise.reject(new Error)}))])})).then((function(){return Ee(t,"apply")})).then((function(){return Promise.race([he(a),i.then((function(){return Promise.reject(new Error)}))])})).catch((function(){})).then((function(){return t.broadcastChannel.removeEventListener("internal",o),!r&&ke(t).then((function(){return!0}))}))}()})).then((function(){t._aplQC=t._aplQC-1})),this._aplQ.then((function(){return t.isLeader}))},awaitLeadership:function(){return this._aLP||(this._aLP=function(e){if(e.isLeader)return le;return new Promise((function(t){var n=!1;function r(){n||(n=!0,e.broadcastChannel.removeEventListener("internal",i),t(!0))}e.applyOnce().then((function(){e.isLeader&&r()})),function t(){return he(e._options.fallbackInterval).then((function(){if(!e.isDead&&!n)return e.isLeader?void r():e.applyOnce(!0).then((function(){e.isLeader?r():t()}))}))}();var i=function(t){"leader"===t.context&&"death"===t.action&&(e._hasLeader=!1,e.applyOnce().then((function(){e.isLeader&&r()})))};e.broadcastChannel.addEventListener("internal",i),e._lstns.push(i)}))}(this)),this._aLP},set onduplicate(e){this._dpL=e},die:function(){var e=this;return this._lstns.forEach((function(t){return e.broadcastChannel.removeEventListener("internal",t)})),this._lstns=[],this._unl.forEach((function(e){return e.remove()})),this._unl=[],this.isLeader&&(this._hasLeader=!1,this.isLeader=!1),this.isDead=!0,Ee(this,"death")}};var Oe=i(2908),Re=Array.isArray;var Ie=i(3031);function Pe(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=(0,j.lI)(e),r=(0,j.R0)(e,1/0);return e=function(e){return 1===e.length&&Re(e[0])?e[0]:e}(e),(0,Oe.N)((function(t,i){(0,Ie.U)(r)((0,I.H)((0,D.fX)([t],(0,D.zs)(e)),n)).subscribe(i)}))}var De={create:function(e){var t={time:pe(),messagesCallback:null,bc:new BroadcastChannel(e),subFns:[]};return t.bc.onmessage=function(e){t.messagesCallback&&t.messagesCallback(e.data)},t},close:function(e){e.bc.close(),e.subFns=[]},onMessage:function(e,t){e.messagesCallback=t},postMessage:function(e,t){try{return e.bc.postMessage(t,!1),le}catch(e){return Promise.reject(e)}},canBeUsed:function(){if("undefined"!=typeof globalThis&&globalThis.Deno&&globalThis.Deno.args)return!0;if("undefined"==typeof window&&"undefined"==typeof self||"function"!=typeof BroadcastChannel)return!1;if(BroadcastChannel._pubkey)throw new Error("BroadcastChannel: Do not overwrite window.BroadcastChannel with this module, this is not a polyfill");return!0},type:"native",averageResponseTime:function(){return 150},microSeconds:pe},Te=i(1779);function Ae(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=JSON.parse(JSON.stringify(e));return void 0===t.webWorkerSupport&&(t.webWorkerSupport=!0),t.idb||(t.idb={}),t.idb.ttl||(t.idb.ttl=45e3),t.idb.fallbackInterval||(t.idb.fallbackInterval=150),e.idb&&"function"==typeof e.idb.onclose&&(t.idb.onclose=e.idb.onclose),t.localstorage||(t.localstorage={}),t.localstorage.removeTimeout||(t.localstorage.removeTimeout=6e4),e.methods&&(t.methods=e.methods),t.node||(t.node={}),t.node.ttl||(t.node.ttl=12e4),t.node.maxParallelWrites||(t.node.maxParallelWrites=2048),void 0===t.node.useFastPath&&(t.node.useFastPath=!0),t}var je="pubkey.broadcast-channel-0-",Ne="messages",Me={durability:"relaxed"};function Be(){if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof window){if(void 0!==window.mozIndexedDB)return window.mozIndexedDB;if(void 0!==window.webkitIndexedDB)return window.webkitIndexedDB;if(void 0!==window.msIndexedDB)return window.msIndexedDB}return!1}function Le(e){e.commit&&e.commit()}function Fe(e,t){var n=e.transaction(Ne,"readonly",Me),r=n.objectStore(Ne),i=[],o=IDBKeyRange.bound(t+1,1/0);if(r.getAll){var a=r.getAll(o);return new Promise((function(e,t){a.onerror=function(e){return t(e)},a.onsuccess=function(t){e(t.target.result)}}))}return new Promise((function(e,a){var s=function(){try{return o=IDBKeyRange.bound(t+1,1/0),r.openCursor(o)}catch(e){return r.openCursor()}}();s.onerror=function(e){return a(e)},s.onsuccess=function(r){var o=r.target.result;o?o.value.id<t+1?o.continue(t+1):(i.push(o.value),o.continue()):(Le(n),e(i))}}))}function qe(e){return(t=e.db,n=e.options.idb.ttl,r=Date.now()-n,i=t.transaction(Ne,"readonly",Me),o=i.objectStore(Ne),a=[],new Promise((function(e){o.openCursor().onsuccess=function(t){var n=t.target.result;if(n){var o=n.value;o.time<r?(a.push(o),n.continue()):(Le(i),e(a))}else e(a)}}))).then((function(t){return function(e,t){if(e.closed)return Promise.resolve([]);var n=e.db.transaction(Ne,"readwrite",Me).objectStore(Ne);return Promise.all(t.map((function(e){var t=n.delete(e);return new Promise((function(e){t.onsuccess=function(){return e()}}))})))}(e,t.map((function(e){return e.id})))}));var t,n,r,i,o,a}function $e(e){e.closed||Ue(e).then((function(){return he(e.options.idb.fallbackInterval)})).then((function(){return $e(e)}))}function Ue(e){return e.closed?le:e.messagesCallback?Fe(e.db,e.lastCursorId).then((function(t){var n=t.filter((function(e){return!!e})).map((function(t){return t.id>e.lastCursorId&&(e.lastCursorId=t.id),t})).filter((function(t){return function(e,t){return!(e.uuid===t.uuid||t.eMIs.has(e.id)||e.data.time<t.messagesCallbackTime)}(t,e)})).sort((function(e,t){return e.time-t.time}));return n.forEach((function(t){e.messagesCallback&&(e.eMIs.add(t.id),e.messagesCallback(t.data))})),le})):le}var Ke={create:function(e,t){return t=Ae(t),function(e){var t=Be(),n=je+e,r=t.open(n);return r.onupgradeneeded=function(e){e.target.result.createObjectStore(Ne,{keyPath:"id",autoIncrement:!0})},new Promise((function(e,t){r.onerror=function(e){return t(e)},r.onsuccess=function(){e(r.result)}}))}(e).then((function(n){var r={closed:!1,lastCursorId:0,channelName:e,options:t,uuid:fe(),eMIs:new Te.p4(2*t.idb.ttl),writeBlockPromise:le,messagesCallback:null,readQueuePromises:[],db:n};return n.onclose=function(){r.closed=!0,t.idb.onclose&&t.idb.onclose()},$e(r),r}))},close:function(e){e.closed=!0,e.db.close()},onMessage:function(e,t,n){e.messagesCallbackTime=n,e.messagesCallback=t,Ue(e)},postMessage:function(e,t){return e.writeBlockPromise=e.writeBlockPromise.then((function(){return function(e,t,n){var r={uuid:t,time:Date.now(),data:n},i=e.transaction([Ne],"readwrite",Me);return new Promise((function(e,t){i.oncomplete=function(){return e()},i.onerror=function(e){return t(e)},i.objectStore(Ne).add(r),Le(i)}))}(e.db,e.uuid,t)})).then((function(){var t,n;0===(t=0,n=10,Math.floor(Math.random()*(n-t+1)+t))&&qe(e)})),e.writeBlockPromise},canBeUsed:function(){return!!Be()},type:"idb",averageResponseTime:function(e){return 2*e.idb.fallbackInterval},microSeconds:pe},We="pubkey.broadcastChannel-";function He(){var e;if("undefined"==typeof window)return null;try{e=window.localStorage,e=window["ie8-eventlistener/storage"]||window.localStorage}catch(e){}return e}function ze(e){return We+e}function Qe(){var e=He();if(!e)return!1;try{var t="__broadcastchannel_check";e.setItem(t,"works"),e.removeItem(t)}catch(e){return!1}return!0}var Ve={create:function(e,t){if(t=Ae(t),!Qe())throw new Error("BroadcastChannel: localstorage cannot be used");var n=fe(),r=new Te.p4(t.localstorage.removeTimeout),i={channelName:e,uuid:n,eMIs:r};return i.listener=function(e,t){var n=ze(e),r=function(e){e.key===n&&t(JSON.parse(e.newValue))};return window.addEventListener("storage",r),r}(e,(function(e){i.messagesCallback&&e.uuid!==n&&e.token&&!r.has(e.token)&&(e.data.time&&e.data.time<i.messagesCallbackTime||(r.add(e.token),i.messagesCallback(e.data)))})),i},close:function(e){var t;t=e.listener,window.removeEventListener("storage",t)},onMessage:function(e,t,n){e.messagesCallbackTime=n,e.messagesCallback=t},postMessage:function(e,t){return new Promise((function(n){he().then((function(){var r=ze(e.channelName),i={token:fe(),time:Date.now(),data:t,uuid:e.uuid},o=JSON.stringify(i);He().setItem(r,o);var a=document.createEvent("Event");a.initEvent("storage",!0,!0),a.key=r,a.newValue=o,window.dispatchEvent(a),n()}))}))},canBeUsed:Qe,type:"localstorage",averageResponseTime:function(){var e=navigator.userAgent.toLowerCase();return e.includes("safari")&&!e.includes("chrome")?240:120},microSeconds:pe},Xe=pe,Ye=new Set;var Ze={create:function(e){var t={time:Xe(),name:e,messagesCallback:null};return Ye.add(t),t},close:function(e){Ye.delete(e)},onMessage:function(e,t){e.messagesCallback=t},postMessage:function(e,t){return new Promise((function(n){return setTimeout((function(){Array.from(Ye).forEach((function(n){n.name===e.name&&n!==e&&n.messagesCallback&&n.time<t.time&&n.messagesCallback(t)})),n()}),5)}))},canBeUsed:function(){return!0},type:"simulate",averageResponseTime:function(){return 5},microSeconds:Xe},Je=[De,Ke,Ve];var Ge,et=new Set,tt=0,nt=function(e,t){var n,r,i;this.id=tt++,et.add(this),this.name=e,Ge&&(t=Ge),this.options=Ae(t),this.method=function(e){var t=[].concat(e.methods,Je).filter(Boolean);if(e.type){if("simulate"===e.type)return Ze;var n=t.find((function(t){return t.type===e.type}));if(n)return n;throw new Error("method-type "+e.type+" not found")}e.webWorkerSupport||(t=t.filter((function(e){return"idb"!==e.type})));var r=t.find((function(e){return e.canBeUsed()}));if(r)return r;throw new Error("No usable method found in "+JSON.stringify(Je.map((function(e){return e.type}))))}(this.options),this._iL=!1,this._onML=null,this._addEL={message:[],internal:[]},this._uMP=new Set,this._befC=[],this._prepP=null,r=(n=this).method.create(n.name,n.options),(i=r)&&"function"==typeof i.then?(n._prepP=r,r.then((function(e){n._state=e}))):n._state=r};function rt(e,t,n){var r={time:e.method.microSeconds(),type:t,data:n};return(e._prepP?e._prepP:le).then((function(){var t=e.method.postMessage(e._state,r);return e._uMP.add(t),t.catch().then((function(){return e._uMP.delete(t)})),t}))}function it(e){return e._addEL.message.length>0||e._addEL.internal.length>0}function ot(e,t,n){e._addEL[t].push(n),function(e){if(!e._iL&&it(e)){var t=function(t){e._addEL[t.type].forEach((function(e){t.time>=e.time&&e.fn(t.data)}))},n=e.method.microSeconds();e._prepP?e._prepP.then((function(){e._iL=!0,e.method.onMessage(e._state,t,n)})):(e._iL=!0,e.method.onMessage(e._state,t,n))}}(e)}function at(e,t,n){e._addEL[t]=e._addEL[t].filter((function(e){return e!==n})),function(e){if(e._iL&&!it(e)){e._iL=!1;var t=e.method.microSeconds();e.method.onMessage(e._state,null,t)}}(e)}nt._pubkey=!0,nt.prototype={postMessage:function(e){if(this.closed)throw new Error("BroadcastChannel.postMessage(): Cannot post message after channel has closed "+JSON.stringify(e));return rt(this,"message",e)},postInternal:function(e){return rt(this,"internal",e)},set onmessage(e){var t={time:this.method.microSeconds(),fn:e};at(this,"message",this._onML),e&&"function"==typeof e?(this._onML=t,ot(this,"message",t)):this._onML=null},addEventListener:function(e,t){ot(this,e,{time:this.method.microSeconds(),fn:t})},removeEventListener:function(e,t){at(this,e,this._addEL[e].find((function(e){return e.fn===t})))},close:function(){var e=this;if(!this.closed){et.delete(this),this.closed=!0;var t=this._prepP?this._prepP:le;return this._onML=null,this._addEL.message=[],t.then((function(){return Promise.all(Array.from(e._uMP))})).then((function(){return Promise.all(e._befC.map((function(e){return e()})))})).then((function(){return e.method.close(e._state)}))}},get type(){return this.method.type},get isClosed(){return this.closed}};var st=new Map;function ut(e,t,n,r){var i=st.get(t);return i||(i={bc:new nt(["RxDB:",e,n].join("|")),refs:new Set},st.set(t,i)),i.refs.add(r),i.bc}function ct(e,t){var n=st.get(e);if(n)return n.refs.delete(t),0===n.refs.size?(st.delete(e),n.bc.close()):void 0}function lt(e,t,n,r){if(t.multiInstance){var i=r||ut(e,t.databaseInstanceToken,n.databaseName,n),o=new _.B,a=n=>{n.storageName===e&&n.databaseName===t.databaseName&&n.collectionName===t.collectionName&&n.version===t.schema.version&&o.next(n.eventBulk)};i.addEventListener("message",a);var s=n.changeStream(),u=!1,c=s.subscribe((n=>{u||i.postMessage({storageName:e,databaseName:t.databaseName,collectionName:t.collectionName,version:t.schema.version,eventBulk:n})}));n.changeStream=function(){return o.asObservable().pipe(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Pe.apply(void 0,(0,D.fX)([],(0,D.zs)(e)))}(s))};var l=n.close.bind(n);n.close=async function(){return u=!0,c.unsubscribe(),i.removeEventListener("message",a),r||await ct(t.databaseInstanceToken,n),l()};var h=n.remove.bind(n);n.remove=async function(){return u=!0,c.unsubscribe(),i.removeEventListener("message",a),r||await ct(t.databaseInstanceToken,n),h()}}}var ht=new WeakMap,ft=new WeakMap;function dt(e){return(0,ue.q)(ft,e,(()=>Ce(e)))}function pt(){var e=ut(this.storage.name,this.token,this.name,this),t=this.destroy.bind(this);this.destroy=function(){return ct(this.token,this),t()};var n=dt(e);return n||(n=dt(e),ht.set(this,n)),this.leaderElector=()=>n,n}function mt(){return!this.multiInstance||this.leaderElector().isLeader}function yt(){return this.multiInstance?this.leaderElector().awaitLeadership().then((()=>!0)):U.Ms}var vt={name:"leader-election",rxdb:!0,prototypes:{RxDatabase:e=>{e.leaderElector=pt,e.isLeader=mt,e.waitForLeadership=yt}},hooks:{preDestroyRxDatabase:{after:function(e){var t=ht.get(e);t&&t.die()}}}},gt=i(4034),bt=e=>Promise.resolve(e);function wt(e,t){if("_deleted"===e)return t;var n=!!(t=(0,$.FD)(t))._deleted;return t[e]=n,delete t._deleted,t}function _t(e,t,n){return n.map((n=>{var r=(0,$.FD)(n);if("_deleted"!==t){var i=!!r[t];r._deleted=i,delete r[t]}else r._deleted=!!r._deleted;return r[e.schema.primaryPath]=(0,q.U)(e.schema.jsonSchema,r),r}))}function Et(e,t){if("undefined"==typeof window||"object"!=typeof window||void 0===window.addEventListener||navigator.onLine)return e.promiseWait(t);var n,r=new Promise((e=>{n=()=>{window.removeEventListener("online",n),e()},window.addEventListener("online",n)}));return Promise.race([r,e.promiseWait(t)]).then((()=>{window.removeEventListener("online",n)}))}var kt=i(467),St=new WeakMap,xt=function(){function e(e,t,n,r,i,o,a,s){this.subs=[],this.subjects={received:new _.B,sent:new _.B,error:new _.B,canceled:new w.t(!1),active:new w.t(!1)},this.received$=this.subjects.received.asObservable(),this.sent$=this.subjects.sent.asObservable(),this.error$=this.subjects.error.asObservable(),this.canceled$=this.subjects.canceled.asObservable(),this.active$=this.subjects.active.asObservable(),this.onCancel=[],this.callOnStart=void 0,this.remoteEvents$=new _.B,this.replicationIdentifier=e,this.collection=t,this.deletedField=n,this.pull=r,this.push=i,this.live=o,this.retryTime=a,this.autoStart=s,(0,ue.q)(St,t,(()=>[])).push(this),this.collection.onDestroy.push((()=>this.cancel())),Object.keys(this.subjects).forEach((e=>{Object.defineProperty(this,e+"$",{get:function(){return this.subjects[e].asObservable()}})}));var u=new Promise((e=>{this.callOnStart=e}));this.startPromise=u}var n=e.prototype;return n.start=async function(){if(!this.isStopped()){var e,n,r,i,o=this.pull&&this.pull.modifier?this.pull.modifier:bt,a=this.push&&this.push.modifier?this.push.modifier:bt,s=this.collection.database,h="rx-replication-meta-"+await s.hashFunction([this.collection.name,this.replicationIdentifier].join("-")),f=(e=this.collection.schema.jsonSchema,n=(0,K.ME)(this.collection.schema.jsonSchema),r=(0,q.Hq)(e),i={title:"RxReplicationProtocolMetaData",primaryKey:{key:"id",fields:["itemId","isCheckpoint"],separator:"|"},type:"object",version:e.version,additionalProperties:!1,properties:{id:{type:"string",minLength:1,maxLength:r+2},isCheckpoint:{type:"string",enum:["0","1"],minLength:1,maxLength:1},itemId:{type:"string",maxLength:r>4?r:4},checkpointData:{type:"object",additionalProperties:!0},docData:{type:"object",properties:e.properties},isResolvedConflict:{type:"string"}},keyCompression:e.keyCompression,required:["id","isCheckpoint","itemId"]},n&&(i.encrypted=["docData"]),(0,q.Ud)(i)),[d]=await Promise.all([this.collection.database.storage.createStorageInstance({databaseName:s.name,collectionName:h,databaseInstanceToken:s.token,multiInstance:s.multiInstance,options:{},schema:f,password:s.password,devMode:u.h.isDevMode()}),(0,kt.vV)(this.collection,h,f)]);this.metaInstance=d,this.internalReplicationState=function(e){(e=(0,$.FD)(e)).forkInstance=G(e.forkInstance),e.metaInstance=G(e.metaInstance);var t=async function(e){return"rx_storage_replication_"+await e.hashFunction([e.identifier,e.forkInstance.databaseName,e.forkInstance.collectionName].join("||"))}(e),n={primaryPath:(0,q.xQ)(e.forkInstance.schema.primaryKey),hasAttachments:!!e.forkInstance.schema.attachments,input:e,checkpointKey:t,downstreamBulkWriteFlag:t.then((e=>"replication-downstream-"+e)),events:{canceled:new w.t(!1),active:{down:new w.t(!0),up:new w.t(!0)},processed:{down:new _.B,up:new _.B},resolvedConflicts:new _.B,error:new _.B},stats:{down:{addNewTask:0,downstreamProcessChanges:0,downstreamResyncOnce:0,masterChangeStreamEmit:0,persistFromMaster:0},up:{forkChangeStreamEmit:0,persistToMaster:0,persistToMasterConflictWrites:0,persistToMasterHadConflicts:0,processTasks:0,upstreamInitialSync:0}},firstSyncDone:{down:new w.t(!1),up:new w.t(!1)},streamQueue:{down:U.em,up:U.em},checkpointQueue:U.em,lastCheckpointDoc:{}};return ne(n),oe(n),n}({pushBatchSize:this.push&&this.push.batchSize?this.push.batchSize:100,pullBatchSize:this.pull&&this.pull.batchSize?this.pull.batchSize:100,initialCheckpoint:{upstream:this.push?this.push.initialCheckpoint:void 0,downstream:this.pull?this.pull.initialCheckpoint:void 0},forkInstance:this.collection.storageInstance,metaInstance:this.metaInstance,hashFunction:s.hashFunction,identifier:"rxdbreplication"+this.replicationIdentifier,conflictHandler:this.collection.conflictHandler,replicationHandler:{masterChangeStream$:this.remoteEvents$.asObservable().pipe((0,g.p)((e=>!!this.pull)),(0,F.Z)((async e=>{if("RESYNC"===e)return e;var t=(0,$.FD)(e);return t.documents=_t(this.collection,this.deletedField,t.documents),t.documents=await Promise.all(t.documents.map((e=>o(e)))),t}))),masterChangesSince:async(e,n)=>{if(!this.pull)return{checkpoint:null,documents:[]};for(var r=!1,i={};!r&&!this.isStopped();)try{i=await this.pull.handler(e,n),r=!0}catch(n){var a=(0,l.Br)("RC_PULL",{checkpoint:e,errors:(0,X.$r)(n).map((e=>(0,gt.S)(e))),direction:"pull"});this.subjects.error.next(a),await Et(this.collection,(0,t.ZN)(this.retryTime))}if(this.isStopped())return{checkpoint:null,documents:[]};var s=(0,$.FD)(i);return s.documents=_t(this.collection,this.deletedField,s.documents),s.documents=await Promise.all(s.documents.map((e=>o(e)))),s},masterWrite:async e=>{if(!this.push)return[];var n=!1;await(0,c.FX)("preReplicationMasterWrite",{rows:e,collection:this.collection});var r=(await Promise.all(e.map((async e=>(e.newDocumentState=await a(e.newDocumentState),null===e.newDocumentState?null:(e.assumedMasterState&&(e.assumedMasterState=await a(e.assumedMasterState)),"_deleted"!==this.deletedField&&(e.newDocumentState=wt(this.deletedField,e.newDocumentState),e.assumedMasterState&&(e.assumedMasterState=wt(this.deletedField,e.assumedMasterState))),e)))))).filter(X.S7),i=null;for(0===r.length&&(n=!0,i=[]);!n&&!this.isStopped();)try{if(i=await this.push.handler(r),!Array.isArray(i))throw(0,l.Br)("RC_PUSH_NO_AR",{pushRows:e,direction:"push",args:{result:i}});n=!0}catch(n){var o=n.rxdb?n:(0,l.Br)("RC_PUSH",{pushRows:e,errors:(0,X.$r)(n).map((e=>(0,gt.S)(e))),direction:"push"});this.subjects.error.next(o),await Et(this.collection,(0,t.ZN)(this.retryTime))}return this.isStopped()?[]:(await(0,c.FX)("preReplicationMasterWriteDocumentsHandle",{result:i,collection:this.collection}),_t(this.collection,this.deletedField,(0,t.ZN)(i)))}}}),this.subs.push(this.internalReplicationState.events.error.subscribe((e=>{this.subjects.error.next(e)})),this.internalReplicationState.events.processed.down.subscribe((e=>this.subjects.received.next(e.document))),this.internalReplicationState.events.processed.up.subscribe((e=>{this.subjects.sent.next(e.newDocumentState)})),B([this.internalReplicationState.events.active.down,this.internalReplicationState.events.active.up]).subscribe((([e,t])=>{var n=e||t;this.subjects.active.next(n)}))),this.pull&&this.pull.stream$&&this.live&&this.subs.push(this.pull.stream$.subscribe({next:e=>{this.remoteEvents$.next(e)},error:e=>{this.subjects.error.next(e)}})),this.live||(await ae(this.internalReplicationState),await se(this.internalReplicationState),await this.cancel()),this.callOnStart()}},n.isStopped=function(){return!!this.subjects.canceled.getValue()},n.awaitInitialReplication=async function(){return await this.startPromise,ae((0,t.ZN)(this.internalReplicationState))},n.awaitInSync=async function(){await this.startPromise,await ae((0,t.ZN)(this.internalReplicationState));for(var e=2;e>0;)e--,await this.collection.database.requestIdlePromise(),await se((0,t.ZN)(this.internalReplicationState));return!0},n.reSync=function(){this.remoteEvents$.next("RESYNC")},n.emitEvent=function(e){this.remoteEvents$.next(e)},n.cancel=async function(){if(this.isStopped())return U.Dr;var e=this.onCancel.map((e=>(0,U.hq)(e())));return this.internalReplicationState&&await async function(e){e.events.canceled.next(!0),e.events.active.up.complete(),e.events.active.down.complete(),e.events.processed.up.complete(),e.events.processed.down.complete(),e.events.resolvedConflicts.complete(),e.events.canceled.complete(),await e.checkpointQueue}(this.internalReplicationState),this.metaInstance&&e.push((0,t.ZN)(this.internalReplicationState).checkpointQueue.then((()=>(0,t.ZN)(this.metaInstance).close()))),this.subs.forEach((e=>e.unsubscribe())),this.subjects.canceled.next(!0),this.subjects.active.complete(),this.subjects.canceled.complete(),this.subjects.error.complete(),this.subjects.received.complete(),this.subjects.sent.complete(),Promise.all(e)},e}();function Ct({replicationIdentifier:e,collection:t,deletedField:n="_deleted",pull:r,push:i,live:o=!0,retryTime:a=5e3,waitForLeadership:s=!0,autoStart:u=!0}){if(p(vt),!r&&!i)throw(0,l.Br)("UT3",{collection:t.name,args:{replicationIdentifier:e}});var c=new xt(e,t,n,r,i,o,a,u);return function(e,t){var n=e&&t.collection.database.multiInstance,r=n?t.collection.database.waitForLeadership():U.Ms;r.then((()=>{t.isStopped()||t.autoStart&&t.start()}))}(s,c),c}function Ot(e,t,n){var r=n.id,i=(0,E._)(e.response$.pipe((0,g.p)((e=>e.peer===t)),(0,g.p)((e=>e.response.id===r)),(0,b.T)((e=>e.response))));return e.send(t,n),i}var Rt=function(){function e(e,n,r){this.peerStates$=new w.t(new Map),this.canceled=!1,this.subs=[],this.error$=new _.B,this.collection=e,this.options=n,this.connectionHandler=r,this.collection.onDestroy.push((()=>this.cancel())),this.masterReplicationHandler=function(e,n,r,i=!1){var o=!!(e=G(e)).schema.attachments,a=(0,q.xQ)(e.schema.primaryKey),s={masterChangeStream$:e.changeStream().pipe((0,F.Z)((async t=>({checkpoint:t.checkpoint,documents:await Promise.all(t.events.map((async t=>{var n=Z(t.documentData,o,i);return o&&(n=await ie(a,e,(0,$.o8)(n),void 0)),n})))})))),masterChangesSince:(t,n)=>(0,K.p0)(e,n,t).then((async n=>({checkpoint:n.documents.length>0?n.checkpoint:t,documents:await Promise.all(n.documents.map((async t=>{var n=Z(t,o,i);return o&&(n=await ie(a,e,(0,$.o8)(n),void 0)),n})))}))),async masterWrite(s){var u={};s.forEach((e=>{var t=e.newDocumentState[a];u[t]=e}));var c=Object.keys(u),l=await e.findDocumentsById(c,!0),h=new Map;l.forEach((e=>h.set(e[a],e)));var f=[],d=[];return await Promise.all(Object.entries(u).map((async([e,a])=>{var s=h.get(e);s?s&&!a.assumedMasterState?f.push(Z(s,o,i)):!0===(await n({realMasterState:Z(s,o,i),newDocumentState:(0,t.ZN)(a.assumedMasterState)},"rxStorageInstanceToReplicationHandler-masterWrite")).isEqual?d.push({previous:s,document:Y(r,o,i,a.newDocumentState,s)}):f.push(Z(s,o,i)):d.push({document:Y(r,o,i,a.newDocumentState)})}))),d.length>0&&(await e.bulkWrite(d,"replication-master-write")).error.forEach((e=>{if(409!==e.status)throw new Error("non conflict error");f.push(Z((0,t.ZN)(e.documentInDb),o,i))})),f}};return s}(e.storageInstance,e.conflictHandler,e.database.token)}var n=e.prototype;return n.addPeer=function(e,t){var n={peer:e,replicationState:t,subs:[]};this.peerStates$.next(this.peerStates$.getValue().set(e,n)),t&&n.subs.push(t.error$.subscribe((e=>this.error$.next(e))))},n.removePeer=function(e){var t=(0,ue.m)(this.peerStates$.getValue(),e);this.peerStates$.getValue().delete(e),this.peerStates$.next(this.peerStates$.getValue()),t.subs.forEach((e=>e.unsubscribe())),t.replicationState&&t.replicationState.cancel()},n.awaitFirstPeer=function(){return(0,E._)(this.peerStates$.pipe((0,g.p)((e=>e.size>0))))},n.cancel=async function(){this.canceled||(this.canceled=!0,this.subs.forEach((e=>e.unsubscribe())),Array.from(this.peerStates$.getValue().keys()).forEach((e=>{this.removePeer(e)})),await this.connectionHandler.destroy())},e}(),It=i(1770),Pt=i(5606);function Dt(e,t){e.send(JSON.stringify(t))}var Tt="signaling.rxdb.info",At="wss://"+Tt+"/",jt=!1;function Nt({signalingServerUrl:n,wrtc:r,webSocketConstructor:i}){!function(){if(void 0===Pt||"function"!=typeof Pt.nextTick)throw(0,l.Br)("RC7")}(),n=n||At,i=i||WebSocket,n.includes(Tt)&&!jt&&(jt=!0,console.warn(["RxDB Warning: You are using the RxDB WebRTC replication plugin","but you did not specify your own signaling server url.","By default it will use a signaling server provided by RxDB at "+At,"This server is made for demonstration purposes and tryouts. It is not reliable and might be offline at any time.","In production you must always use your own signaling server instead.","Learn how to run your own server at https://rxdb.info/replication-webrtc.html","Also leave a  at the RxDB github repo  https://github.com/pubkey/rxdb "].join(" ")));return async o=>{var a,s=new _.B,u=new _.B,c=new _.B,h=new _.B,f=new _.B,d=new Map,p=!1,m=void 0;return function y(){if(p)return;(m=new i(n)).onclose=()=>y(),m.onopen=()=>{(0,t.ZN)(m).onmessage=n=>{var i=JSON.parse(n.data);switch(i.type){case"init":a=i.yourPeerId,Dt((0,t.ZN)(m),{type:"join",room:o.topic});break;case"joined":var p=function(n){var i=!1,y=new It({initiator:n>a,wrtc:r,trickle:!0});y.id=(0,e.z3)(10),d.set(n,y),y.on("signal",(e=>{Dt((0,t.ZN)(m),{type:"signal",senderPeerId:a,receiverPeerId:n,room:o.topic,data:e})})),y.on("data",(e=>{(e=JSON.parse(e.toString())).result?h.next({peer:y,response:e}):c.next({peer:y,message:e})})),y.on("error",(e=>{f.next((0,l.Br)("RC_WEBRTC_PEER",{error:e})),y.destroy(),i||(i=!0,u.next(y))})),y.on("connect",(()=>{s.next(y)})),y.on("close",(()=>{i||(i=!0,u.next(y)),p(n)}))};i.otherPeerIds.forEach((e=>{e===a||d.has(e)||p(e)}));break;case"signal":(0,ue.m)(d,i.senderPeerId).signal(i.data)}}}}(),(async()=>{for(;await(0,U.ND)(6e4),!p;)m&&Dt(m,{type:"ping"})})(),{error$:f,connect$:s,disconnect$:u,message$:c,response$:h,async send(e,t){await e.send(JSON.stringify(t))},destroy:()=>(p=!0,(0,t.ZN)(m).close(),f.complete(),s.complete(),u.complete(),c.complete(),h.complete(),U.em)}}}var Mt=i(3744);const Bt=Symbol.for("Dexie"),Lt=globalThis[Bt]||(globalThis[Bt]=Mt);if(Mt.semVer!==Lt.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Mt.semVer} and ${Lt.semVer}`);const{liveQuery:Ft,mergeRanges:qt,rangesOverlap:$t,RangeSet:Ut,cmp:Kt,Entity:Wt,PropModSymbol:Ht,PropModification:zt,replacePrefix:Qt}=Lt;var Vt=i(9101),Xt="docs",Yt="changes",Zt="attachments",Jt="dexie",Gt=new Map,en=new Map;var tn="__";function nn(e){var t=e.split(".");if(t.length>1)return t.map((e=>nn(e))).join(".");if(e.startsWith("|")){var n=e.substring(1);return tn+n}return e}function rn(e){var t=e.split(".");return t.length>1?t.map((e=>rn(e))).join("."):e.startsWith(tn)?"|"+e.substring(tn.length):e}function on(e,t){return t?(t=sn(t=(0,$.FD)(t)),e.forEach((e=>{var n=(0,Vt.UU)(t,e)?"1":"0";(0,Vt.oq)(t,e,n)})),t):t}function an(e,t){return t?(t=un(t=(0,$.FD)(t)),e.forEach((e=>{var n="1"===(0,Vt.UU)(t,e);(0,Vt.oq)(t,e,n)})),t):t}function sn(e){if(!e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e)return e;if(Array.isArray(e))return e.map((e=>sn(e)));if("object"==typeof e){var t={};return Object.entries(e).forEach((([e,n])=>{"object"==typeof n&&(n=sn(n)),t[nn(e)]=n})),t}}function un(e){if(!e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e)return e;if(Array.isArray(e))return e.map((e=>un(e)));if("object"==typeof e){var t={};return Object.entries(e).forEach((([n,r])=>{("object"==typeof r||Array.isArray(e))&&(r=un(r)),t[rn(n)]=r})),t}}function cn(e){var t=[],n=(0,q.xQ)(e.primaryKey);t.push([n]),t.push(["_deleted",n]),e.indexes&&e.indexes.forEach((e=>{var n=(0,X.$r)(e);t.push(n)})),t.push(["_meta.lwt",n]),t.push(["_meta.lwt"]);var r=(t=t.map((e=>e.map((e=>nn(e)))))).map((e=>1===e.length?e[0]:"["+e.join("+")+"]"));return(r=r.filter(((e,t,n)=>n.indexOf(e)===t))).join(", ")}async function ln(e,t){var n=await e;return(await n.dexieTable.bulkGet(t)).map((e=>an(n.booleanIndexes,e)))}function hn(e,t){return e+"||"+t}function fn(e){var t=new Set,n=[];return e.indexes?(e.indexes.forEach((r=>{(0,X.$r)(r).forEach((r=>{t.has(r)||(t.add(r),"boolean"===(0,q.nT)(e,r).type&&n.push(r))}))})),n.push("_deleted"),(0,X.jw)(n)):n}var dn=i(3040),pn=i(1845);function mn(e){return e===dn.OK?-1/0:e}function yn(e,t,n){return e.includes(t)?n===dn.g0||!0===n?"1":"0":n}function vn(e,t,n){if(!n){if("undefined"==typeof window)throw new Error("IDBKeyRange missing");n=window.IDBKeyRange}var r=t.startKeys.map(((n,r)=>{var i=t.index[r];return yn(e,i,n)})).map(mn),i=t.endKeys.map(((n,r)=>{var i=t.index[r];return yn(e,i,n)})).map(mn);return n.bound(r,i,!t.inclusiveStart,!t.inclusiveEnd)}async function gn(e,t){var n=await e.internals,r=t.query,i=r.skip?r.skip:0,o=i+(r.limit?r.limit:1/0),a=t.queryPlan,s=!1;a.selectorSatisfiedByIndex||(s=(0,pn.Lr)(e.schema,t.query));var u=vn(n.booleanIndexes,a,n.dexieDb._options.IDBKeyRange),c=a.index,l=[];if(await n.dexieDb.transaction("r",n.dexieTable,(async e=>{var t,r=e.idbtrans.objectStore(Xt);t="["+c.map((e=>nn(e))).join("+")+"]";var i=r.index(t).openCursor(u);await new Promise((e=>{i.onsuccess=function(t){var r=t.target.result;if(r){var i=an(n.booleanIndexes,r.value);s&&!s(i)||l.push(i),a.sortSatisfiedByIndex&&l.length===o?e():r.continue()}else e()}}))})),!a.sortSatisfiedByIndex){var h=(0,pn.Xw)(e.schema,t.query);l=l.sort(h)}return{documents:l=l.slice(i,o)}}var bn=(0,H.t)(),wn=function(){function e(e,t,n,r,i,o,a){this.changes$=new _.B,this.instanceId=bn++,this.storage=e,this.databaseName=t,this.collectionName=n,this.schema=r,this.internals=i,this.options=o,this.settings=a,this.primaryPath=(0,q.xQ)(this.schema.primaryKey)}var n=e.prototype;return n.bulkWrite=async function(e,n){En(this),e.forEach((e=>{if(!e.document._rev||e.previous&&!e.previous._rev)throw(0,l.Br)("SNH",{args:{row:e}})}));var r,i=await this.internals,o={success:[],error:[]},a=e.map((e=>e.document[this.primaryPath]));if(await i.dexieDb.transaction("rw",i.dexieTable,i.dexieAttachmentsTable,(async()=>{var t=new Map;(await ln(this.internals,a)).forEach((e=>{var n=e;return n&&t.set(n[this.primaryPath],n),n})),r=(0,K.gi)(this,this.primaryPath,t,e,n),o.error=r.errors;var s=[];r.bulkInsertDocs.forEach((e=>{o.success.push(e.document),s.push(e.document)})),r.bulkUpdateDocs.forEach((e=>{o.success.push(e.document),s.push(e.document)})),(s=s.map((e=>on(i.booleanIndexes,e)))).length>0&&await i.dexieTable.bulkPut(s);var u=[];r.attachmentsAdd.forEach((e=>{u.push({id:hn(e.documentId,e.attachmentId),data:e.attachmentData.data})})),r.attachmentsUpdate.forEach((e=>{u.push({id:hn(e.documentId,e.attachmentId),data:e.attachmentData.data})})),await i.dexieAttachmentsTable.bulkPut(u),await i.dexieAttachmentsTable.bulkDelete(r.attachmentsRemove.map((e=>hn(e.documentId,e.attachmentId))))})),(r=(0,t.ZN)(r)).eventBulk.events.length>0){var s=(0,t.ZN)(r.newestRow).document;r.eventBulk.checkpoint={id:s[this.primaryPath],lwt:s._meta.lwt},r.eventBulk.endTime=(0,H.t)(),this.changes$.next(r.eventBulk)}return o},n.findDocumentsById=async function(e,t){En(this);var n=await this.internals,r=[];return await n.dexieDb.transaction("r",n.dexieTable,(async()=>{(await ln(this.internals,e)).forEach((e=>{!e||e._deleted&&!t||r.push(e)}))})),r},n.query=function(e){return En(this),gn(this,e)},n.count=async function(e){if(e.queryPlan.selectorSatisfiedByIndex){var t=await async function(e,t){var n=await e.internals,r=t.queryPlan,i=r.index,o=vn(n.booleanIndexes,r,n.dexieDb._options.IDBKeyRange),a=-1;return await n.dexieDb.transaction("r",n.dexieTable,(async e=>{var t,n=e.idbtrans.objectStore(Xt);t="["+i.map((e=>nn(e))).join("+")+"]";var r=n.index(t).count(o);a=await new Promise(((e,t)=>{r.onsuccess=function(){e(r.result)},r.onerror=e=>t(e)}))})),a}(this,e);return{count:t,mode:"fast"}}return{count:(await gn(this,e)).documents.length,mode:"slow"}},n.changeStream=function(){return En(this),this.changes$.asObservable()},n.cleanup=async function(e){En(this);var t=await this.internals;return await t.dexieDb.transaction("rw",t.dexieTable,(async()=>{var n=(0,H.t)()-e,r=await t.dexieTable.where("_meta.lwt").below(n).toArray(),i=[];r.forEach((e=>{"1"===e._deleted&&i.push(e[this.primaryPath])})),await t.dexieTable.bulkDelete(i)})),!0},n.getAttachmentData=async function(e,t,n){En(this);var r=await this.internals,i=hn(e,t);return await r.dexieDb.transaction("r",r.dexieAttachmentsTable,(async()=>{var n=await r.dexieAttachmentsTable.get(i);if(n)return n.data;throw new Error("attachment missing documentId: "+e+" attachmentId: "+t)}))},n.remove=async function(){En(this);var e=await this.internals;return await e.dexieTable.clear(),this.close()},n.close=function(){return this.closed||(this.closed=(async()=>{this.changes$.complete(),await async function(e){var t=await e,n=en.get(e)-1;0===n?(t.dexieDb.close(),en.delete(e)):en.set(e,n)}(this.internals)})()),this.closed},n.conflictResultionTasks=function(){return new _.B},n.resolveConflictResultionTask=async function(e){},e}();async function _n(e,t,n){var r=function(e,t,n,r){var i="rxdb-dexie-"+e+"--"+r.version+"--"+t,o=(0,ue.q)(Gt,i,(()=>{var e=(async()=>{var e=(0,$.FD)(n);e.autoOpen=!1;var t=new Lt(i,e),o={[Xt]:cn(r),[Yt]:"++sequence, id",[Zt]:"id"};return t.version(1).stores(o),await t.open(),{dexieDb:t,dexieTable:t[Xt],dexieAttachmentsTable:t[Zt],booleanIndexes:fn(r)}})();return Gt.set(i,o),en.set(o,0),e}));return o}(t.databaseName,t.collectionName,n,t.schema),i=new wn(e,t.databaseName,t.collectionName,t.schema,r,t.options,n);return await lt(Jt,t,i),Promise.resolve(i)}function En(e){if(e.closed)throw new Error("RxStorageInstanceDexie is closed "+e.databaseName+"-"+e.collectionName)}var kn=function(){function e(e){this.name=Jt,this.rxdbVersion=y.o,this.settings=e}return e.prototype.createStorageInstance=function(e){return(0,K.pZ)(e),_n(this,e,this.settings)},e}();var Sn=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},xn=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};console.log("mode: production");var Cn=function(e={}){return new kn(e)}(),On=Sn(void 0,void 0,void 0,(function(){var n,r,o,a;return xn(this,(function(u){switch(u.label){case 0:return[3,3];case 1:return u.sent(),[4,i.e(234).then(i.bind(i,6234)).then((function(e){Cn=e.wrappedValidateAjvStorage({storage:Cn})}))];case 2:u.sent(),u.label=3;case 3:return(!(n=window.location.hash)||n.length<5)&&(window.location.hash="room-"+(0,e.z3)(10),window.location.reload()),[4,(0,m.V0)(n)];case 4:return r=u.sent(),[4,(0,s.uh)({name:"tpdp-"+y.o.replace(/\./g,"-")+"-"+r.substring(0,10),storage:Cn})];case 5:return o=u.sent(),a=function(e){return Sn(void 0,void 0,void 0,(function(){return xn(this,(function(t){return(0,v.b)(e.newDocumentState,e.realMasterState)?[2,{isEqual:!0}]:[2,{isEqual:!1,documentData:e.newDocumentState.lastChange>e.realMasterState.lastChange?e.newDocumentState:e.realMasterState}]}))}))},[4,o.addCollections({todos:{schema:{version:0,primaryKey:"id",type:"object",properties:{id:{type:"string",maxLength:20},name:{type:"string"},state:{type:"string",enum:["open","done"],maxLength:10},lastChange:{type:"number",minimum:0,maximum:2701307494132,multipleOf:1}},required:["id","name","state","lastChange"],indexes:["state",["state","lastChange"]]},conflictHandler:a}})];case 6:return u.sent(),o.todos.preSave((function(e){return e.lastChange=Date.now(),e}),!0),[4,o.todos.bulkInsert(["touch your  with your ","solve rubik's cube  blindfolded","invent new "].map((function(e,t){return{id:"todo-"+t,name:e,lastChange:0,state:"open"}})))];case 7:return u.sent(),async function(n){var r=n.collection;p(vt),n.pull&&(n.pull.batchSize||(n.pull.batchSize=20)),n.push&&(n.push.batchSize||(n.push.batchSize=20)),r.database.multiInstance&&await r.database.waitForLeadership();var i=0,o=(0,e.z3)(10);function a(){var e=i++;return r.database.token+"|"+o+"|"+e}var s=await r.database.storageToken,u=new Rt(r,n,await n.connectionHandlerCreator(n));u.subs.push(u.connectionHandler.error$.subscribe((e=>u.error$.next(e))),u.connectionHandler.disconnect$.subscribe((e=>u.removePeer(e)))),u.subs.push(u.connectionHandler.message$.pipe((0,g.p)((e=>"token"===e.message.method))).subscribe((e=>{u.connectionHandler.send(e.peer,{id:e.message.id,result:s})})));var c=u.connectionHandler.connect$.pipe((0,g.p)((()=>!u.canceled))).subscribe((async e=>{var i,o;if(!n.isPeerValid||await n.isPeerValid(e)){try{i=(await Ot(u.connectionHandler,e,{id:a(),method:"token",params:[]})).result}catch(e){return void u.error$.next((0,l.Br)("RC_WEBRTC_PEER",{error:e}))}if(await async function(e,t,n){return await e([t,n].join("|"))>await e([n,t].join("|"))}(r.database.hashFunction,s,i)){var c=u.masterReplicationHandler,h=c.masterChangeStream$.subscribe((t=>{var n={id:"masterChangeStream$",result:t};u.connectionHandler.send(e,n)}));u.subs.push(h,u.connectionHandler.disconnect$.pipe((0,g.p)((t=>t===e))).subscribe((()=>h.unsubscribe())));var f=u.connectionHandler.message$.pipe((0,g.p)((t=>t.peer===e)),(0,g.p)((e=>"token"!==e.message.method))).subscribe((async e=>{var{peer:t,message:n}=e,r=c[n.method].bind(c),i=await r(...n.params),o={id:n.id,result:i};u.connectionHandler.send(t,o)}));u.subs.push(f)}else o=Ct({replicationIdentifier:[r.name,n.topic,i].join("||"),collection:r,autoStart:!0,deletedField:"_deleted",live:!0,retryTime:n.retryTime,waitForLeadership:!1,pull:n.pull?Object.assign({},n.pull,{handler:async r=>(await Ot(u.connectionHandler,e,{method:"masterChangesSince",params:[r,(0,t.ZN)(n.pull).batchSize],id:a()})).result,stream$:u.connectionHandler.response$.pipe((0,g.p)((e=>"masterChangeStream$"===e.response.id)),(0,b.T)((e=>e.response.result)))}):void 0,push:n.push?Object.assign({},n.push,{handler:async t=>(await Ot(u.connectionHandler,e,{method:"masterWrite",params:[t],id:a()})).result}):void 0});u.addPeer(e,o)}}));return u.subs.push(c),u}({collection:o.todos,connectionHandlerCreator:Nt({}),topic:r.substring(0,10),pull:{},push:{}}).then((function(e){e.error$.subscribe((function(e){console.log("replication error:"),console.dir(e)})),e.peerStates$.subscribe((function(e){console.log("new peer states:"),console.dir(e)}))})),[2,o]}}))})),Rn=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},In=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};function Pn(e){return(0,t.ZN)(document.getElementById(e))}Rn(void 0,void 0,void 0,(function(){var t,n,r,i;return In(this,(function(o){switch(o.label){case 0:return[4,On];case 1:return t=o.sent(),Pn("copy-url").innerHTML=window.location.href,n=Pn("todo-list"),t.todos.find({sort:[{state:"desc"},{lastChange:"desc"}]}).$.subscribe((function(e){n.innerHTML="",e.forEach((function(e){return n.append(function(e){var t=this,n=document.createElement("li"),r=document.createElement("div"),i=document.createElement("input"),o=document.createElement("label"),a=document.createElement("button");n.append(r),r.append(i),r.append(o),r.append(a),i.onclick=function(){return e.incrementalPatch({state:"done"===e.state?"open":"done"})},i.type="checkbox",i.classList.add("toggle"),o.contentEditable="true";var s=function(){return Rn(t,void 0,void 0,(function(){var t;return In(this,(function(n){switch(n.label){case 0:return(t=(t=o.innerText||o.textContent).replace(/<br>/g,"").replace(/\&nbsp;/g," ").trim())===e.name?[3,2]:[4,e.incrementalPatch({name:t})];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))};return o.onblur=function(){return s()},o.onkeyup=function(e){return Rn(t,void 0,void 0,(function(){return In(this,(function(t){return Tn(e)&&s(),[2]}))}))},o.innerHTML=Dn(e.name),a.classList.add("destroy"),a.onclick=function(){return e.remove()},"done"===e.state&&(n.classList.add("completed"),i.checked=!0),n}(e))}))})),r=Pn("insert-todo"),i=function(){return Rn(void 0,void 0,void 0,(function(){return In(this,(function(n){switch(n.label){case 0:return r.value.length<1?[2]:[4,t.todos.insert({id:(0,e.z3)(10),name:r.value,state:"open",lastChange:Date.now()})];case 1:return n.sent(),r.value="",[2]}}))}))},r.onkeydown=function(e){return Rn(void 0,void 0,void 0,(function(){return In(this,(function(t){return Tn(e)&&i(),[2]}))}))},r.onblur=function(){return i()},Pn("clear-completed").onclick=function(){return t.todos.find({selector:{state:"done"}}).remove()},[2]}}))}));var Dn=function(e){return e.replace(/[&<]/g,(function(e){return"&"===e?"&amp;":"&lt;"}))},Tn=function(e){return"Enter"===e.code||13===e.keyCode}})()})();
//# sourceMappingURL=2f9958da0050e5d2df17.bundle.js.map